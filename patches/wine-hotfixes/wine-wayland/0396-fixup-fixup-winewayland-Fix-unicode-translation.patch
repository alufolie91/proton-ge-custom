From b76bf13b43835cdbe01d91efb2f51a97001f0b74 Mon Sep 17 00:00:00 2001
From: Etaash Mathamsetty
 <45927311+Etaash-mathamsetty@users.noreply.github.com>
Date: Tue, 25 Nov 2025 23:59:07 -0600
Subject: [PATCH 396/406] fixup! fixup! winewayland: Fix unicode translation.

---
 dlls/winewayland.drv/wayland_keyboard.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/dlls/winewayland.drv/wayland_keyboard.c b/dlls/winewayland.drv/wayland_keyboard.c
index f6125a2fe56..3f5fdda9e47 100644
--- a/dlls/winewayland.drv/wayland_keyboard.c
+++ b/dlls/winewayland.drv/wayland_keyboard.c
@@ -1030,7 +1030,7 @@ static void keyboard_handle_key(void *data, struct wl_keyboard *wl_keyboard,
     input.ki.wScan = (scan & 0x300) ? scan + 0xdf00 : scan;
 
     pthread_mutex_lock(&keyboard->mutex);
-    input.ki.wVk = NtUserMapVirtualKeyEx(scan & 0xff, MAPVK_VSC_TO_VK, keyboard_hkl);
+    input.ki.wVk = NtUserMapVirtualKeyEx(input.ki.wScan, MAPVK_VSC_TO_VK_EX, keyboard_hkl);
     pthread_mutex_unlock(&keyboard->mutex);
 
     if (scan & ~0xff) input.ki.dwFlags |= KEYEVENTF_EXTENDEDKEY;
-- 
2.51.1

