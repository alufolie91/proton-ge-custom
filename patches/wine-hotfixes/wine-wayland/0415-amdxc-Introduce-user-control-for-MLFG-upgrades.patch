From a15d41376a30478ee82d43c285e9a1a51151f5d3 Mon Sep 17 00:00:00 2001
From: Etaash Mathamsetty
 <45927311+Etaash-mathamsetty@users.noreply.github.com>
Date: Thu, 18 Dec 2025 12:25:55 -0600
Subject: [PATCH 415/479] amdxc: Introduce user control for MLFG upgrades.

---
 dlls/amdxc64/main.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/dlls/amdxc64/main.c b/dlls/amdxc64/main.c
index 6cadb49102b..870d7e5eaff 100644
--- a/dlls/amdxc64/main.c
+++ b/dlls/amdxc64/main.c
@@ -195,7 +195,7 @@ HRESULT STDMETHODCALLTYPE AMDFSR4FFX_UpdateFfxApiProvider(IAmdExtFfxApi *iface,
     /* required to expose MLFG support */
     struct unk_data unk_data[1] =
     {
-        {{0, 1, 1, 0}, NULL}
+        {{0, 1, 0, 0}, NULL}
     };
     const char *env;
     updateffxapi_pfn_ex pfn_ex;
@@ -206,6 +206,9 @@ HRESULT STDMETHODCALLTYPE AMDFSR4FFX_UpdateFfxApiProvider(IAmdExtFfxApi *iface,
 
     if (!data) return E_INVALIDARG;
 
+    if ((env = getenv("MLFG_UPGRADE")) && !strcmp(env, "1"))
+        unk_data[0].unk[2] = 1;
+
     if ((env = getenv("FSR4_UPGRADE")) && !strcmp(env, "1"))
     {
         amdffx = LoadLibraryA("amdxcffx64");
-- 
2.52.0

