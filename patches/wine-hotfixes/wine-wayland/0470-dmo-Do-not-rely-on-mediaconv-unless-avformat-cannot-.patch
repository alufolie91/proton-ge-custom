From ac7a51afc3c85a3d1b004e57df3537892946aed8 Mon Sep 17 00:00:00 2001
From: Etaash Mathamsetty
 <45927311+Etaash-mathamsetty@users.noreply.github.com>
Date: Mon, 29 Dec 2025 15:21:52 -0500
Subject: [PATCH 470/479] dmo: Do not rely on mediaconv unless avformat cannot
 parse the input.

---
 dlls/winedmo/unix_demuxer.c | 10 ++++++----
 1 file changed, 6 insertions(+), 4 deletions(-)

diff --git a/dlls/winedmo/unix_demuxer.c b/dlls/winedmo/unix_demuxer.c
index 24681e2d5df..37a6a5f0fd6 100644
--- a/dlls/winedmo/unix_demuxer.c
+++ b/dlls/winedmo/unix_demuxer.c
@@ -248,11 +248,13 @@ NTSTATUS demuxer_create( void *arg )
     if (!(demuxer->ctx->pb = avio_alloc_context( NULL, 0, 0, params->context, unix_read_callback, NULL, unix_seek_callback ))) goto failed;
 
     if ((ret = avformat_open_input( &demuxer->ctx, NULL, NULL, NULL )) < 0)
-        WARN( "Failed to open input, error %s.\n", debugstr_averr(ret) );
-    if ((ret = mediaconv_demuxer_open( &demuxer->ctx, params->context ) < 0))
     {
-        ERR( "Failed to open input, error %s.\n", debugstr_averr(ret) );
-        goto failed;
+        WARN( "Failed to open input, error %s.\n", debugstr_averr(ret) );
+        if ((ret = mediaconv_demuxer_open( &demuxer->ctx, params->context ) < 0))
+        {
+            ERR( "Failed to open input, error %s.\n", debugstr_averr(ret) );
+            goto failed;
+        }
     }
     format = demuxer->ctx->iformat;
 
-- 
2.52.0

