From e7e6b527114619b3bb561a9648089edb781b926a Mon Sep 17 00:00:00 2001
From: Etaash Mathamsetty <etaash.mathamsetty@gmail.com>
Date: Tue, 5 Dec 2023 22:07:07 -0500
Subject: [PATCH 381/409] ntdll: Implement NtGetNextProcess.

---
 dlls/ntdll/ntdll.spec          |   1 +
 dlls/ntdll/ntsyscalls.h        | 964 +++++++++++++++++----------------
 dlls/ntdll/signal_arm64ec.c    |   1 +
 dlls/ntdll/unix/process.c      |  27 +
 dlls/wow64/process.c           |  21 +
 include/wine/server_protocol.h |  29 +-
 include/winternl.h             |   1 +
 server/process.c               |  34 ++
 server/protocol.def            |  10 +
 server/request_handlers.h      |  18 +-
 server/request_trace.h         |  25 +-
 11 files changed, 645 insertions(+), 486 deletions(-)

diff --git a/dlls/ntdll/ntdll.spec b/dlls/ntdll/ntdll.spec
index 958855bc169..49b28d5ddad 100644
--- a/dlls/ntdll/ntdll.spec
+++ b/dlls/ntdll/ntdll.spec
@@ -239,6 +239,7 @@
 @ stdcall -norelay -syscall NtGetContextThread(long ptr)
 @ stdcall -syscall NtGetCurrentProcessorNumber()
 # @ stub NtGetDevicePowerState
+@ stdcall -syscall NtGetNextProcess(ptr long long long ptr)
 @ stdcall -syscall NtGetNextThread(ptr ptr long long long ptr)
 @ stdcall -syscall NtGetNlsSectionPtr(long long long ptr ptr)
 # @ stub NtGetPlugPlayEvent
diff --git a/dlls/ntdll/ntsyscalls.h b/dlls/ntdll/ntsyscalls.h
index 789b449c10d..7623f4f9139 100644
--- a/dlls/ntdll/ntsyscalls.h
+++ b/dlls/ntdll/ntsyscalls.h
@@ -7,249 +7,251 @@
     SYSCALL_ENTRY( 0x0003, NtAddAtom, 12 ) \
     SYSCALL_ENTRY( 0x0004, NtAdjustGroupsToken, 24 ) \
     SYSCALL_ENTRY( 0x0005, NtAdjustPrivilegesToken, 24 ) \
-    SYSCALL_ENTRY( 0x0006, NtAlertResumeThread, 8 ) \
-    SYSCALL_ENTRY( 0x0007, NtAlertThread, 4 ) \
-    SYSCALL_ENTRY( 0x0008, NtAlertThreadByThreadId, 4 ) \
-    SYSCALL_ENTRY( 0x0009, NtAllocateLocallyUniqueId, 4 ) \
-    SYSCALL_ENTRY( 0x000a, NtAllocateReserveObject, 12 ) \
-    SYSCALL_ENTRY( 0x000b, NtAllocateUuids, 16 ) \
-    SYSCALL_ENTRY( 0x000c, NtAllocateVirtualMemory, 24 ) \
-    SYSCALL_ENTRY( 0x000d, NtAllocateVirtualMemoryEx, 28 ) \
-    SYSCALL_ENTRY( 0x000e, NtAreMappedFilesTheSame, 8 ) \
-    SYSCALL_ENTRY( 0x000f, NtAssignProcessToJobObject, 8 ) \
-    SYSCALL_ENTRY( 0x0010, NtCallbackReturn, 12 ) \
-    SYSCALL_ENTRY( 0x0011, NtCancelIoFile, 8 ) \
-    SYSCALL_ENTRY( 0x0012, NtCancelIoFileEx, 12 ) \
-    SYSCALL_ENTRY( 0x0013, NtCancelSynchronousIoFile, 12 ) \
-    SYSCALL_ENTRY( 0x0014, NtCancelTimer, 8 ) \
-    SYSCALL_ENTRY( 0x0015, NtClearEvent, 4 ) \
-    SYSCALL_ENTRY( 0x0016, NtClose, 4 ) \
-    SYSCALL_ENTRY( 0x0017, NtCommitTransaction, 8 ) \
-    SYSCALL_ENTRY( 0x0018, NtCompareObjects, 8 ) \
-    SYSCALL_ENTRY( 0x0019, NtCompareTokens, 12 ) \
-    SYSCALL_ENTRY( 0x001a, NtCompleteConnectPort, 4 ) \
-    SYSCALL_ENTRY( 0x001b, NtConnectPort, 32 ) \
-    SYSCALL_ENTRY( 0x001c, NtContinue, 8 ) \
-    SYSCALL_ENTRY( 0x001d, NtContinueEx, 8 ) \
-    SYSCALL_ENTRY( 0x001e, NtConvertBetweenAuxiliaryCounterAndPerformanceCounter, 16 ) \
-    SYSCALL_ENTRY( 0x001f, NtCreateDebugObject, 16 ) \
-    SYSCALL_ENTRY( 0x0020, NtCreateDirectoryObject, 12 ) \
-    SYSCALL_ENTRY( 0x0021, NtCreateEvent, 20 ) \
-    SYSCALL_ENTRY( 0x0022, NtCreateFile, 44 ) \
-    SYSCALL_ENTRY( 0x0023, NtCreateIoCompletion, 16 ) \
-    SYSCALL_ENTRY( 0x0024, NtCreateJobObject, 12 ) \
-    SYSCALL_ENTRY( 0x0025, NtCreateKey, 28 ) \
-    SYSCALL_ENTRY( 0x0026, NtCreateKeyTransacted, 32 ) \
-    SYSCALL_ENTRY( 0x0027, NtCreateKeyedEvent, 16 ) \
-    SYSCALL_ENTRY( 0x0028, NtCreateLowBoxToken, 36 ) \
-    SYSCALL_ENTRY( 0x0029, NtCreateMailslotFile, 32 ) \
-    SYSCALL_ENTRY( 0x002a, NtCreateMutant, 16 ) \
-    SYSCALL_ENTRY( 0x002b, NtCreateNamedPipeFile, 56 ) \
-    SYSCALL_ENTRY( 0x002c, NtCreatePagingFile, 16 ) \
-    SYSCALL_ENTRY( 0x002d, NtCreatePort, 20 ) \
-    SYSCALL_ENTRY( 0x002e, NtCreateSection, 28 ) \
-    SYSCALL_ENTRY( 0x002f, NtCreateSectionEx, 36 ) \
-    SYSCALL_ENTRY( 0x0030, NtCreateSemaphore, 20 ) \
-    SYSCALL_ENTRY( 0x0031, NtCreateSymbolicLinkObject, 16 ) \
-    SYSCALL_ENTRY( 0x0032, NtCreateThread, 32 ) \
-    SYSCALL_ENTRY( 0x0033, NtCreateThreadEx, 44 ) \
-    SYSCALL_ENTRY( 0x0034, NtCreateTimer, 16 ) \
-    SYSCALL_ENTRY( 0x0035, NtCreateToken, 52 ) \
-    SYSCALL_ENTRY( 0x0036, NtCreateTransaction, 40 ) \
-    SYSCALL_ENTRY( 0x0037, NtCreateUserProcess, 44 ) \
-    SYSCALL_ENTRY( 0x0038, NtDebugActiveProcess, 8 ) \
-    SYSCALL_ENTRY( 0x0039, NtDebugContinue, 12 ) \
-    SYSCALL_ENTRY( 0x003a, NtDelayExecution, 8 ) \
-    SYSCALL_ENTRY( 0x003b, NtDeleteAtom, 4 ) \
-    SYSCALL_ENTRY( 0x003c, NtDeleteFile, 4 ) \
-    SYSCALL_ENTRY( 0x003d, NtDeleteKey, 4 ) \
-    SYSCALL_ENTRY( 0x003e, NtDeleteValueKey, 8 ) \
-    SYSCALL_ENTRY( 0x003f, NtDeviceIoControlFile, 40 ) \
-    SYSCALL_ENTRY( 0x0040, NtDisplayString, 4 ) \
-    SYSCALL_ENTRY( 0x0041, NtDuplicateObject, 28 ) \
-    SYSCALL_ENTRY( 0x0042, NtDuplicateToken, 24 ) \
-    SYSCALL_ENTRY( 0x0043, NtEnumerateKey, 24 ) \
-    SYSCALL_ENTRY( 0x0044, NtEnumerateValueKey, 24 ) \
-    SYSCALL_ENTRY( 0x0045, NtFilterToken, 24 ) \
-    SYSCALL_ENTRY( 0x0046, NtFindAtom, 12 ) \
-    SYSCALL_ENTRY( 0x0047, NtFlushBuffersFile, 8 ) \
-    SYSCALL_ENTRY( 0x0048, NtFlushBuffersFileEx, 20 ) \
-    SYSCALL_ENTRY( 0x0049, NtFlushInstructionCache, 12 ) \
-    SYSCALL_ENTRY( 0x004a, NtFlushKey, 4 ) \
-    SYSCALL_ENTRY( 0x004b, NtFlushProcessWriteBuffers, 0 ) \
-    SYSCALL_ENTRY( 0x004c, NtFlushVirtualMemory, 16 ) \
-    SYSCALL_ENTRY( 0x004d, NtFreeVirtualMemory, 16 ) \
-    SYSCALL_ENTRY( 0x004e, NtFsControlFile, 40 ) \
-    SYSCALL_ENTRY( 0x004f, NtGetContextThread, 8 ) \
-    SYSCALL_ENTRY( 0x0050, NtGetCurrentProcessorNumber, 0 ) \
-    SYSCALL_ENTRY( 0x0051, NtGetNextThread, 24 ) \
-    SYSCALL_ENTRY( 0x0052, NtGetNlsSectionPtr, 20 ) \
-    SYSCALL_ENTRY( 0x0053, NtGetWriteWatch, 28 ) \
-    SYSCALL_ENTRY( 0x0054, NtImpersonateAnonymousToken, 4 ) \
-    SYSCALL_ENTRY( 0x0055, NtInitializeNlsFiles, 12 ) \
-    SYSCALL_ENTRY( 0x0056, NtInitiatePowerAction, 16 ) \
-    SYSCALL_ENTRY( 0x0057, NtIsProcessInJob, 8 ) \
-    SYSCALL_ENTRY( 0x0058, NtListenPort, 8 ) \
-    SYSCALL_ENTRY( 0x0059, NtLoadDriver, 4 ) \
-    SYSCALL_ENTRY( 0x005a, NtLoadKey, 8 ) \
-    SYSCALL_ENTRY( 0x005b, NtLoadKey2, 12 ) \
-    SYSCALL_ENTRY( 0x005c, NtLoadKeyEx, 32 ) \
-    SYSCALL_ENTRY( 0x005d, NtLockFile, 40 ) \
-    SYSCALL_ENTRY( 0x005e, NtLockVirtualMemory, 16 ) \
-    SYSCALL_ENTRY( 0x005f, NtMakePermanentObject, 4 ) \
-    SYSCALL_ENTRY( 0x0060, NtMakeTemporaryObject, 4 ) \
-    SYSCALL_ENTRY( 0x0061, NtMapViewOfSection, 40 ) \
-    SYSCALL_ENTRY( 0x0062, NtMapViewOfSectionEx, 36 ) \
-    SYSCALL_ENTRY( 0x0063, NtNotifyChangeDirectoryFile, 36 ) \
-    SYSCALL_ENTRY( 0x0064, NtNotifyChangeKey, 40 ) \
-    SYSCALL_ENTRY( 0x0065, NtNotifyChangeMultipleKeys, 48 ) \
-    SYSCALL_ENTRY( 0x0066, NtOpenDirectoryObject, 12 ) \
-    SYSCALL_ENTRY( 0x0067, NtOpenEvent, 12 ) \
-    SYSCALL_ENTRY( 0x0068, NtOpenFile, 24 ) \
-    SYSCALL_ENTRY( 0x0069, NtOpenIoCompletion, 12 ) \
-    SYSCALL_ENTRY( 0x006a, NtOpenJobObject, 12 ) \
-    SYSCALL_ENTRY( 0x006b, NtOpenKey, 12 ) \
-    SYSCALL_ENTRY( 0x006c, NtOpenKeyEx, 16 ) \
-    SYSCALL_ENTRY( 0x006d, NtOpenKeyTransacted, 16 ) \
-    SYSCALL_ENTRY( 0x006e, NtOpenKeyTransactedEx, 20 ) \
-    SYSCALL_ENTRY( 0x006f, NtOpenKeyedEvent, 12 ) \
-    SYSCALL_ENTRY( 0x0070, NtOpenMutant, 12 ) \
-    SYSCALL_ENTRY( 0x0071, NtOpenProcess, 16 ) \
-    SYSCALL_ENTRY( 0x0072, NtOpenProcessToken, 12 ) \
-    SYSCALL_ENTRY( 0x0073, NtOpenProcessTokenEx, 16 ) \
-    SYSCALL_ENTRY( 0x0074, NtOpenSection, 12 ) \
-    SYSCALL_ENTRY( 0x0075, NtOpenSemaphore, 12 ) \
-    SYSCALL_ENTRY( 0x0076, NtOpenSymbolicLinkObject, 12 ) \
-    SYSCALL_ENTRY( 0x0077, NtOpenThread, 16 ) \
-    SYSCALL_ENTRY( 0x0078, NtOpenThreadToken, 16 ) \
-    SYSCALL_ENTRY( 0x0079, NtOpenThreadTokenEx, 20 ) \
-    SYSCALL_ENTRY( 0x007a, NtOpenTimer, 12 ) \
-    SYSCALL_ENTRY( 0x007b, NtPowerInformation, 20 ) \
-    SYSCALL_ENTRY( 0x007c, NtPrivilegeCheck, 12 ) \
-    SYSCALL_ENTRY( 0x007d, NtProtectVirtualMemory, 20 ) \
-    SYSCALL_ENTRY( 0x007e, NtPulseEvent, 8 ) \
-    SYSCALL_ENTRY( 0x007f, NtQueryAttributesFile, 8 ) \
-    SYSCALL_ENTRY( 0x0080, NtQueryDefaultLocale, 8 ) \
-    SYSCALL_ENTRY( 0x0081, NtQueryDefaultUILanguage, 4 ) \
-    SYSCALL_ENTRY( 0x0082, NtQueryDirectoryFile, 44 ) \
-    SYSCALL_ENTRY( 0x0083, NtQueryDirectoryObject, 28 ) \
-    SYSCALL_ENTRY( 0x0084, NtQueryEaFile, 36 ) \
-    SYSCALL_ENTRY( 0x0085, NtQueryEvent, 20 ) \
-    SYSCALL_ENTRY( 0x0086, NtQueryFullAttributesFile, 8 ) \
-    SYSCALL_ENTRY( 0x0087, NtQueryInformationAtom, 20 ) \
-    SYSCALL_ENTRY( 0x0088, NtQueryInformationFile, 20 ) \
-    SYSCALL_ENTRY( 0x0089, NtQueryInformationJobObject, 20 ) \
-    SYSCALL_ENTRY_NtQueryInformationProcess( 0x008a, NtQueryInformationProcess, 20 ) \
-    SYSCALL_ENTRY( 0x008b, NtQueryInformationThread, 20 ) \
-    SYSCALL_ENTRY( 0x008c, NtQueryInformationToken, 20 ) \
-    SYSCALL_ENTRY( 0x008d, NtQueryInstallUILanguage, 4 ) \
-    SYSCALL_ENTRY( 0x008e, NtQueryIoCompletion, 20 ) \
-    SYSCALL_ENTRY( 0x008f, NtQueryKey, 20 ) \
-    SYSCALL_ENTRY( 0x0090, NtQueryLicenseValue, 20 ) \
-    SYSCALL_ENTRY( 0x0091, NtQueryMultipleValueKey, 24 ) \
-    SYSCALL_ENTRY( 0x0092, NtQueryMutant, 20 ) \
-    SYSCALL_ENTRY( 0x0093, NtQueryObject, 20 ) \
-    SYSCALL_ENTRY( 0x0094, NtQueryPerformanceCounter, 8 ) \
-    SYSCALL_ENTRY( 0x0095, NtQuerySection, 20 ) \
-    SYSCALL_ENTRY( 0x0096, NtQuerySecurityObject, 20 ) \
-    SYSCALL_ENTRY( 0x0097, NtQuerySemaphore, 20 ) \
-    SYSCALL_ENTRY( 0x0098, NtQuerySymbolicLinkObject, 12 ) \
-    SYSCALL_ENTRY( 0x0099, NtQuerySystemEnvironmentValue, 16 ) \
-    SYSCALL_ENTRY( 0x009a, NtQuerySystemEnvironmentValueEx, 20 ) \
-    SYSCALL_ENTRY( 0x009b, NtQuerySystemInformation, 16 ) \
-    SYSCALL_ENTRY( 0x009c, NtQuerySystemInformationEx, 24 ) \
-    SYSCALL_ENTRY_NtQuerySystemTime( 0x009d, NtQuerySystemTime, 4 ) \
-    SYSCALL_ENTRY( 0x009e, NtQueryTimer, 20 ) \
-    SYSCALL_ENTRY( 0x009f, NtQueryTimerResolution, 12 ) \
-    SYSCALL_ENTRY( 0x00a0, NtQueryValueKey, 24 ) \
-    SYSCALL_ENTRY( 0x00a1, NtQueryVirtualMemory, 24 ) \
-    SYSCALL_ENTRY( 0x00a2, NtQueryVolumeInformationFile, 20 ) \
-    SYSCALL_ENTRY( 0x00a3, NtQueueApcThread, 20 ) \
-    SYSCALL_ENTRY( 0x00a4, NtQueueApcThreadEx, 24 ) \
-    SYSCALL_ENTRY( 0x00a5, NtRaiseException, 12 ) \
-    SYSCALL_ENTRY( 0x00a6, NtRaiseHardError, 24 ) \
-    SYSCALL_ENTRY( 0x00a7, NtReadFile, 36 ) \
-    SYSCALL_ENTRY( 0x00a8, NtReadFileScatter, 36 ) \
-    SYSCALL_ENTRY( 0x00a9, NtReadVirtualMemory, 20 ) \
-    SYSCALL_ENTRY( 0x00aa, NtRegisterThreadTerminatePort, 4 ) \
-    SYSCALL_ENTRY( 0x00ab, NtReleaseKeyedEvent, 16 ) \
-    SYSCALL_ENTRY( 0x00ac, NtReleaseMutant, 8 ) \
-    SYSCALL_ENTRY( 0x00ad, NtReleaseSemaphore, 12 ) \
-    SYSCALL_ENTRY( 0x00ae, NtRemoveIoCompletion, 20 ) \
-    SYSCALL_ENTRY( 0x00af, NtRemoveIoCompletionEx, 24 ) \
-    SYSCALL_ENTRY( 0x00b0, NtRemoveProcessDebug, 8 ) \
-    SYSCALL_ENTRY( 0x00b1, NtRenameKey, 8 ) \
-    SYSCALL_ENTRY( 0x00b2, NtReplaceKey, 12 ) \
-    SYSCALL_ENTRY( 0x00b3, NtReplyWaitReceivePort, 16 ) \
-    SYSCALL_ENTRY( 0x00b4, NtRequestWaitReplyPort, 12 ) \
-    SYSCALL_ENTRY( 0x00b5, NtResetEvent, 8 ) \
-    SYSCALL_ENTRY( 0x00b6, NtResetWriteWatch, 12 ) \
-    SYSCALL_ENTRY( 0x00b7, NtRestoreKey, 12 ) \
-    SYSCALL_ENTRY( 0x00b8, NtResumeProcess, 4 ) \
-    SYSCALL_ENTRY( 0x00b9, NtResumeThread, 8 ) \
-    SYSCALL_ENTRY( 0x00ba, NtRollbackTransaction, 8 ) \
-    SYSCALL_ENTRY( 0x00bb, NtSaveKey, 8 ) \
-    SYSCALL_ENTRY( 0x00bc, NtSecureConnectPort, 36 ) \
-    SYSCALL_ENTRY( 0x00bd, NtSetContextThread, 8 ) \
-    SYSCALL_ENTRY( 0x00be, NtSetDebugFilterState, 12 ) \
-    SYSCALL_ENTRY( 0x00bf, NtSetDefaultLocale, 8 ) \
-    SYSCALL_ENTRY( 0x00c0, NtSetDefaultUILanguage, 4 ) \
-    SYSCALL_ENTRY( 0x00c1, NtSetEaFile, 16 ) \
-    SYSCALL_ENTRY( 0x00c2, NtSetEvent, 8 ) \
-    SYSCALL_ENTRY( 0x00c3, NtSetInformationDebugObject, 20 ) \
-    SYSCALL_ENTRY( 0x00c4, NtSetInformationFile, 20 ) \
-    SYSCALL_ENTRY( 0x00c5, NtSetInformationJobObject, 16 ) \
-    SYSCALL_ENTRY( 0x00c6, NtSetInformationKey, 16 ) \
-    SYSCALL_ENTRY( 0x00c7, NtSetInformationObject, 16 ) \
-    SYSCALL_ENTRY( 0x00c8, NtSetInformationProcess, 16 ) \
-    SYSCALL_ENTRY( 0x00c9, NtSetInformationThread, 16 ) \
-    SYSCALL_ENTRY( 0x00ca, NtSetInformationToken, 16 ) \
-    SYSCALL_ENTRY( 0x00cb, NtSetInformationVirtualMemory, 24 ) \
-    SYSCALL_ENTRY( 0x00cc, NtSetIntervalProfile, 8 ) \
-    SYSCALL_ENTRY( 0x00cd, NtSetIoCompletion, 20 ) \
-    SYSCALL_ENTRY( 0x00ce, NtSetIoCompletionEx, 24 ) \
-    SYSCALL_ENTRY( 0x00cf, NtSetLdtEntries, 24 ) \
-    SYSCALL_ENTRY( 0x00d0, NtSetSecurityObject, 12 ) \
-    SYSCALL_ENTRY( 0x00d1, NtSetSystemInformation, 12 ) \
-    SYSCALL_ENTRY( 0x00d2, NtSetSystemTime, 8 ) \
-    SYSCALL_ENTRY( 0x00d3, NtSetThreadExecutionState, 8 ) \
-    SYSCALL_ENTRY( 0x00d4, NtSetTimer, 28 ) \
-    SYSCALL_ENTRY( 0x00d5, NtSetTimerResolution, 12 ) \
-    SYSCALL_ENTRY( 0x00d6, NtSetValueKey, 24 ) \
-    SYSCALL_ENTRY( 0x00d7, NtSetVolumeInformationFile, 20 ) \
-    SYSCALL_ENTRY( 0x00d8, NtShutdownSystem, 4 ) \
-    SYSCALL_ENTRY( 0x00d9, NtSignalAndWaitForSingleObject, 16 ) \
-    SYSCALL_ENTRY( 0x00da, NtSuspendProcess, 4 ) \
-    SYSCALL_ENTRY( 0x00db, NtSuspendThread, 8 ) \
-    SYSCALL_ENTRY( 0x00dc, NtSystemDebugControl, 24 ) \
-    SYSCALL_ENTRY( 0x00dd, NtTerminateJobObject, 8 ) \
-    SYSCALL_ENTRY( 0x00de, NtTerminateProcess, 8 ) \
-    SYSCALL_ENTRY( 0x00df, NtTerminateThread, 8 ) \
-    SYSCALL_ENTRY( 0x00e0, NtTestAlert, 0 ) \
-    SYSCALL_ENTRY( 0x00e1, NtTraceControl, 24 ) \
-    SYSCALL_ENTRY( 0x00e2, NtUnloadDriver, 4 ) \
-    SYSCALL_ENTRY( 0x00e3, NtUnloadKey, 4 ) \
-    SYSCALL_ENTRY( 0x00e4, NtUnlockFile, 20 ) \
-    SYSCALL_ENTRY( 0x00e5, NtUnlockVirtualMemory, 16 ) \
-    SYSCALL_ENTRY( 0x00e6, NtUnmapViewOfSection, 8 ) \
-    SYSCALL_ENTRY( 0x00e7, NtUnmapViewOfSectionEx, 12 ) \
-    SYSCALL_ENTRY( 0x00e8, NtWaitForAlertByThreadId, 8 ) \
-    SYSCALL_ENTRY( 0x00e9, NtWaitForDebugEvent, 16 ) \
-    SYSCALL_ENTRY( 0x00ea, NtWaitForKeyedEvent, 16 ) \
-    SYSCALL_ENTRY( 0x00eb, NtWaitForMultipleObjects, 20 ) \
-    SYSCALL_ENTRY( 0x00ec, NtWaitForSingleObject, 12 ) \
-    SYSCALL_ENTRY( 0x00ed, NtWow64AllocateVirtualMemory64, 28 ) \
-    SYSCALL_ENTRY( 0x00ee, NtWow64GetNativeSystemInformation, 16 ) \
-    SYSCALL_ENTRY( 0x00ef, NtWow64IsProcessorFeaturePresent, 4 ) \
-    SYSCALL_ENTRY( 0x00f0, NtWow64QueryInformationProcess64, 20 ) \
-    SYSCALL_ENTRY( 0x00f1, NtWow64ReadVirtualMemory64, 28 ) \
-    SYSCALL_ENTRY( 0x00f2, NtWow64WriteVirtualMemory64, 28 ) \
-    SYSCALL_ENTRY( 0x00f3, NtWriteFile, 36 ) \
-    SYSCALL_ENTRY( 0x00f4, NtWriteFileGather, 36 ) \
-    SYSCALL_ENTRY( 0x00f5, NtWriteVirtualMemory, 20 ) \
-    SYSCALL_ENTRY( 0x00f6, NtYieldExecution, 0 ) \
-    SYSCALL_ENTRY( 0x00f7, wine_nt_to_unix_file_name, 16 ) \
-    SYSCALL_ENTRY( 0x00f8, wine_unix_to_nt_file_name, 12 )
+    SYSCALL_ENTRY( 0x0006, NtAlertMultipleThreadByThreadId, 16 ) \
+    SYSCALL_ENTRY( 0x0007, NtAlertResumeThread, 8 ) \
+    SYSCALL_ENTRY( 0x0008, NtAlertThread, 4 ) \
+    SYSCALL_ENTRY( 0x0009, NtAlertThreadByThreadId, 4 ) \
+    SYSCALL_ENTRY( 0x000a, NtAllocateLocallyUniqueId, 4 ) \
+    SYSCALL_ENTRY( 0x000b, NtAllocateReserveObject, 12 ) \
+    SYSCALL_ENTRY( 0x000c, NtAllocateUuids, 16 ) \
+    SYSCALL_ENTRY( 0x000d, NtAllocateVirtualMemory, 24 ) \
+    SYSCALL_ENTRY( 0x000e, NtAllocateVirtualMemoryEx, 28 ) \
+    SYSCALL_ENTRY( 0x000f, NtAreMappedFilesTheSame, 8 ) \
+    SYSCALL_ENTRY( 0x0010, NtAssignProcessToJobObject, 8 ) \
+    SYSCALL_ENTRY( 0x0011, NtCallbackReturn, 12 ) \
+    SYSCALL_ENTRY( 0x0012, NtCancelIoFile, 8 ) \
+    SYSCALL_ENTRY( 0x0013, NtCancelIoFileEx, 12 ) \
+    SYSCALL_ENTRY( 0x0014, NtCancelSynchronousIoFile, 12 ) \
+    SYSCALL_ENTRY( 0x0015, NtCancelTimer, 8 ) \
+    SYSCALL_ENTRY( 0x0016, NtClearEvent, 4 ) \
+    SYSCALL_ENTRY( 0x0017, NtClose, 4 ) \
+    SYSCALL_ENTRY( 0x0018, NtCommitTransaction, 8 ) \
+    SYSCALL_ENTRY( 0x0019, NtCompareObjects, 8 ) \
+    SYSCALL_ENTRY( 0x001a, NtCompareTokens, 12 ) \
+    SYSCALL_ENTRY( 0x001b, NtCompleteConnectPort, 4 ) \
+    SYSCALL_ENTRY( 0x001c, NtConnectPort, 32 ) \
+    SYSCALL_ENTRY( 0x001d, NtContinue, 8 ) \
+    SYSCALL_ENTRY( 0x001e, NtContinueEx, 8 ) \
+    SYSCALL_ENTRY( 0x001f, NtConvertBetweenAuxiliaryCounterAndPerformanceCounter, 16 ) \
+    SYSCALL_ENTRY( 0x0020, NtCreateDebugObject, 16 ) \
+    SYSCALL_ENTRY( 0x0021, NtCreateDirectoryObject, 12 ) \
+    SYSCALL_ENTRY( 0x0022, NtCreateEvent, 20 ) \
+    SYSCALL_ENTRY( 0x0023, NtCreateFile, 44 ) \
+    SYSCALL_ENTRY( 0x0024, NtCreateIoCompletion, 16 ) \
+    SYSCALL_ENTRY( 0x0025, NtCreateJobObject, 12 ) \
+    SYSCALL_ENTRY( 0x0026, NtCreateKey, 28 ) \
+    SYSCALL_ENTRY( 0x0027, NtCreateKeyTransacted, 32 ) \
+    SYSCALL_ENTRY( 0x0028, NtCreateKeyedEvent, 16 ) \
+    SYSCALL_ENTRY( 0x0029, NtCreateLowBoxToken, 36 ) \
+    SYSCALL_ENTRY( 0x002a, NtCreateMailslotFile, 32 ) \
+    SYSCALL_ENTRY( 0x002b, NtCreateMutant, 16 ) \
+    SYSCALL_ENTRY( 0x002c, NtCreateNamedPipeFile, 56 ) \
+    SYSCALL_ENTRY( 0x002d, NtCreatePagingFile, 16 ) \
+    SYSCALL_ENTRY( 0x002e, NtCreatePort, 20 ) \
+    SYSCALL_ENTRY( 0x002f, NtCreateSection, 28 ) \
+    SYSCALL_ENTRY( 0x0030, NtCreateSectionEx, 36 ) \
+    SYSCALL_ENTRY( 0x0031, NtCreateSemaphore, 20 ) \
+    SYSCALL_ENTRY( 0x0032, NtCreateSymbolicLinkObject, 16 ) \
+    SYSCALL_ENTRY( 0x0033, NtCreateThread, 32 ) \
+    SYSCALL_ENTRY( 0x0034, NtCreateThreadEx, 44 ) \
+    SYSCALL_ENTRY( 0x0035, NtCreateTimer, 16 ) \
+    SYSCALL_ENTRY( 0x0036, NtCreateToken, 52 ) \
+    SYSCALL_ENTRY( 0x0037, NtCreateTransaction, 40 ) \
+    SYSCALL_ENTRY( 0x0038, NtCreateUserProcess, 44 ) \
+    SYSCALL_ENTRY( 0x0039, NtDebugActiveProcess, 8 ) \
+    SYSCALL_ENTRY( 0x003a, NtDebugContinue, 12 ) \
+    SYSCALL_ENTRY( 0x003b, NtDelayExecution, 8 ) \
+    SYSCALL_ENTRY( 0x003c, NtDeleteAtom, 4 ) \
+    SYSCALL_ENTRY( 0x003d, NtDeleteFile, 4 ) \
+    SYSCALL_ENTRY( 0x003e, NtDeleteKey, 4 ) \
+    SYSCALL_ENTRY( 0x003f, NtDeleteValueKey, 8 ) \
+    SYSCALL_ENTRY( 0x0040, NtDeviceIoControlFile, 40 ) \
+    SYSCALL_ENTRY( 0x0041, NtDisplayString, 4 ) \
+    SYSCALL_ENTRY( 0x0042, NtDuplicateObject, 28 ) \
+    SYSCALL_ENTRY( 0x0043, NtDuplicateToken, 24 ) \
+    SYSCALL_ENTRY( 0x0044, NtEnumerateKey, 24 ) \
+    SYSCALL_ENTRY( 0x0045, NtEnumerateValueKey, 24 ) \
+    SYSCALL_ENTRY( 0x0046, NtFilterToken, 24 ) \
+    SYSCALL_ENTRY( 0x0047, NtFindAtom, 12 ) \
+    SYSCALL_ENTRY( 0x0048, NtFlushBuffersFile, 8 ) \
+    SYSCALL_ENTRY( 0x0049, NtFlushBuffersFileEx, 20 ) \
+    SYSCALL_ENTRY( 0x004a, NtFlushInstructionCache, 12 ) \
+    SYSCALL_ENTRY( 0x004b, NtFlushKey, 4 ) \
+    SYSCALL_ENTRY( 0x004c, NtFlushProcessWriteBuffers, 0 ) \
+    SYSCALL_ENTRY( 0x004d, NtFlushVirtualMemory, 16 ) \
+    SYSCALL_ENTRY( 0x004e, NtFreeVirtualMemory, 16 ) \
+    SYSCALL_ENTRY( 0x004f, NtFsControlFile, 40 ) \
+    SYSCALL_ENTRY( 0x0050, NtGetContextThread, 8 ) \
+    SYSCALL_ENTRY( 0x0051, NtGetCurrentProcessorNumber, 0 ) \
+    SYSCALL_ENTRY( 0x0052, NtGetNextProcess, 20 ) \
+    SYSCALL_ENTRY( 0x0053, NtGetNextThread, 24 ) \
+    SYSCALL_ENTRY( 0x0054, NtGetNlsSectionPtr, 20 ) \
+    SYSCALL_ENTRY( 0x0055, NtGetWriteWatch, 28 ) \
+    SYSCALL_ENTRY( 0x0056, NtImpersonateAnonymousToken, 4 ) \
+    SYSCALL_ENTRY( 0x0057, NtInitializeNlsFiles, 12 ) \
+    SYSCALL_ENTRY( 0x0058, NtInitiatePowerAction, 16 ) \
+    SYSCALL_ENTRY( 0x0059, NtIsProcessInJob, 8 ) \
+    SYSCALL_ENTRY( 0x005a, NtListenPort, 8 ) \
+    SYSCALL_ENTRY( 0x005b, NtLoadDriver, 4 ) \
+    SYSCALL_ENTRY( 0x005c, NtLoadKey, 8 ) \
+    SYSCALL_ENTRY( 0x005d, NtLoadKey2, 12 ) \
+    SYSCALL_ENTRY( 0x005e, NtLoadKeyEx, 32 ) \
+    SYSCALL_ENTRY( 0x005f, NtLockFile, 40 ) \
+    SYSCALL_ENTRY( 0x0060, NtLockVirtualMemory, 16 ) \
+    SYSCALL_ENTRY( 0x0061, NtMakePermanentObject, 4 ) \
+    SYSCALL_ENTRY( 0x0062, NtMakeTemporaryObject, 4 ) \
+    SYSCALL_ENTRY( 0x0063, NtMapViewOfSection, 40 ) \
+    SYSCALL_ENTRY( 0x0064, NtMapViewOfSectionEx, 36 ) \
+    SYSCALL_ENTRY( 0x0065, NtNotifyChangeDirectoryFile, 36 ) \
+    SYSCALL_ENTRY( 0x0066, NtNotifyChangeKey, 40 ) \
+    SYSCALL_ENTRY( 0x0067, NtNotifyChangeMultipleKeys, 48 ) \
+    SYSCALL_ENTRY( 0x0068, NtOpenDirectoryObject, 12 ) \
+    SYSCALL_ENTRY( 0x0069, NtOpenEvent, 12 ) \
+    SYSCALL_ENTRY( 0x006a, NtOpenFile, 24 ) \
+    SYSCALL_ENTRY( 0x006b, NtOpenIoCompletion, 12 ) \
+    SYSCALL_ENTRY( 0x006c, NtOpenJobObject, 12 ) \
+    SYSCALL_ENTRY( 0x006d, NtOpenKey, 12 ) \
+    SYSCALL_ENTRY( 0x006e, NtOpenKeyEx, 16 ) \
+    SYSCALL_ENTRY( 0x006f, NtOpenKeyTransacted, 16 ) \
+    SYSCALL_ENTRY( 0x0070, NtOpenKeyTransactedEx, 20 ) \
+    SYSCALL_ENTRY( 0x0071, NtOpenKeyedEvent, 12 ) \
+    SYSCALL_ENTRY( 0x0072, NtOpenMutant, 12 ) \
+    SYSCALL_ENTRY( 0x0073, NtOpenProcess, 16 ) \
+    SYSCALL_ENTRY( 0x0074, NtOpenProcessToken, 12 ) \
+    SYSCALL_ENTRY( 0x0075, NtOpenProcessTokenEx, 16 ) \
+    SYSCALL_ENTRY( 0x0076, NtOpenSection, 12 ) \
+    SYSCALL_ENTRY( 0x0077, NtOpenSemaphore, 12 ) \
+    SYSCALL_ENTRY( 0x0078, NtOpenSymbolicLinkObject, 12 ) \
+    SYSCALL_ENTRY( 0x0079, NtOpenThread, 16 ) \
+    SYSCALL_ENTRY( 0x007a, NtOpenThreadToken, 16 ) \
+    SYSCALL_ENTRY( 0x007b, NtOpenThreadTokenEx, 20 ) \
+    SYSCALL_ENTRY( 0x007c, NtOpenTimer, 12 ) \
+    SYSCALL_ENTRY( 0x007d, NtPowerInformation, 20 ) \
+    SYSCALL_ENTRY( 0x007e, NtPrivilegeCheck, 12 ) \
+    SYSCALL_ENTRY( 0x007f, NtProtectVirtualMemory, 20 ) \
+    SYSCALL_ENTRY( 0x0080, NtPulseEvent, 8 ) \
+    SYSCALL_ENTRY( 0x0081, NtQueryAttributesFile, 8 ) \
+    SYSCALL_ENTRY( 0x0082, NtQueryDefaultLocale, 8 ) \
+    SYSCALL_ENTRY( 0x0083, NtQueryDefaultUILanguage, 4 ) \
+    SYSCALL_ENTRY( 0x0084, NtQueryDirectoryFile, 44 ) \
+    SYSCALL_ENTRY( 0x0085, NtQueryDirectoryObject, 28 ) \
+    SYSCALL_ENTRY( 0x0086, NtQueryEaFile, 36 ) \
+    SYSCALL_ENTRY( 0x0087, NtQueryEvent, 20 ) \
+    SYSCALL_ENTRY( 0x0088, NtQueryFullAttributesFile, 8 ) \
+    SYSCALL_ENTRY( 0x0089, NtQueryInformationAtom, 20 ) \
+    SYSCALL_ENTRY( 0x008a, NtQueryInformationFile, 20 ) \
+    SYSCALL_ENTRY( 0x008b, NtQueryInformationJobObject, 20 ) \
+    SYSCALL_ENTRY_NtQueryInformationProcess( 0x008c, NtQueryInformationProcess, 20 ) \
+    SYSCALL_ENTRY( 0x008d, NtQueryInformationThread, 20 ) \
+    SYSCALL_ENTRY( 0x008e, NtQueryInformationToken, 20 ) \
+    SYSCALL_ENTRY( 0x008f, NtQueryInstallUILanguage, 4 ) \
+    SYSCALL_ENTRY( 0x0090, NtQueryIoCompletion, 20 ) \
+    SYSCALL_ENTRY( 0x0091, NtQueryKey, 20 ) \
+    SYSCALL_ENTRY( 0x0092, NtQueryLicenseValue, 20 ) \
+    SYSCALL_ENTRY( 0x0093, NtQueryMultipleValueKey, 24 ) \
+    SYSCALL_ENTRY( 0x0094, NtQueryMutant, 20 ) \
+    SYSCALL_ENTRY( 0x0095, NtQueryObject, 20 ) \
+    SYSCALL_ENTRY( 0x0096, NtQueryPerformanceCounter, 8 ) \
+    SYSCALL_ENTRY( 0x0097, NtQuerySection, 20 ) \
+    SYSCALL_ENTRY( 0x0098, NtQuerySecurityObject, 20 ) \
+    SYSCALL_ENTRY( 0x0099, NtQuerySemaphore, 20 ) \
+    SYSCALL_ENTRY( 0x009a, NtQuerySymbolicLinkObject, 12 ) \
+    SYSCALL_ENTRY( 0x009b, NtQuerySystemEnvironmentValue, 16 ) \
+    SYSCALL_ENTRY( 0x009c, NtQuerySystemEnvironmentValueEx, 20 ) \
+    SYSCALL_ENTRY( 0x009d, NtQuerySystemInformation, 16 ) \
+    SYSCALL_ENTRY( 0x009e, NtQuerySystemInformationEx, 24 ) \
+    SYSCALL_ENTRY_NtQuerySystemTime( 0x009f, NtQuerySystemTime, 4 ) \
+    SYSCALL_ENTRY( 0x00a0, NtQueryTimer, 20 ) \
+    SYSCALL_ENTRY( 0x00a1, NtQueryTimerResolution, 12 ) \
+    SYSCALL_ENTRY( 0x00a2, NtQueryValueKey, 24 ) \
+    SYSCALL_ENTRY( 0x00a3, NtQueryVirtualMemory, 24 ) \
+    SYSCALL_ENTRY( 0x00a4, NtQueryVolumeInformationFile, 20 ) \
+    SYSCALL_ENTRY( 0x00a5, NtQueueApcThread, 20 ) \
+    SYSCALL_ENTRY( 0x00a6, NtQueueApcThreadEx, 24 ) \
+    SYSCALL_ENTRY( 0x00a7, NtRaiseException, 12 ) \
+    SYSCALL_ENTRY( 0x00a8, NtRaiseHardError, 24 ) \
+    SYSCALL_ENTRY( 0x00a9, NtReadFile, 36 ) \
+    SYSCALL_ENTRY( 0x00aa, NtReadFileScatter, 36 ) \
+    SYSCALL_ENTRY( 0x00ab, NtReadVirtualMemory, 20 ) \
+    SYSCALL_ENTRY( 0x00ac, NtRegisterThreadTerminatePort, 4 ) \
+    SYSCALL_ENTRY( 0x00ad, NtReleaseKeyedEvent, 16 ) \
+    SYSCALL_ENTRY( 0x00ae, NtReleaseMutant, 8 ) \
+    SYSCALL_ENTRY( 0x00af, NtReleaseSemaphore, 12 ) \
+    SYSCALL_ENTRY( 0x00b0, NtRemoveIoCompletion, 20 ) \
+    SYSCALL_ENTRY( 0x00b1, NtRemoveIoCompletionEx, 24 ) \
+    SYSCALL_ENTRY( 0x00b2, NtRemoveProcessDebug, 8 ) \
+    SYSCALL_ENTRY( 0x00b3, NtRenameKey, 8 ) \
+    SYSCALL_ENTRY( 0x00b4, NtReplaceKey, 12 ) \
+    SYSCALL_ENTRY( 0x00b5, NtReplyWaitReceivePort, 16 ) \
+    SYSCALL_ENTRY( 0x00b6, NtRequestWaitReplyPort, 12 ) \
+    SYSCALL_ENTRY( 0x00b7, NtResetEvent, 8 ) \
+    SYSCALL_ENTRY( 0x00b8, NtResetWriteWatch, 12 ) \
+    SYSCALL_ENTRY( 0x00b9, NtRestoreKey, 12 ) \
+    SYSCALL_ENTRY( 0x00ba, NtResumeProcess, 4 ) \
+    SYSCALL_ENTRY( 0x00bb, NtResumeThread, 8 ) \
+    SYSCALL_ENTRY( 0x00bc, NtRollbackTransaction, 8 ) \
+    SYSCALL_ENTRY( 0x00bd, NtSaveKey, 8 ) \
+    SYSCALL_ENTRY( 0x00be, NtSecureConnectPort, 36 ) \
+    SYSCALL_ENTRY( 0x00bf, NtSetContextThread, 8 ) \
+    SYSCALL_ENTRY( 0x00c0, NtSetDebugFilterState, 12 ) \
+    SYSCALL_ENTRY( 0x00c1, NtSetDefaultLocale, 8 ) \
+    SYSCALL_ENTRY( 0x00c2, NtSetDefaultUILanguage, 4 ) \
+    SYSCALL_ENTRY( 0x00c3, NtSetEaFile, 16 ) \
+    SYSCALL_ENTRY( 0x00c4, NtSetEvent, 8 ) \
+    SYSCALL_ENTRY( 0x00c5, NtSetInformationDebugObject, 20 ) \
+    SYSCALL_ENTRY( 0x00c6, NtSetInformationFile, 20 ) \
+    SYSCALL_ENTRY( 0x00c7, NtSetInformationJobObject, 16 ) \
+    SYSCALL_ENTRY( 0x00c8, NtSetInformationKey, 16 ) \
+    SYSCALL_ENTRY( 0x00c9, NtSetInformationObject, 16 ) \
+    SYSCALL_ENTRY( 0x00ca, NtSetInformationProcess, 16 ) \
+    SYSCALL_ENTRY( 0x00cb, NtSetInformationThread, 16 ) \
+    SYSCALL_ENTRY( 0x00cc, NtSetInformationToken, 16 ) \
+    SYSCALL_ENTRY( 0x00cd, NtSetInformationVirtualMemory, 24 ) \
+    SYSCALL_ENTRY( 0x00ce, NtSetIntervalProfile, 8 ) \
+    SYSCALL_ENTRY( 0x00cf, NtSetIoCompletion, 20 ) \
+    SYSCALL_ENTRY( 0x00d0, NtSetIoCompletionEx, 24 ) \
+    SYSCALL_ENTRY( 0x00d1, NtSetLdtEntries, 24 ) \
+    SYSCALL_ENTRY( 0x00d2, NtSetSecurityObject, 12 ) \
+    SYSCALL_ENTRY( 0x00d3, NtSetSystemInformation, 12 ) \
+    SYSCALL_ENTRY( 0x00d4, NtSetSystemTime, 8 ) \
+    SYSCALL_ENTRY( 0x00d5, NtSetThreadExecutionState, 8 ) \
+    SYSCALL_ENTRY( 0x00d6, NtSetTimer, 28 ) \
+    SYSCALL_ENTRY( 0x00d7, NtSetTimerResolution, 12 ) \
+    SYSCALL_ENTRY( 0x00d8, NtSetValueKey, 24 ) \
+    SYSCALL_ENTRY( 0x00d9, NtSetVolumeInformationFile, 20 ) \
+    SYSCALL_ENTRY( 0x00da, NtShutdownSystem, 4 ) \
+    SYSCALL_ENTRY( 0x00db, NtSignalAndWaitForSingleObject, 16 ) \
+    SYSCALL_ENTRY( 0x00dc, NtSuspendProcess, 4 ) \
+    SYSCALL_ENTRY( 0x00dd, NtSuspendThread, 8 ) \
+    SYSCALL_ENTRY( 0x00de, NtSystemDebugControl, 24 ) \
+    SYSCALL_ENTRY( 0x00df, NtTerminateJobObject, 8 ) \
+    SYSCALL_ENTRY( 0x00e0, NtTerminateProcess, 8 ) \
+    SYSCALL_ENTRY( 0x00e1, NtTerminateThread, 8 ) \
+    SYSCALL_ENTRY( 0x00e2, NtTestAlert, 0 ) \
+    SYSCALL_ENTRY( 0x00e3, NtTraceControl, 24 ) \
+    SYSCALL_ENTRY( 0x00e4, NtUnloadDriver, 4 ) \
+    SYSCALL_ENTRY( 0x00e5, NtUnloadKey, 4 ) \
+    SYSCALL_ENTRY( 0x00e6, NtUnlockFile, 20 ) \
+    SYSCALL_ENTRY( 0x00e7, NtUnlockVirtualMemory, 16 ) \
+    SYSCALL_ENTRY( 0x00e8, NtUnmapViewOfSection, 8 ) \
+    SYSCALL_ENTRY( 0x00e9, NtUnmapViewOfSectionEx, 12 ) \
+    SYSCALL_ENTRY( 0x00ea, NtWaitForAlertByThreadId, 8 ) \
+    SYSCALL_ENTRY( 0x00eb, NtWaitForDebugEvent, 16 ) \
+    SYSCALL_ENTRY( 0x00ec, NtWaitForKeyedEvent, 16 ) \
+    SYSCALL_ENTRY( 0x00ed, NtWaitForMultipleObjects, 20 ) \
+    SYSCALL_ENTRY( 0x00ee, NtWaitForSingleObject, 12 ) \
+    SYSCALL_ENTRY( 0x00ef, NtWow64AllocateVirtualMemory64, 28 ) \
+    SYSCALL_ENTRY( 0x00f0, NtWow64GetNativeSystemInformation, 16 ) \
+    SYSCALL_ENTRY( 0x00f1, NtWow64IsProcessorFeaturePresent, 4 ) \
+    SYSCALL_ENTRY( 0x00f2, NtWow64QueryInformationProcess64, 20 ) \
+    SYSCALL_ENTRY( 0x00f3, NtWow64ReadVirtualMemory64, 28 ) \
+    SYSCALL_ENTRY( 0x00f4, NtWow64WriteVirtualMemory64, 28 ) \
+    SYSCALL_ENTRY( 0x00f5, NtWriteFile, 36 ) \
+    SYSCALL_ENTRY( 0x00f6, NtWriteFileGather, 36 ) \
+    SYSCALL_ENTRY( 0x00f7, NtWriteVirtualMemory, 20 ) \
+    SYSCALL_ENTRY( 0x00f8, NtYieldExecution, 0 ) \
+    SYSCALL_ENTRY( 0x00f9, wine_nt_to_unix_file_name, 16 ) \
+    SYSCALL_ENTRY( 0x00fa, wine_unix_to_nt_file_name, 12 )
 #ifdef _WIN64
 #define ALL_SYSCALLS \
     SYSCALL_ENTRY( 0x0000, NtAcceptConnectPort, 48 ) \
@@ -258,243 +260,245 @@
     SYSCALL_ENTRY( 0x0003, NtAddAtom, 24 ) \
     SYSCALL_ENTRY( 0x0004, NtAdjustGroupsToken, 48 ) \
     SYSCALL_ENTRY( 0x0005, NtAdjustPrivilegesToken, 48 ) \
-    SYSCALL_ENTRY( 0x0006, NtAlertResumeThread, 16 ) \
-    SYSCALL_ENTRY( 0x0007, NtAlertThread, 8 ) \
-    SYSCALL_ENTRY( 0x0008, NtAlertThreadByThreadId, 8 ) \
-    SYSCALL_ENTRY( 0x0009, NtAllocateLocallyUniqueId, 8 ) \
-    SYSCALL_ENTRY( 0x000a, NtAllocateReserveObject, 24 ) \
-    SYSCALL_ENTRY( 0x000b, NtAllocateUuids, 32 ) \
-    SYSCALL_ENTRY( 0x000c, NtAllocateVirtualMemory, 48 ) \
-    SYSCALL_ENTRY( 0x000d, NtAllocateVirtualMemoryEx, 56 ) \
-    SYSCALL_ENTRY( 0x000e, NtAreMappedFilesTheSame, 16 ) \
-    SYSCALL_ENTRY( 0x000f, NtAssignProcessToJobObject, 16 ) \
-    SYSCALL_ENTRY( 0x0010, NtCallbackReturn, 24 ) \
-    SYSCALL_ENTRY( 0x0011, NtCancelIoFile, 16 ) \
-    SYSCALL_ENTRY( 0x0012, NtCancelIoFileEx, 24 ) \
-    SYSCALL_ENTRY( 0x0013, NtCancelSynchronousIoFile, 24 ) \
-    SYSCALL_ENTRY( 0x0014, NtCancelTimer, 16 ) \
-    SYSCALL_ENTRY( 0x0015, NtClearEvent, 8 ) \
-    SYSCALL_ENTRY( 0x0016, NtClose, 8 ) \
-    SYSCALL_ENTRY( 0x0017, NtCommitTransaction, 16 ) \
-    SYSCALL_ENTRY( 0x0018, NtCompareObjects, 16 ) \
-    SYSCALL_ENTRY( 0x0019, NtCompareTokens, 24 ) \
-    SYSCALL_ENTRY( 0x001a, NtCompleteConnectPort, 8 ) \
-    SYSCALL_ENTRY( 0x001b, NtConnectPort, 64 ) \
-    SYSCALL_ENTRY( 0x001c, NtContinue, 16 ) \
-    SYSCALL_ENTRY( 0x001d, NtContinueEx, 16 ) \
-    SYSCALL_ENTRY( 0x001e, NtConvertBetweenAuxiliaryCounterAndPerformanceCounter, 32 ) \
-    SYSCALL_ENTRY( 0x001f, NtCreateDebugObject, 32 ) \
-    SYSCALL_ENTRY( 0x0020, NtCreateDirectoryObject, 24 ) \
-    SYSCALL_ENTRY( 0x0021, NtCreateEvent, 40 ) \
-    SYSCALL_ENTRY( 0x0022, NtCreateFile, 88 ) \
-    SYSCALL_ENTRY( 0x0023, NtCreateIoCompletion, 32 ) \
-    SYSCALL_ENTRY( 0x0024, NtCreateJobObject, 24 ) \
-    SYSCALL_ENTRY( 0x0025, NtCreateKey, 56 ) \
-    SYSCALL_ENTRY( 0x0026, NtCreateKeyTransacted, 64 ) \
-    SYSCALL_ENTRY( 0x0027, NtCreateKeyedEvent, 32 ) \
-    SYSCALL_ENTRY( 0x0028, NtCreateLowBoxToken, 72 ) \
-    SYSCALL_ENTRY( 0x0029, NtCreateMailslotFile, 64 ) \
-    SYSCALL_ENTRY( 0x002a, NtCreateMutant, 32 ) \
-    SYSCALL_ENTRY( 0x002b, NtCreateNamedPipeFile, 112 ) \
-    SYSCALL_ENTRY( 0x002c, NtCreatePagingFile, 32 ) \
-    SYSCALL_ENTRY( 0x002d, NtCreatePort, 40 ) \
-    SYSCALL_ENTRY( 0x002e, NtCreateSection, 56 ) \
-    SYSCALL_ENTRY( 0x002f, NtCreateSectionEx, 72 ) \
-    SYSCALL_ENTRY( 0x0030, NtCreateSemaphore, 40 ) \
-    SYSCALL_ENTRY( 0x0031, NtCreateSymbolicLinkObject, 32 ) \
-    SYSCALL_ENTRY( 0x0032, NtCreateThread, 64 ) \
-    SYSCALL_ENTRY( 0x0033, NtCreateThreadEx, 88 ) \
-    SYSCALL_ENTRY( 0x0034, NtCreateTimer, 32 ) \
-    SYSCALL_ENTRY( 0x0035, NtCreateToken, 104 ) \
-    SYSCALL_ENTRY( 0x0036, NtCreateTransaction, 80 ) \
-    SYSCALL_ENTRY( 0x0037, NtCreateUserProcess, 88 ) \
-    SYSCALL_ENTRY( 0x0038, NtDebugActiveProcess, 16 ) \
-    SYSCALL_ENTRY( 0x0039, NtDebugContinue, 24 ) \
-    SYSCALL_ENTRY( 0x003a, NtDelayExecution, 16 ) \
-    SYSCALL_ENTRY( 0x003b, NtDeleteAtom, 8 ) \
-    SYSCALL_ENTRY( 0x003c, NtDeleteFile, 8 ) \
-    SYSCALL_ENTRY( 0x003d, NtDeleteKey, 8 ) \
-    SYSCALL_ENTRY( 0x003e, NtDeleteValueKey, 16 ) \
-    SYSCALL_ENTRY( 0x003f, NtDeviceIoControlFile, 80 ) \
-    SYSCALL_ENTRY( 0x0040, NtDisplayString, 8 ) \
-    SYSCALL_ENTRY( 0x0041, NtDuplicateObject, 56 ) \
-    SYSCALL_ENTRY( 0x0042, NtDuplicateToken, 48 ) \
-    SYSCALL_ENTRY( 0x0043, NtEnumerateKey, 48 ) \
-    SYSCALL_ENTRY( 0x0044, NtEnumerateValueKey, 48 ) \
-    SYSCALL_ENTRY( 0x0045, NtFilterToken, 48 ) \
-    SYSCALL_ENTRY( 0x0046, NtFindAtom, 24 ) \
-    SYSCALL_ENTRY( 0x0047, NtFlushBuffersFile, 16 ) \
-    SYSCALL_ENTRY( 0x0048, NtFlushBuffersFileEx, 40 ) \
-    SYSCALL_ENTRY( 0x0049, NtFlushInstructionCache, 24 ) \
-    SYSCALL_ENTRY( 0x004a, NtFlushKey, 8 ) \
-    SYSCALL_ENTRY( 0x004b, NtFlushProcessWriteBuffers, 0 ) \
-    SYSCALL_ENTRY( 0x004c, NtFlushVirtualMemory, 32 ) \
-    SYSCALL_ENTRY( 0x004d, NtFreeVirtualMemory, 32 ) \
-    SYSCALL_ENTRY( 0x004e, NtFsControlFile, 80 ) \
-    SYSCALL_ENTRY( 0x004f, NtGetContextThread, 16 ) \
-    SYSCALL_ENTRY( 0x0050, NtGetCurrentProcessorNumber, 0 ) \
-    SYSCALL_ENTRY( 0x0051, NtGetNextThread, 48 ) \
-    SYSCALL_ENTRY( 0x0052, NtGetNlsSectionPtr, 40 ) \
-    SYSCALL_ENTRY( 0x0053, NtGetWriteWatch, 56 ) \
-    SYSCALL_ENTRY( 0x0054, NtImpersonateAnonymousToken, 8 ) \
-    SYSCALL_ENTRY( 0x0055, NtInitializeNlsFiles, 24 ) \
-    SYSCALL_ENTRY( 0x0056, NtInitiatePowerAction, 32 ) \
-    SYSCALL_ENTRY( 0x0057, NtIsProcessInJob, 16 ) \
-    SYSCALL_ENTRY( 0x0058, NtListenPort, 16 ) \
-    SYSCALL_ENTRY( 0x0059, NtLoadDriver, 8 ) \
-    SYSCALL_ENTRY( 0x005a, NtLoadKey, 16 ) \
-    SYSCALL_ENTRY( 0x005b, NtLoadKey2, 24 ) \
-    SYSCALL_ENTRY( 0x005c, NtLoadKeyEx, 64 ) \
-    SYSCALL_ENTRY( 0x005d, NtLockFile, 80 ) \
-    SYSCALL_ENTRY( 0x005e, NtLockVirtualMemory, 32 ) \
-    SYSCALL_ENTRY( 0x005f, NtMakePermanentObject, 8 ) \
-    SYSCALL_ENTRY( 0x0060, NtMakeTemporaryObject, 8 ) \
-    SYSCALL_ENTRY( 0x0061, NtMapViewOfSection, 80 ) \
-    SYSCALL_ENTRY( 0x0062, NtMapViewOfSectionEx, 72 ) \
-    SYSCALL_ENTRY( 0x0063, NtNotifyChangeDirectoryFile, 72 ) \
-    SYSCALL_ENTRY( 0x0064, NtNotifyChangeKey, 80 ) \
-    SYSCALL_ENTRY( 0x0065, NtNotifyChangeMultipleKeys, 96 ) \
-    SYSCALL_ENTRY( 0x0066, NtOpenDirectoryObject, 24 ) \
-    SYSCALL_ENTRY( 0x0067, NtOpenEvent, 24 ) \
-    SYSCALL_ENTRY( 0x0068, NtOpenFile, 48 ) \
-    SYSCALL_ENTRY( 0x0069, NtOpenIoCompletion, 24 ) \
-    SYSCALL_ENTRY( 0x006a, NtOpenJobObject, 24 ) \
-    SYSCALL_ENTRY( 0x006b, NtOpenKey, 24 ) \
-    SYSCALL_ENTRY( 0x006c, NtOpenKeyEx, 32 ) \
-    SYSCALL_ENTRY( 0x006d, NtOpenKeyTransacted, 32 ) \
-    SYSCALL_ENTRY( 0x006e, NtOpenKeyTransactedEx, 40 ) \
-    SYSCALL_ENTRY( 0x006f, NtOpenKeyedEvent, 24 ) \
-    SYSCALL_ENTRY( 0x0070, NtOpenMutant, 24 ) \
-    SYSCALL_ENTRY( 0x0071, NtOpenProcess, 32 ) \
-    SYSCALL_ENTRY( 0x0072, NtOpenProcessToken, 24 ) \
-    SYSCALL_ENTRY( 0x0073, NtOpenProcessTokenEx, 32 ) \
-    SYSCALL_ENTRY( 0x0074, NtOpenSection, 24 ) \
-    SYSCALL_ENTRY( 0x0075, NtOpenSemaphore, 24 ) \
-    SYSCALL_ENTRY( 0x0076, NtOpenSymbolicLinkObject, 24 ) \
-    SYSCALL_ENTRY( 0x0077, NtOpenThread, 32 ) \
-    SYSCALL_ENTRY( 0x0078, NtOpenThreadToken, 32 ) \
-    SYSCALL_ENTRY( 0x0079, NtOpenThreadTokenEx, 40 ) \
-    SYSCALL_ENTRY( 0x007a, NtOpenTimer, 24 ) \
-    SYSCALL_ENTRY( 0x007b, NtPowerInformation, 40 ) \
-    SYSCALL_ENTRY( 0x007c, NtPrivilegeCheck, 24 ) \
-    SYSCALL_ENTRY( 0x007d, NtProtectVirtualMemory, 40 ) \
-    SYSCALL_ENTRY( 0x007e, NtPulseEvent, 16 ) \
-    SYSCALL_ENTRY( 0x007f, NtQueryAttributesFile, 16 ) \
-    SYSCALL_ENTRY( 0x0080, NtQueryDefaultLocale, 16 ) \
-    SYSCALL_ENTRY( 0x0081, NtQueryDefaultUILanguage, 8 ) \
-    SYSCALL_ENTRY( 0x0082, NtQueryDirectoryFile, 88 ) \
-    SYSCALL_ENTRY( 0x0083, NtQueryDirectoryObject, 56 ) \
-    SYSCALL_ENTRY( 0x0084, NtQueryEaFile, 72 ) \
-    SYSCALL_ENTRY( 0x0085, NtQueryEvent, 40 ) \
-    SYSCALL_ENTRY( 0x0086, NtQueryFullAttributesFile, 16 ) \
-    SYSCALL_ENTRY( 0x0087, NtQueryInformationAtom, 40 ) \
-    SYSCALL_ENTRY( 0x0088, NtQueryInformationFile, 40 ) \
-    SYSCALL_ENTRY( 0x0089, NtQueryInformationJobObject, 40 ) \
-    SYSCALL_ENTRY_NtQueryInformationProcess( 0x008a, NtQueryInformationProcess, 40 ) \
-    SYSCALL_ENTRY( 0x008b, NtQueryInformationThread, 40 ) \
-    SYSCALL_ENTRY( 0x008c, NtQueryInformationToken, 40 ) \
-    SYSCALL_ENTRY( 0x008d, NtQueryInstallUILanguage, 8 ) \
-    SYSCALL_ENTRY( 0x008e, NtQueryIoCompletion, 40 ) \
-    SYSCALL_ENTRY( 0x008f, NtQueryKey, 40 ) \
-    SYSCALL_ENTRY( 0x0090, NtQueryLicenseValue, 40 ) \
-    SYSCALL_ENTRY( 0x0091, NtQueryMultipleValueKey, 48 ) \
-    SYSCALL_ENTRY( 0x0092, NtQueryMutant, 40 ) \
-    SYSCALL_ENTRY( 0x0093, NtQueryObject, 40 ) \
-    SYSCALL_ENTRY( 0x0094, NtQueryPerformanceCounter, 16 ) \
-    SYSCALL_ENTRY( 0x0095, NtQuerySection, 40 ) \
-    SYSCALL_ENTRY( 0x0096, NtQuerySecurityObject, 40 ) \
-    SYSCALL_ENTRY( 0x0097, NtQuerySemaphore, 40 ) \
-    SYSCALL_ENTRY( 0x0098, NtQuerySymbolicLinkObject, 24 ) \
-    SYSCALL_ENTRY( 0x0099, NtQuerySystemEnvironmentValue, 32 ) \
-    SYSCALL_ENTRY( 0x009a, NtQuerySystemEnvironmentValueEx, 40 ) \
-    SYSCALL_ENTRY( 0x009b, NtQuerySystemInformation, 32 ) \
-    SYSCALL_ENTRY( 0x009c, NtQuerySystemInformationEx, 48 ) \
-    SYSCALL_ENTRY_NtQuerySystemTime( 0x009d, NtQuerySystemTime, 8 ) \
-    SYSCALL_ENTRY( 0x009e, NtQueryTimer, 40 ) \
-    SYSCALL_ENTRY( 0x009f, NtQueryTimerResolution, 24 ) \
-    SYSCALL_ENTRY( 0x00a0, NtQueryValueKey, 48 ) \
-    SYSCALL_ENTRY( 0x00a1, NtQueryVirtualMemory, 48 ) \
-    SYSCALL_ENTRY( 0x00a2, NtQueryVolumeInformationFile, 40 ) \
-    SYSCALL_ENTRY( 0x00a3, NtQueueApcThread, 40 ) \
-    SYSCALL_ENTRY( 0x00a4, NtQueueApcThreadEx, 48 ) \
-    SYSCALL_ENTRY( 0x00a5, NtRaiseException, 24 ) \
-    SYSCALL_ENTRY( 0x00a6, NtRaiseHardError, 48 ) \
-    SYSCALL_ENTRY( 0x00a7, NtReadFile, 72 ) \
-    SYSCALL_ENTRY( 0x00a8, NtReadFileScatter, 72 ) \
-    SYSCALL_ENTRY( 0x00a9, NtReadVirtualMemory, 40 ) \
-    SYSCALL_ENTRY( 0x00aa, NtRegisterThreadTerminatePort, 8 ) \
-    SYSCALL_ENTRY( 0x00ab, NtReleaseKeyedEvent, 32 ) \
-    SYSCALL_ENTRY( 0x00ac, NtReleaseMutant, 16 ) \
-    SYSCALL_ENTRY( 0x00ad, NtReleaseSemaphore, 24 ) \
-    SYSCALL_ENTRY( 0x00ae, NtRemoveIoCompletion, 40 ) \
-    SYSCALL_ENTRY( 0x00af, NtRemoveIoCompletionEx, 48 ) \
-    SYSCALL_ENTRY( 0x00b0, NtRemoveProcessDebug, 16 ) \
-    SYSCALL_ENTRY( 0x00b1, NtRenameKey, 16 ) \
-    SYSCALL_ENTRY( 0x00b2, NtReplaceKey, 24 ) \
-    SYSCALL_ENTRY( 0x00b3, NtReplyWaitReceivePort, 32 ) \
-    SYSCALL_ENTRY( 0x00b4, NtRequestWaitReplyPort, 24 ) \
-    SYSCALL_ENTRY( 0x00b5, NtResetEvent, 16 ) \
-    SYSCALL_ENTRY( 0x00b6, NtResetWriteWatch, 24 ) \
-    SYSCALL_ENTRY( 0x00b7, NtRestoreKey, 24 ) \
-    SYSCALL_ENTRY( 0x00b8, NtResumeProcess, 8 ) \
-    SYSCALL_ENTRY( 0x00b9, NtResumeThread, 16 ) \
-    SYSCALL_ENTRY( 0x00ba, NtRollbackTransaction, 16 ) \
-    SYSCALL_ENTRY( 0x00bb, NtSaveKey, 16 ) \
-    SYSCALL_ENTRY( 0x00bc, NtSecureConnectPort, 72 ) \
-    SYSCALL_ENTRY( 0x00bd, NtSetContextThread, 16 ) \
-    SYSCALL_ENTRY( 0x00be, NtSetDebugFilterState, 24 ) \
-    SYSCALL_ENTRY( 0x00bf, NtSetDefaultLocale, 16 ) \
-    SYSCALL_ENTRY( 0x00c0, NtSetDefaultUILanguage, 8 ) \
-    SYSCALL_ENTRY( 0x00c1, NtSetEaFile, 32 ) \
-    SYSCALL_ENTRY( 0x00c2, NtSetEvent, 16 ) \
-    SYSCALL_ENTRY( 0x00c3, NtSetInformationDebugObject, 40 ) \
-    SYSCALL_ENTRY( 0x00c4, NtSetInformationFile, 40 ) \
-    SYSCALL_ENTRY( 0x00c5, NtSetInformationJobObject, 32 ) \
-    SYSCALL_ENTRY( 0x00c6, NtSetInformationKey, 32 ) \
-    SYSCALL_ENTRY( 0x00c7, NtSetInformationObject, 32 ) \
-    SYSCALL_ENTRY( 0x00c8, NtSetInformationProcess, 32 ) \
-    SYSCALL_ENTRY( 0x00c9, NtSetInformationThread, 32 ) \
-    SYSCALL_ENTRY( 0x00ca, NtSetInformationToken, 32 ) \
-    SYSCALL_ENTRY( 0x00cb, NtSetInformationVirtualMemory, 48 ) \
-    SYSCALL_ENTRY( 0x00cc, NtSetIntervalProfile, 16 ) \
-    SYSCALL_ENTRY( 0x00cd, NtSetIoCompletion, 40 ) \
-    SYSCALL_ENTRY( 0x00ce, NtSetIoCompletionEx, 48 ) \
-    SYSCALL_ENTRY( 0x00cf, NtSetLdtEntries, 32 ) \
-    SYSCALL_ENTRY( 0x00d0, NtSetSecurityObject, 24 ) \
-    SYSCALL_ENTRY( 0x00d1, NtSetSystemInformation, 24 ) \
-    SYSCALL_ENTRY( 0x00d2, NtSetSystemTime, 16 ) \
-    SYSCALL_ENTRY( 0x00d3, NtSetThreadExecutionState, 16 ) \
-    SYSCALL_ENTRY( 0x00d4, NtSetTimer, 56 ) \
-    SYSCALL_ENTRY( 0x00d5, NtSetTimerResolution, 24 ) \
-    SYSCALL_ENTRY( 0x00d6, NtSetValueKey, 48 ) \
-    SYSCALL_ENTRY( 0x00d7, NtSetVolumeInformationFile, 40 ) \
-    SYSCALL_ENTRY( 0x00d8, NtShutdownSystem, 8 ) \
-    SYSCALL_ENTRY( 0x00d9, NtSignalAndWaitForSingleObject, 32 ) \
-    SYSCALL_ENTRY( 0x00da, NtSuspendProcess, 8 ) \
-    SYSCALL_ENTRY( 0x00db, NtSuspendThread, 16 ) \
-    SYSCALL_ENTRY( 0x00dc, NtSystemDebugControl, 48 ) \
-    SYSCALL_ENTRY( 0x00dd, NtTerminateJobObject, 16 ) \
-    SYSCALL_ENTRY( 0x00de, NtTerminateProcess, 16 ) \
-    SYSCALL_ENTRY( 0x00df, NtTerminateThread, 16 ) \
-    SYSCALL_ENTRY( 0x00e0, NtTestAlert, 0 ) \
-    SYSCALL_ENTRY( 0x00e1, NtTraceControl, 48 ) \
-    SYSCALL_ENTRY( 0x00e2, NtUnloadDriver, 8 ) \
-    SYSCALL_ENTRY( 0x00e3, NtUnloadKey, 8 ) \
-    SYSCALL_ENTRY( 0x00e4, NtUnlockFile, 40 ) \
-    SYSCALL_ENTRY( 0x00e5, NtUnlockVirtualMemory, 32 ) \
-    SYSCALL_ENTRY( 0x00e6, NtUnmapViewOfSection, 16 ) \
-    SYSCALL_ENTRY( 0x00e7, NtUnmapViewOfSectionEx, 24 ) \
-    SYSCALL_ENTRY( 0x00e8, NtWaitForAlertByThreadId, 16 ) \
-    SYSCALL_ENTRY( 0x00e9, NtWaitForDebugEvent, 32 ) \
-    SYSCALL_ENTRY( 0x00ea, NtWaitForKeyedEvent, 32 ) \
-    SYSCALL_ENTRY( 0x00eb, NtWaitForMultipleObjects, 40 ) \
-    SYSCALL_ENTRY( 0x00ec, NtWaitForSingleObject, 24 ) \
-    SYSCALL_ENTRY( 0x00ed, NtWriteFile, 72 ) \
-    SYSCALL_ENTRY( 0x00ee, NtWriteFileGather, 72 ) \
-    SYSCALL_ENTRY( 0x00ef, NtWriteVirtualMemory, 40 ) \
-    SYSCALL_ENTRY( 0x00f0, NtYieldExecution, 0 ) \
-    SYSCALL_ENTRY( 0x00f1, wine_nt_to_unix_file_name, 32 ) \
-    SYSCALL_ENTRY( 0x00f2, wine_unix_to_nt_file_name, 24 )
+    SYSCALL_ENTRY( 0x0006, NtAlertMultipleThreadByThreadId, 32 ) \
+    SYSCALL_ENTRY( 0x0007, NtAlertResumeThread, 16 ) \
+    SYSCALL_ENTRY( 0x0008, NtAlertThread, 8 ) \
+    SYSCALL_ENTRY( 0x0009, NtAlertThreadByThreadId, 8 ) \
+    SYSCALL_ENTRY( 0x000a, NtAllocateLocallyUniqueId, 8 ) \
+    SYSCALL_ENTRY( 0x000b, NtAllocateReserveObject, 24 ) \
+    SYSCALL_ENTRY( 0x000c, NtAllocateUuids, 32 ) \
+    SYSCALL_ENTRY( 0x000d, NtAllocateVirtualMemory, 48 ) \
+    SYSCALL_ENTRY( 0x000e, NtAllocateVirtualMemoryEx, 56 ) \
+    SYSCALL_ENTRY( 0x000f, NtAreMappedFilesTheSame, 16 ) \
+    SYSCALL_ENTRY( 0x0010, NtAssignProcessToJobObject, 16 ) \
+    SYSCALL_ENTRY( 0x0011, NtCallbackReturn, 24 ) \
+    SYSCALL_ENTRY( 0x0012, NtCancelIoFile, 16 ) \
+    SYSCALL_ENTRY( 0x0013, NtCancelIoFileEx, 24 ) \
+    SYSCALL_ENTRY( 0x0014, NtCancelSynchronousIoFile, 24 ) \
+    SYSCALL_ENTRY( 0x0015, NtCancelTimer, 16 ) \
+    SYSCALL_ENTRY( 0x0016, NtClearEvent, 8 ) \
+    SYSCALL_ENTRY( 0x0017, NtClose, 8 ) \
+    SYSCALL_ENTRY( 0x0018, NtCommitTransaction, 16 ) \
+    SYSCALL_ENTRY( 0x0019, NtCompareObjects, 16 ) \
+    SYSCALL_ENTRY( 0x001a, NtCompareTokens, 24 ) \
+    SYSCALL_ENTRY( 0x001b, NtCompleteConnectPort, 8 ) \
+    SYSCALL_ENTRY( 0x001c, NtConnectPort, 64 ) \
+    SYSCALL_ENTRY( 0x001d, NtContinue, 16 ) \
+    SYSCALL_ENTRY( 0x001e, NtContinueEx, 16 ) \
+    SYSCALL_ENTRY( 0x001f, NtConvertBetweenAuxiliaryCounterAndPerformanceCounter, 32 ) \
+    SYSCALL_ENTRY( 0x0020, NtCreateDebugObject, 32 ) \
+    SYSCALL_ENTRY( 0x0021, NtCreateDirectoryObject, 24 ) \
+    SYSCALL_ENTRY( 0x0022, NtCreateEvent, 40 ) \
+    SYSCALL_ENTRY( 0x0023, NtCreateFile, 88 ) \
+    SYSCALL_ENTRY( 0x0024, NtCreateIoCompletion, 32 ) \
+    SYSCALL_ENTRY( 0x0025, NtCreateJobObject, 24 ) \
+    SYSCALL_ENTRY( 0x0026, NtCreateKey, 56 ) \
+    SYSCALL_ENTRY( 0x0027, NtCreateKeyTransacted, 64 ) \
+    SYSCALL_ENTRY( 0x0028, NtCreateKeyedEvent, 32 ) \
+    SYSCALL_ENTRY( 0x0029, NtCreateLowBoxToken, 72 ) \
+    SYSCALL_ENTRY( 0x002a, NtCreateMailslotFile, 64 ) \
+    SYSCALL_ENTRY( 0x002b, NtCreateMutant, 32 ) \
+    SYSCALL_ENTRY( 0x002c, NtCreateNamedPipeFile, 112 ) \
+    SYSCALL_ENTRY( 0x002d, NtCreatePagingFile, 32 ) \
+    SYSCALL_ENTRY( 0x002e, NtCreatePort, 40 ) \
+    SYSCALL_ENTRY( 0x002f, NtCreateSection, 56 ) \
+    SYSCALL_ENTRY( 0x0030, NtCreateSectionEx, 72 ) \
+    SYSCALL_ENTRY( 0x0031, NtCreateSemaphore, 40 ) \
+    SYSCALL_ENTRY( 0x0032, NtCreateSymbolicLinkObject, 32 ) \
+    SYSCALL_ENTRY( 0x0033, NtCreateThread, 64 ) \
+    SYSCALL_ENTRY( 0x0034, NtCreateThreadEx, 88 ) \
+    SYSCALL_ENTRY( 0x0035, NtCreateTimer, 32 ) \
+    SYSCALL_ENTRY( 0x0036, NtCreateToken, 104 ) \
+    SYSCALL_ENTRY( 0x0037, NtCreateTransaction, 80 ) \
+    SYSCALL_ENTRY( 0x0038, NtCreateUserProcess, 88 ) \
+    SYSCALL_ENTRY( 0x0039, NtDebugActiveProcess, 16 ) \
+    SYSCALL_ENTRY( 0x003a, NtDebugContinue, 24 ) \
+    SYSCALL_ENTRY( 0x003b, NtDelayExecution, 16 ) \
+    SYSCALL_ENTRY( 0x003c, NtDeleteAtom, 8 ) \
+    SYSCALL_ENTRY( 0x003d, NtDeleteFile, 8 ) \
+    SYSCALL_ENTRY( 0x003e, NtDeleteKey, 8 ) \
+    SYSCALL_ENTRY( 0x003f, NtDeleteValueKey, 16 ) \
+    SYSCALL_ENTRY( 0x0040, NtDeviceIoControlFile, 80 ) \
+    SYSCALL_ENTRY( 0x0041, NtDisplayString, 8 ) \
+    SYSCALL_ENTRY( 0x0042, NtDuplicateObject, 56 ) \
+    SYSCALL_ENTRY( 0x0043, NtDuplicateToken, 48 ) \
+    SYSCALL_ENTRY( 0x0044, NtEnumerateKey, 48 ) \
+    SYSCALL_ENTRY( 0x0045, NtEnumerateValueKey, 48 ) \
+    SYSCALL_ENTRY( 0x0046, NtFilterToken, 48 ) \
+    SYSCALL_ENTRY( 0x0047, NtFindAtom, 24 ) \
+    SYSCALL_ENTRY( 0x0048, NtFlushBuffersFile, 16 ) \
+    SYSCALL_ENTRY( 0x0049, NtFlushBuffersFileEx, 40 ) \
+    SYSCALL_ENTRY( 0x004a, NtFlushInstructionCache, 24 ) \
+    SYSCALL_ENTRY( 0x004b, NtFlushKey, 8 ) \
+    SYSCALL_ENTRY( 0x004c, NtFlushProcessWriteBuffers, 0 ) \
+    SYSCALL_ENTRY( 0x004d, NtFlushVirtualMemory, 32 ) \
+    SYSCALL_ENTRY( 0x004e, NtFreeVirtualMemory, 32 ) \
+    SYSCALL_ENTRY( 0x004f, NtFsControlFile, 80 ) \
+    SYSCALL_ENTRY( 0x0050, NtGetContextThread, 16 ) \
+    SYSCALL_ENTRY( 0x0051, NtGetCurrentProcessorNumber, 0 ) \
+    SYSCALL_ENTRY( 0x0052, NtGetNextProcess, 40 ) \
+    SYSCALL_ENTRY( 0x0053, NtGetNextThread, 48 ) \
+    SYSCALL_ENTRY( 0x0054, NtGetNlsSectionPtr, 40 ) \
+    SYSCALL_ENTRY( 0x0055, NtGetWriteWatch, 56 ) \
+    SYSCALL_ENTRY( 0x0056, NtImpersonateAnonymousToken, 8 ) \
+    SYSCALL_ENTRY( 0x0057, NtInitializeNlsFiles, 24 ) \
+    SYSCALL_ENTRY( 0x0058, NtInitiatePowerAction, 32 ) \
+    SYSCALL_ENTRY( 0x0059, NtIsProcessInJob, 16 ) \
+    SYSCALL_ENTRY( 0x005a, NtListenPort, 16 ) \
+    SYSCALL_ENTRY( 0x005b, NtLoadDriver, 8 ) \
+    SYSCALL_ENTRY( 0x005c, NtLoadKey, 16 ) \
+    SYSCALL_ENTRY( 0x005d, NtLoadKey2, 24 ) \
+    SYSCALL_ENTRY( 0x005e, NtLoadKeyEx, 64 ) \
+    SYSCALL_ENTRY( 0x005f, NtLockFile, 80 ) \
+    SYSCALL_ENTRY( 0x0060, NtLockVirtualMemory, 32 ) \
+    SYSCALL_ENTRY( 0x0061, NtMakePermanentObject, 8 ) \
+    SYSCALL_ENTRY( 0x0062, NtMakeTemporaryObject, 8 ) \
+    SYSCALL_ENTRY( 0x0063, NtMapViewOfSection, 80 ) \
+    SYSCALL_ENTRY( 0x0064, NtMapViewOfSectionEx, 72 ) \
+    SYSCALL_ENTRY( 0x0065, NtNotifyChangeDirectoryFile, 72 ) \
+    SYSCALL_ENTRY( 0x0066, NtNotifyChangeKey, 80 ) \
+    SYSCALL_ENTRY( 0x0067, NtNotifyChangeMultipleKeys, 96 ) \
+    SYSCALL_ENTRY( 0x0068, NtOpenDirectoryObject, 24 ) \
+    SYSCALL_ENTRY( 0x0069, NtOpenEvent, 24 ) \
+    SYSCALL_ENTRY( 0x006a, NtOpenFile, 48 ) \
+    SYSCALL_ENTRY( 0x006b, NtOpenIoCompletion, 24 ) \
+    SYSCALL_ENTRY( 0x006c, NtOpenJobObject, 24 ) \
+    SYSCALL_ENTRY( 0x006d, NtOpenKey, 24 ) \
+    SYSCALL_ENTRY( 0x006e, NtOpenKeyEx, 32 ) \
+    SYSCALL_ENTRY( 0x006f, NtOpenKeyTransacted, 32 ) \
+    SYSCALL_ENTRY( 0x0070, NtOpenKeyTransactedEx, 40 ) \
+    SYSCALL_ENTRY( 0x0071, NtOpenKeyedEvent, 24 ) \
+    SYSCALL_ENTRY( 0x0072, NtOpenMutant, 24 ) \
+    SYSCALL_ENTRY( 0x0073, NtOpenProcess, 32 ) \
+    SYSCALL_ENTRY( 0x0074, NtOpenProcessToken, 24 ) \
+    SYSCALL_ENTRY( 0x0075, NtOpenProcessTokenEx, 32 ) \
+    SYSCALL_ENTRY( 0x0076, NtOpenSection, 24 ) \
+    SYSCALL_ENTRY( 0x0077, NtOpenSemaphore, 24 ) \
+    SYSCALL_ENTRY( 0x0078, NtOpenSymbolicLinkObject, 24 ) \
+    SYSCALL_ENTRY( 0x0079, NtOpenThread, 32 ) \
+    SYSCALL_ENTRY( 0x007a, NtOpenThreadToken, 32 ) \
+    SYSCALL_ENTRY( 0x007b, NtOpenThreadTokenEx, 40 ) \
+    SYSCALL_ENTRY( 0x007c, NtOpenTimer, 24 ) \
+    SYSCALL_ENTRY( 0x007d, NtPowerInformation, 40 ) \
+    SYSCALL_ENTRY( 0x007e, NtPrivilegeCheck, 24 ) \
+    SYSCALL_ENTRY( 0x007f, NtProtectVirtualMemory, 40 ) \
+    SYSCALL_ENTRY( 0x0080, NtPulseEvent, 16 ) \
+    SYSCALL_ENTRY( 0x0081, NtQueryAttributesFile, 16 ) \
+    SYSCALL_ENTRY( 0x0082, NtQueryDefaultLocale, 16 ) \
+    SYSCALL_ENTRY( 0x0083, NtQueryDefaultUILanguage, 8 ) \
+    SYSCALL_ENTRY( 0x0084, NtQueryDirectoryFile, 88 ) \
+    SYSCALL_ENTRY( 0x0085, NtQueryDirectoryObject, 56 ) \
+    SYSCALL_ENTRY( 0x0086, NtQueryEaFile, 72 ) \
+    SYSCALL_ENTRY( 0x0087, NtQueryEvent, 40 ) \
+    SYSCALL_ENTRY( 0x0088, NtQueryFullAttributesFile, 16 ) \
+    SYSCALL_ENTRY( 0x0089, NtQueryInformationAtom, 40 ) \
+    SYSCALL_ENTRY( 0x008a, NtQueryInformationFile, 40 ) \
+    SYSCALL_ENTRY( 0x008b, NtQueryInformationJobObject, 40 ) \
+    SYSCALL_ENTRY_NtQueryInformationProcess( 0x008c, NtQueryInformationProcess, 40 ) \
+    SYSCALL_ENTRY( 0x008d, NtQueryInformationThread, 40 ) \
+    SYSCALL_ENTRY( 0x008e, NtQueryInformationToken, 40 ) \
+    SYSCALL_ENTRY( 0x008f, NtQueryInstallUILanguage, 8 ) \
+    SYSCALL_ENTRY( 0x0090, NtQueryIoCompletion, 40 ) \
+    SYSCALL_ENTRY( 0x0091, NtQueryKey, 40 ) \
+    SYSCALL_ENTRY( 0x0092, NtQueryLicenseValue, 40 ) \
+    SYSCALL_ENTRY( 0x0093, NtQueryMultipleValueKey, 48 ) \
+    SYSCALL_ENTRY( 0x0094, NtQueryMutant, 40 ) \
+    SYSCALL_ENTRY( 0x0095, NtQueryObject, 40 ) \
+    SYSCALL_ENTRY( 0x0096, NtQueryPerformanceCounter, 16 ) \
+    SYSCALL_ENTRY( 0x0097, NtQuerySection, 40 ) \
+    SYSCALL_ENTRY( 0x0098, NtQuerySecurityObject, 40 ) \
+    SYSCALL_ENTRY( 0x0099, NtQuerySemaphore, 40 ) \
+    SYSCALL_ENTRY( 0x009a, NtQuerySymbolicLinkObject, 24 ) \
+    SYSCALL_ENTRY( 0x009b, NtQuerySystemEnvironmentValue, 32 ) \
+    SYSCALL_ENTRY( 0x009c, NtQuerySystemEnvironmentValueEx, 40 ) \
+    SYSCALL_ENTRY( 0x009d, NtQuerySystemInformation, 32 ) \
+    SYSCALL_ENTRY( 0x009e, NtQuerySystemInformationEx, 48 ) \
+    SYSCALL_ENTRY_NtQuerySystemTime( 0x009f, NtQuerySystemTime, 8 ) \
+    SYSCALL_ENTRY( 0x00a0, NtQueryTimer, 40 ) \
+    SYSCALL_ENTRY( 0x00a1, NtQueryTimerResolution, 24 ) \
+    SYSCALL_ENTRY( 0x00a2, NtQueryValueKey, 48 ) \
+    SYSCALL_ENTRY( 0x00a3, NtQueryVirtualMemory, 48 ) \
+    SYSCALL_ENTRY( 0x00a4, NtQueryVolumeInformationFile, 40 ) \
+    SYSCALL_ENTRY( 0x00a5, NtQueueApcThread, 40 ) \
+    SYSCALL_ENTRY( 0x00a6, NtQueueApcThreadEx, 48 ) \
+    SYSCALL_ENTRY( 0x00a7, NtRaiseException, 24 ) \
+    SYSCALL_ENTRY( 0x00a8, NtRaiseHardError, 48 ) \
+    SYSCALL_ENTRY( 0x00a9, NtReadFile, 72 ) \
+    SYSCALL_ENTRY( 0x00aa, NtReadFileScatter, 72 ) \
+    SYSCALL_ENTRY( 0x00ab, NtReadVirtualMemory, 40 ) \
+    SYSCALL_ENTRY( 0x00ac, NtRegisterThreadTerminatePort, 8 ) \
+    SYSCALL_ENTRY( 0x00ad, NtReleaseKeyedEvent, 32 ) \
+    SYSCALL_ENTRY( 0x00ae, NtReleaseMutant, 16 ) \
+    SYSCALL_ENTRY( 0x00af, NtReleaseSemaphore, 24 ) \
+    SYSCALL_ENTRY( 0x00b0, NtRemoveIoCompletion, 40 ) \
+    SYSCALL_ENTRY( 0x00b1, NtRemoveIoCompletionEx, 48 ) \
+    SYSCALL_ENTRY( 0x00b2, NtRemoveProcessDebug, 16 ) \
+    SYSCALL_ENTRY( 0x00b3, NtRenameKey, 16 ) \
+    SYSCALL_ENTRY( 0x00b4, NtReplaceKey, 24 ) \
+    SYSCALL_ENTRY( 0x00b5, NtReplyWaitReceivePort, 32 ) \
+    SYSCALL_ENTRY( 0x00b6, NtRequestWaitReplyPort, 24 ) \
+    SYSCALL_ENTRY( 0x00b7, NtResetEvent, 16 ) \
+    SYSCALL_ENTRY( 0x00b8, NtResetWriteWatch, 24 ) \
+    SYSCALL_ENTRY( 0x00b9, NtRestoreKey, 24 ) \
+    SYSCALL_ENTRY( 0x00ba, NtResumeProcess, 8 ) \
+    SYSCALL_ENTRY( 0x00bb, NtResumeThread, 16 ) \
+    SYSCALL_ENTRY( 0x00bc, NtRollbackTransaction, 16 ) \
+    SYSCALL_ENTRY( 0x00bd, NtSaveKey, 16 ) \
+    SYSCALL_ENTRY( 0x00be, NtSecureConnectPort, 72 ) \
+    SYSCALL_ENTRY( 0x00bf, NtSetContextThread, 16 ) \
+    SYSCALL_ENTRY( 0x00c0, NtSetDebugFilterState, 24 ) \
+    SYSCALL_ENTRY( 0x00c1, NtSetDefaultLocale, 16 ) \
+    SYSCALL_ENTRY( 0x00c2, NtSetDefaultUILanguage, 8 ) \
+    SYSCALL_ENTRY( 0x00c3, NtSetEaFile, 32 ) \
+    SYSCALL_ENTRY( 0x00c4, NtSetEvent, 16 ) \
+    SYSCALL_ENTRY( 0x00c5, NtSetInformationDebugObject, 40 ) \
+    SYSCALL_ENTRY( 0x00c6, NtSetInformationFile, 40 ) \
+    SYSCALL_ENTRY( 0x00c7, NtSetInformationJobObject, 32 ) \
+    SYSCALL_ENTRY( 0x00c8, NtSetInformationKey, 32 ) \
+    SYSCALL_ENTRY( 0x00c9, NtSetInformationObject, 32 ) \
+    SYSCALL_ENTRY( 0x00ca, NtSetInformationProcess, 32 ) \
+    SYSCALL_ENTRY( 0x00cb, NtSetInformationThread, 32 ) \
+    SYSCALL_ENTRY( 0x00cc, NtSetInformationToken, 32 ) \
+    SYSCALL_ENTRY( 0x00cd, NtSetInformationVirtualMemory, 48 ) \
+    SYSCALL_ENTRY( 0x00ce, NtSetIntervalProfile, 16 ) \
+    SYSCALL_ENTRY( 0x00cf, NtSetIoCompletion, 40 ) \
+    SYSCALL_ENTRY( 0x00d0, NtSetIoCompletionEx, 48 ) \
+    SYSCALL_ENTRY( 0x00d1, NtSetLdtEntries, 32 ) \
+    SYSCALL_ENTRY( 0x00d2, NtSetSecurityObject, 24 ) \
+    SYSCALL_ENTRY( 0x00d3, NtSetSystemInformation, 24 ) \
+    SYSCALL_ENTRY( 0x00d4, NtSetSystemTime, 16 ) \
+    SYSCALL_ENTRY( 0x00d5, NtSetThreadExecutionState, 16 ) \
+    SYSCALL_ENTRY( 0x00d6, NtSetTimer, 56 ) \
+    SYSCALL_ENTRY( 0x00d7, NtSetTimerResolution, 24 ) \
+    SYSCALL_ENTRY( 0x00d8, NtSetValueKey, 48 ) \
+    SYSCALL_ENTRY( 0x00d9, NtSetVolumeInformationFile, 40 ) \
+    SYSCALL_ENTRY( 0x00da, NtShutdownSystem, 8 ) \
+    SYSCALL_ENTRY( 0x00db, NtSignalAndWaitForSingleObject, 32 ) \
+    SYSCALL_ENTRY( 0x00dc, NtSuspendProcess, 8 ) \
+    SYSCALL_ENTRY( 0x00dd, NtSuspendThread, 16 ) \
+    SYSCALL_ENTRY( 0x00de, NtSystemDebugControl, 48 ) \
+    SYSCALL_ENTRY( 0x00df, NtTerminateJobObject, 16 ) \
+    SYSCALL_ENTRY( 0x00e0, NtTerminateProcess, 16 ) \
+    SYSCALL_ENTRY( 0x00e1, NtTerminateThread, 16 ) \
+    SYSCALL_ENTRY( 0x00e2, NtTestAlert, 0 ) \
+    SYSCALL_ENTRY( 0x00e3, NtTraceControl, 48 ) \
+    SYSCALL_ENTRY( 0x00e4, NtUnloadDriver, 8 ) \
+    SYSCALL_ENTRY( 0x00e5, NtUnloadKey, 8 ) \
+    SYSCALL_ENTRY( 0x00e6, NtUnlockFile, 40 ) \
+    SYSCALL_ENTRY( 0x00e7, NtUnlockVirtualMemory, 32 ) \
+    SYSCALL_ENTRY( 0x00e8, NtUnmapViewOfSection, 16 ) \
+    SYSCALL_ENTRY( 0x00e9, NtUnmapViewOfSectionEx, 24 ) \
+    SYSCALL_ENTRY( 0x00ea, NtWaitForAlertByThreadId, 16 ) \
+    SYSCALL_ENTRY( 0x00eb, NtWaitForDebugEvent, 32 ) \
+    SYSCALL_ENTRY( 0x00ec, NtWaitForKeyedEvent, 32 ) \
+    SYSCALL_ENTRY( 0x00ed, NtWaitForMultipleObjects, 40 ) \
+    SYSCALL_ENTRY( 0x00ee, NtWaitForSingleObject, 24 ) \
+    SYSCALL_ENTRY( 0x00ef, NtWriteFile, 72 ) \
+    SYSCALL_ENTRY( 0x00f0, NtWriteFileGather, 72 ) \
+    SYSCALL_ENTRY( 0x00f1, NtWriteVirtualMemory, 40 ) \
+    SYSCALL_ENTRY( 0x00f2, NtYieldExecution, 0 ) \
+    SYSCALL_ENTRY( 0x00f3, wine_nt_to_unix_file_name, 32 ) \
+    SYSCALL_ENTRY( 0x00f4, wine_unix_to_nt_file_name, 24 )
 #else
 #define ALL_SYSCALLS ALL_SYSCALLS32
 #endif
diff --git a/dlls/ntdll/signal_arm64ec.c b/dlls/ntdll/signal_arm64ec.c
index a233ba4878f..c9b35765473 100644
--- a/dlls/ntdll/signal_arm64ec.c
+++ b/dlls/ntdll/signal_arm64ec.c
@@ -428,6 +428,7 @@ DEFINE_WRAPPED_SYSCALL(NtFreeVirtualMemory, (HANDLE process, PVOID *addr_ptr, SI
 DEFINE_SYSCALL(NtFsControlFile, (HANDLE handle, HANDLE event, PIO_APC_ROUTINE apc, void *apc_context, IO_STATUS_BLOCK *io, ULONG code, void *in_buffer, ULONG in_size, void *out_buffer, ULONG out_size))
 DEFINE_WRAPPED_SYSCALL(NtGetContextThread, (HANDLE handle, ARM64_NT_CONTEXT *context))
 DEFINE_SYSCALL_(ULONG, NtGetCurrentProcessorNumber, (void))
+DEFINE_SYSCALL(NtGetNextProcess, (HANDLE process, ACCESS_MASK access, ULONG attributes, ULONG flags, HANDLE *handle))
 DEFINE_SYSCALL(NtGetNextThread, (HANDLE process, HANDLE thread, ACCESS_MASK access, ULONG attributes, ULONG flags, HANDLE *handle))
 DEFINE_SYSCALL(NtGetNlsSectionPtr, (ULONG type, ULONG id, void *unknown, void **ptr, SIZE_T *size))
 DEFINE_SYSCALL(NtGetWriteWatch, (HANDLE process, ULONG flags, PVOID base, SIZE_T size, PVOID *addresses, ULONG_PTR *count, ULONG *granularity))
diff --git a/dlls/ntdll/unix/process.c b/dlls/ntdll/unix/process.c
index e36137a4a66..597e3af04c0 100644
--- a/dlls/ntdll/unix/process.c
+++ b/dlls/ntdll/unix/process.c
@@ -2051,6 +2051,33 @@ NTSTATUS WINAPI NtResumeProcess( HANDLE handle )
 }
 
 
+/**********************************************************************
+ *           NtGetNextProcess  (NTDLL.@)
+ */
+NTSTATUS WINAPI NtGetNextProcess( HANDLE process, ACCESS_MASK access, ULONG attributes,
+                                  ULONG flags, HANDLE *handle )
+{
+    HANDLE ret_handle = 0;
+    unsigned int ret;
+
+    TRACE( "process %p, access %#x, attributes %#x, flags %#x, handle %p.\n",
+           process, (int)access, (int)attributes, (int)flags, handle );
+
+    SERVER_START_REQ( get_next_process )
+    {
+        req->last = wine_server_obj_handle( process );
+        req->access = access;
+        req->attributes = attributes;
+        req->flags = flags;
+        if (!(ret = wine_server_call( req ))) ret_handle = wine_server_ptr_handle( reply->handle );
+    }
+    SERVER_END_REQ;
+
+    *handle = ret_handle;
+    return ret;
+}
+
+
 /**********************************************************************
  *           NtDebugActiveProcess  (NTDLL.@)
  */
diff --git a/dlls/wow64/process.c b/dlls/wow64/process.c
index 573b003ac44..082b2da9461 100644
--- a/dlls/wow64/process.c
+++ b/dlls/wow64/process.c
@@ -455,6 +455,27 @@ NTSTATUS WINAPI wow64_NtFlushProcessWriteBuffers( UINT *args )
 }
 
 
+/**********************************************************************
+ *           wow64_NtGetNextProcess
+ */
+NTSTATUS WINAPI wow64_NtGetNextProcess( UINT *args )
+{
+    HANDLE process = get_handle( &args );
+    ACCESS_MASK access = get_ulong( &args );
+    ULONG attributes = get_ulong( &args );
+    ULONG flags = get_ulong( &args );
+    ULONG *handle_ptr = get_ptr( &args );
+
+    HANDLE handle = 0;
+    NTSTATUS status;
+
+    *handle_ptr = 0;
+    status = NtGetNextProcess( process, access, attributes, flags, &handle );
+    put_handle( handle_ptr, handle );
+    return status;
+}
+
+
 /**********************************************************************
  *           wow64_NtGetNextThread
  */
diff --git a/include/wine/server_protocol.h b/include/wine/server_protocol.h
index 07987120bcf..0d9bde785b9 100644
--- a/include/wine/server_protocol.h
+++ b/include/wine/server_protocol.h
@@ -976,6 +976,7 @@ typedef volatile struct
     struct shared_cursor cursor;
     unsigned char        keystate[256];
     unsigned __int64     monitor_serial;
+    unsigned __int64     keystate_serial;
 } desktop_shm_t;
 
 typedef volatile struct
@@ -1001,6 +1002,7 @@ typedef volatile struct
     int                  cursor_count;
     unsigned char        keystate[256];
     int                  keystate_lock;
+    unsigned __int64     desktop_keystate_serial;
 } input_shm_t;
 
 typedef volatile union
@@ -2203,9 +2205,10 @@ struct map_image_view_request
     obj_handle_t mapping;
     client_ptr_t base;
     mem_size_t   size;
+    mem_size_t   offset;
     unsigned int entry;
     unsigned short machine;
-    char __pad_38[2];
+    char __pad_46[2];
 };
 struct map_image_view_reply
 {
@@ -2496,6 +2499,8 @@ struct write_process_memory_request
 struct write_process_memory_reply
 {
     struct reply_header __header;
+    data_size_t written;
+    char __pad_12[4];
 };
 
 
@@ -5944,6 +5949,23 @@ struct resume_process_reply
 };
 
 
+struct get_next_process_request
+{
+    struct request_header __header;
+    obj_handle_t last;
+    unsigned int access;
+    unsigned int attributes;
+    unsigned int flags;
+    char __pad_28[4];
+};
+struct get_next_process_reply
+{
+    struct reply_header __header;
+    obj_handle_t handle;
+    char __pad_12[4];
+};
+
+
 struct get_next_thread_request
 {
     struct request_header __header;
@@ -6527,6 +6549,7 @@ enum request
     REQ_terminate_job,
     REQ_suspend_process,
     REQ_resume_process,
+    REQ_get_next_process,
     REQ_get_next_thread,
     REQ_set_keyboard_repeat,
     REQ_create_esync,
@@ -6846,6 +6869,7 @@ union generic_request
     struct terminate_job_request terminate_job_request;
     struct suspend_process_request suspend_process_request;
     struct resume_process_request resume_process_request;
+    struct get_next_process_request get_next_process_request;
     struct get_next_thread_request get_next_thread_request;
     struct set_keyboard_repeat_request set_keyboard_repeat_request;
     struct create_esync_request create_esync_request;
@@ -7163,6 +7187,7 @@ union generic_reply
     struct terminate_job_reply terminate_job_reply;
     struct suspend_process_reply suspend_process_reply;
     struct resume_process_reply resume_process_reply;
+    struct get_next_process_reply get_next_process_reply;
     struct get_next_thread_reply get_next_thread_reply;
     struct set_keyboard_repeat_reply set_keyboard_repeat_reply;
     struct create_esync_reply create_esync_reply;
@@ -7183,6 +7208,6 @@ union generic_reply
     struct get_inproc_alert_event_reply get_inproc_alert_event_reply;
 };
 
-#define SERVER_PROTOCOL_VERSION 862
+#define SERVER_PROTOCOL_VERSION 863
 
 #endif /* __WINE_WINE_SERVER_PROTOCOL_H */
diff --git a/include/winternl.h b/include/winternl.h
index 0541438feee..c18551a7547 100644
--- a/include/winternl.h
+++ b/include/winternl.h
@@ -4626,6 +4626,7 @@ NTSYSAPI NTSTATUS  WINAPI NtFreeVirtualMemory(HANDLE,PVOID*,SIZE_T*,ULONG);
 NTSYSAPI NTSTATUS  WINAPI NtFsControlFile(HANDLE,HANDLE,PIO_APC_ROUTINE,PVOID,PIO_STATUS_BLOCK,ULONG,PVOID,ULONG,PVOID,ULONG);
 NTSYSAPI NTSTATUS  WINAPI NtGetContextThread(HANDLE,CONTEXT*);
 NTSYSAPI ULONG     WINAPI NtGetCurrentProcessorNumber(void);
+NTSYSAPI NTSTATUS  WINAPI NtGetNextProcess(HANDLE,ACCESS_MASK,ULONG,ULONG,HANDLE*);
 NTSYSAPI NTSTATUS  WINAPI NtGetNextThread(HANDLE,HANDLE,ACCESS_MASK,ULONG,ULONG,HANDLE*);
 NTSYSAPI NTSTATUS  WINAPI NtGetNlsSectionPtr(ULONG,ULONG,void*,void**,SIZE_T*);
 NTSYSAPI NTSTATUS  WINAPI NtGetPlugPlayEvent(ULONG,ULONG,PVOID,ULONG);
diff --git a/server/process.c b/server/process.c
index ae987a6cfd5..1a6070527d0 100644
--- a/server/process.c
+++ b/server/process.c
@@ -1468,6 +1468,40 @@ DECL_HANDLER(get_new_process_info)
     }
 }
 
+/* Itererate processes using global process list */
+DECL_HANDLER(get_next_process)
+{
+    struct process *process;
+    struct list *ptr;
+
+    if (req->flags > 1)
+    {
+        set_error( STATUS_INVALID_PARAMETER );
+        return;
+    }
+
+    if (!req->last)
+    {
+        ptr = req->flags ? list_tail( &process_list ) : list_head( &process_list );
+    }
+    else
+    {
+        if (!(process = get_process_from_handle( req->last, 0 ))) return;
+        ptr = req->flags ? list_prev( &process_list, &process->entry )
+                         : list_next( &process_list, &process->entry );
+        release_object( process );
+    }
+
+    while (ptr)
+    {
+        process = LIST_ENTRY( ptr, struct process, entry );
+        if ((reply->handle = alloc_handle( current->process, process, req->access, req->attributes ))) return;
+        ptr = req->flags ? list_prev( &process_list, &process->entry )
+                         : list_next( &process_list, &process->entry );
+    }
+    set_error( STATUS_NO_MORE_ENTRIES );
+}
+
 /* Retrieve the new process startup info */
 DECL_HANDLER(get_startup_info)
 {
diff --git a/server/protocol.def b/server/protocol.def
index 337750125f2..39c8d697284 100644
--- a/server/protocol.def
+++ b/server/protocol.def
@@ -4132,6 +4132,16 @@ struct handle_info
     obj_handle_t handle;       /* process handle */
 @END
 
+/* Itererate processes using global process list */
+@REQ(get_next_process)
+    obj_handle_t last;         /* process handle to start with */
+    unsigned int access;       /* desired access for returned handle */
+    unsigned int attributes;   /* returned handle attributes */
+    unsigned int flags;        /* controls iteration direction */
+@REPLY
+    obj_handle_t handle;       /* next process handle */
+@END
+
 /* Iterate thread list for process */
 @REQ(get_next_thread)
     obj_handle_t process;      /* process handle */
diff --git a/server/request_handlers.h b/server/request_handlers.h
index b4a801c8b92..7505478384c 100644
--- a/server/request_handlers.h
+++ b/server/request_handlers.h
@@ -301,6 +301,7 @@ DECL_HANDLER(get_job_info);
 DECL_HANDLER(terminate_job);
 DECL_HANDLER(suspend_process);
 DECL_HANDLER(resume_process);
+DECL_HANDLER(get_next_process);
 DECL_HANDLER(get_next_thread);
 DECL_HANDLER(set_keyboard_repeat);
 DECL_HANDLER(create_esync);
@@ -617,6 +618,7 @@ static const req_handler req_handlers[REQ_NB_REQUESTS] =
     (req_handler)req_terminate_job,
     (req_handler)req_suspend_process,
     (req_handler)req_resume_process,
+    (req_handler)req_get_next_process,
     (req_handler)req_get_next_thread,
     (req_handler)req_set_keyboard_repeat,
     (req_handler)req_create_esync,
@@ -1113,9 +1115,10 @@ C_ASSERT( sizeof(struct map_view_request) == 48 );
 C_ASSERT( offsetof(struct map_image_view_request, mapping) == 12 );
 C_ASSERT( offsetof(struct map_image_view_request, base) == 16 );
 C_ASSERT( offsetof(struct map_image_view_request, size) == 24 );
-C_ASSERT( offsetof(struct map_image_view_request, entry) == 32 );
-C_ASSERT( offsetof(struct map_image_view_request, machine) == 36 );
-C_ASSERT( sizeof(struct map_image_view_request) == 40 );
+C_ASSERT( offsetof(struct map_image_view_request, offset) == 32 );
+C_ASSERT( offsetof(struct map_image_view_request, entry) == 40 );
+C_ASSERT( offsetof(struct map_image_view_request, machine) == 44 );
+C_ASSERT( sizeof(struct map_image_view_request) == 48 );
 C_ASSERT( sizeof(struct map_builtin_view_request) == 16 );
 C_ASSERT( offsetof(struct get_image_view_info_request, process) == 12 );
 C_ASSERT( offsetof(struct get_image_view_info_request, addr) == 16 );
@@ -1190,6 +1193,8 @@ C_ASSERT( sizeof(struct read_process_memory_reply) == 16 );
 C_ASSERT( offsetof(struct write_process_memory_request, handle) == 12 );
 C_ASSERT( offsetof(struct write_process_memory_request, addr) == 16 );
 C_ASSERT( sizeof(struct write_process_memory_request) == 24 );
+C_ASSERT( offsetof(struct write_process_memory_reply, written) == 8 );
+C_ASSERT( sizeof(struct write_process_memory_reply) == 16 );
 C_ASSERT( offsetof(struct create_key_request, access) == 12 );
 C_ASSERT( offsetof(struct create_key_request, options) == 16 );
 C_ASSERT( sizeof(struct create_key_request) == 24 );
@@ -2327,6 +2332,13 @@ C_ASSERT( offsetof(struct suspend_process_request, handle) == 12 );
 C_ASSERT( sizeof(struct suspend_process_request) == 16 );
 C_ASSERT( offsetof(struct resume_process_request, handle) == 12 );
 C_ASSERT( sizeof(struct resume_process_request) == 16 );
+C_ASSERT( offsetof(struct get_next_process_request, last) == 12 );
+C_ASSERT( offsetof(struct get_next_process_request, access) == 16 );
+C_ASSERT( offsetof(struct get_next_process_request, attributes) == 20 );
+C_ASSERT( offsetof(struct get_next_process_request, flags) == 24 );
+C_ASSERT( sizeof(struct get_next_process_request) == 32 );
+C_ASSERT( offsetof(struct get_next_process_reply, handle) == 8 );
+C_ASSERT( sizeof(struct get_next_process_reply) == 16 );
 C_ASSERT( offsetof(struct get_next_thread_request, process) == 12 );
 C_ASSERT( offsetof(struct get_next_thread_request, last) == 16 );
 C_ASSERT( offsetof(struct get_next_thread_request, access) == 20 );
diff --git a/server/request_trace.h b/server/request_trace.h
index 64dd9864f29..be58b020fb0 100644
--- a/server/request_trace.h
+++ b/server/request_trace.h
@@ -910,6 +910,7 @@ static void dump_map_image_view_request( const struct map_image_view_request *re
     fprintf( stderr, " mapping=%04x", req->mapping );
     dump_uint64( ", base=", &req->base );
     dump_uint64( ", size=", &req->size );
+    dump_uint64( ", offset=", &req->offset );
     fprintf( stderr, ", entry=%08x", req->entry );
     fprintf( stderr, ", machine=%04x", req->machine );
 }
@@ -1072,6 +1073,11 @@ static void dump_write_process_memory_request( const struct write_process_memory
     dump_varargs_bytes( ", data=", cur_size );
 }
 
+static void dump_write_process_memory_reply( const struct write_process_memory_reply *req )
+{
+    fprintf( stderr, " written=%u", req->written );
+}
+
 static void dump_create_key_request( const struct create_key_request *req )
 {
     fprintf( stderr, " access=%08x", req->access );
@@ -3383,6 +3389,19 @@ static void dump_resume_process_request( const struct resume_process_request *re
     fprintf( stderr, " handle=%04x", req->handle );
 }
 
+static void dump_get_next_process_request( const struct get_next_process_request *req )
+{
+    fprintf( stderr, " last=%04x", req->last );
+    fprintf( stderr, ", access=%08x", req->access );
+    fprintf( stderr, ", attributes=%08x", req->attributes );
+    fprintf( stderr, ", flags=%08x", req->flags );
+}
+
+static void dump_get_next_process_reply( const struct get_next_process_reply *req )
+{
+    fprintf( stderr, " handle=%04x", req->handle );
+}
+
 static void dump_get_next_thread_request( const struct get_next_thread_request *req )
 {
     fprintf( stderr, " process=%04x", req->process );
@@ -3854,6 +3873,7 @@ static const dump_func req_dumpers[REQ_NB_REQUESTS] =
     (dump_func)dump_terminate_job_request,
     (dump_func)dump_suspend_process_request,
     (dump_func)dump_resume_process_request,
+    (dump_func)dump_get_next_process_request,
     (dump_func)dump_get_next_thread_request,
     (dump_func)dump_set_keyboard_repeat_request,
     (dump_func)dump_create_esync_request,
@@ -3961,7 +3981,7 @@ static const dump_func reply_dumpers[REQ_NB_REQUESTS] =
     NULL,
     NULL,
     (dump_func)dump_read_process_memory_reply,
-    NULL,
+    (dump_func)dump_write_process_memory_reply,
     (dump_func)dump_create_key_reply,
     (dump_func)dump_open_key_reply,
     NULL,
@@ -4170,6 +4190,7 @@ static const dump_func reply_dumpers[REQ_NB_REQUESTS] =
     NULL,
     NULL,
     NULL,
+    (dump_func)dump_get_next_process_reply,
     (dump_func)dump_get_next_thread_reply,
     (dump_func)dump_set_keyboard_repeat_reply,
     (dump_func)dump_create_esync_reply,
@@ -4486,6 +4507,7 @@ static const char * const req_names[REQ_NB_REQUESTS] =
     "terminate_job",
     "suspend_process",
     "resume_process",
+    "get_next_process",
     "get_next_thread",
     "set_keyboard_repeat",
     "create_esync",
@@ -4613,6 +4635,7 @@ static const struct
     { "OBJECT_PATH_NOT_FOUND",       STATUS_OBJECT_PATH_NOT_FOUND },
     { "OBJECT_PATH_SYNTAX_BAD",      STATUS_OBJECT_PATH_SYNTAX_BAD },
     { "OBJECT_TYPE_MISMATCH",        STATUS_OBJECT_TYPE_MISMATCH },
+    { "PARTIAL_COPY",                STATUS_PARTIAL_COPY },
     { "PENDING",                     STATUS_PENDING },
     { "PIPE_BROKEN",                 STATUS_PIPE_BROKEN },
     { "PIPE_BUSY",                   STATUS_PIPE_BUSY },
-- 
2.51.1

