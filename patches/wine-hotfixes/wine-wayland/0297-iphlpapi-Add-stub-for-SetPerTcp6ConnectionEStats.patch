From 04bb62b7f46ceb710914d394955af597c0536b74 Mon Sep 17 00:00:00 2001
From: Louis Lenders <xerox.xerox2000x@gmail.com>
Date: Tue, 26 Aug 2025 19:39:19 +0200
Subject: [PATCH 297/409] iphlpapi: Add stub for SetPerTcp6ConnectionEStats.

Wine-Bug: https://bugs.winehq.org/show_bug.cgi?id=58635
---
 dlls/iphlpapi/iphlpapi.spec   |  2 +-
 dlls/iphlpapi/iphlpapi_main.c | 10 ++++++++++
 include/iphlpapi.h            |  1 +
 3 files changed, 12 insertions(+), 1 deletion(-)

diff --git a/dlls/iphlpapi/iphlpapi.spec b/dlls/iphlpapi/iphlpapi.spec
index d8173c0b33c..e849eb8b7d0 100644
--- a/dlls/iphlpapi/iphlpapi.spec
+++ b/dlls/iphlpapi/iphlpapi.spec
@@ -285,7 +285,7 @@
 @ stub SetIpStatsToStack
 @ stdcall SetIpTTL( long )
 #@ stub SetNetworkInformation
-#@ stub SetPerTcp6ConnectionEStats
+@ stdcall SetPerTcp6ConnectionEStats( ptr long ptr long long long )
 #@ stub SetPerTcp6ConnectionStats
 @ stdcall SetPerTcpConnectionEStats( ptr long ptr long long long )
 #@ stub SetPerTcpConnectionStats
diff --git a/dlls/iphlpapi/iphlpapi_main.c b/dlls/iphlpapi/iphlpapi_main.c
index 66d0a66f39e..25c08be2633 100644
--- a/dlls/iphlpapi/iphlpapi_main.c
+++ b/dlls/iphlpapi/iphlpapi_main.c
@@ -4205,6 +4205,16 @@ DWORD WINAPI SetPerTcpConnectionEStats(PMIB_TCPROW row, TCP_ESTATS_TYPE state, P
   return ERROR_NOT_SUPPORTED;
 }
 
+/******************************************************************
+ *    SetPerTcp6ConnectionEStats (IPHLPAPI.@)
+ */
+DWORD WINAPI SetPerTcp6ConnectionEStats(MIB_TCP6ROW *row, TCP_ESTATS_TYPE state, BYTE *rw,
+                                        ULONG version, ULONG size, ULONG offset)
+{
+    FIXME("(row %p, state %d, rw %p, version %lu, size %lu, offset %lu): stub\n",
+          row, state, rw, version, size, offset);
+    return ERROR_NOT_SUPPORTED;
+}
 
 /******************************************************************
  *    UnenableRouter (IPHLPAPI.@)
diff --git a/include/iphlpapi.h b/include/iphlpapi.h
index 2e3c2e42fbe..df8504517de 100644
--- a/include/iphlpapi.h
+++ b/include/iphlpapi.h
@@ -81,6 +81,7 @@ IPHLPAPI_DLL_LINKAGE DWORD WINAPI CreateIpForwardEntry(PMIB_IPFORWARDROW pRoute)
 IPHLPAPI_DLL_LINKAGE DWORD WINAPI SetIpForwardEntry(PMIB_IPFORWARDROW pRoute);
 IPHLPAPI_DLL_LINKAGE DWORD WINAPI DeleteIpForwardEntry(PMIB_IPFORWARDROW pRoute);
 IPHLPAPI_DLL_LINKAGE DWORD WINAPI SetIpStatistics(PMIB_IPSTATS pIpStats);
+IPHLPAPI_DLL_LINKAGE DWORD WINAPI SetPerTcp6ConnectionEStats(MIB_TCP6ROW *row, TCP_ESTATS_TYPE state, BYTE *rw, ULONG version, ULONG size, ULONG offset);
 IPHLPAPI_DLL_LINKAGE DWORD WINAPI SetPerTcpConnectionEStats(MIB_TCPROW *row, TCP_ESTATS_TYPE state, BYTE *rw, ULONG version, ULONG size, ULONG offset);
 IPHLPAPI_DLL_LINKAGE DWORD WINAPI SetIpTTL(UINT nTTL);
 IPHLPAPI_DLL_LINKAGE DWORD WINAPI CreateIpNetEntry(PMIB_IPNETROW pArpEntry);
-- 
2.51.1

