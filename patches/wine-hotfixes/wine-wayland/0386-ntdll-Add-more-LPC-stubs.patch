From 080b063b5d86ef1b66a26b8c61deb40b0d6d9cc6 Mon Sep 17 00:00:00 2001
From: Alexandre Julliard <julliard@winehq.org>
Date: Thu, 17 Jul 2025 15:42:54 +0200
Subject: [PATCH 386/479] ntdll: Add more LPC stubs.

They need explicit syscall ids.
---
 dlls/ntdll/ntdll.spec       |  20 +-
 dlls/ntdll/ntsyscalls.h     | 650 ++++++++++++++++++------------------
 dlls/ntdll/signal_arm64ec.c |   5 +
 dlls/ntdll/unix/sync.c      |  52 +++
 dlls/wow64/sync.c           |  76 +++++
 include/winternl.h          |   4 +-
 6 files changed, 475 insertions(+), 332 deletions(-)

diff --git a/dlls/ntdll/ntdll.spec b/dlls/ntdll/ntdll.spec
index 1a753b11823..a5439da7494 100644
--- a/dlls/ntdll/ntdll.spec
+++ b/dlls/ntdll/ntdll.spec
@@ -246,7 +246,7 @@
 @ stdcall NtGetTickCount()
 @ stdcall -syscall NtGetWriteWatch(long long ptr long ptr ptr ptr)
 @ stdcall -syscall NtImpersonateAnonymousToken(long)
-# @ stub NtImpersonateClientOfPort
+@ stdcall -syscall=0x001f NtImpersonateClientOfPort(long ptr)
 # @ stub NtImpersonateThread
 @ stdcall -syscall NtInitializeNlsFiles(ptr ptr ptr)
 # @ stub NtInitializeRegistry
@@ -352,7 +352,7 @@
 @ stdcall -syscall NtRaiseHardError(long long long ptr long ptr)
 @ stdcall -syscall=0x0006 NtReadFile(long long ptr ptr ptr ptr long ptr ptr)
 @ stdcall -syscall=0x002e NtReadFileScatter(long long ptr ptr ptr ptr long ptr ptr)
-# @ stub NtReadRequestData
+@ stdcall -syscall=0x0054 NtReadRequestData(long ptr long ptr long ptr)
 @ stdcall -syscall=0x003f NtReadVirtualMemory(long ptr ptr long ptr)
 # @ stub NtRegisterNewDevice
 @ stdcall -syscall NtRegisterThreadTerminatePort(ptr)
@@ -365,9 +365,9 @@
 @ stdcall -syscall NtRemoveProcessDebug(long long)
 @ stdcall -syscall NtRenameKey(long ptr)
 @ stdcall -syscall NtReplaceKey(ptr long ptr)
-# @ stub NtReplyPort
+@ stdcall -syscall=0x000c NtReplyPort(long ptr)
 @ stdcall -syscall=0x000b NtReplyWaitReceivePort(ptr ptr ptr ptr)
-# @ stub NtReplyWaitReceivePortEx
+@ stdcall -syscall=0x002b NtReplyWaitReceivePortEx(long ptr ptr ptr ptr)
 # @ stub NtReplyWaitReplyPort
 # @ stub NtRequestDeviceWakeup
 # @ stub NtRequestPort
@@ -464,7 +464,7 @@
 @ stdcall -syscall -arch=win32 NtWow64WriteVirtualMemory64(long int64 ptr int64 ptr)
 @ stdcall -syscall=0x0008 NtWriteFile(long long ptr ptr ptr ptr long ptr ptr)
 @ stdcall -syscall=0x001b NtWriteFileGather(long long ptr ptr ptr ptr long ptr ptr)
-# @ stub NtWriteRequestData
+@ stdcall -syscall=0x0057 NtWriteRequestData(long ptr long ptr long ptr)
 @ stdcall -syscall=0x003a NtWriteVirtualMemory(long ptr ptr long ptr)
 @ stdcall -syscall=0x0046 NtYieldExecution()
 @ stdcall NtdllDefWindowProc_A(long long long long)
@@ -1322,7 +1322,7 @@
 # @ stub ZwGetPlugPlayEvent
 @ stdcall -private ZwGetWriteWatch(long long ptr long ptr ptr ptr) NtGetWriteWatch
 @ stdcall -private ZwImpersonateAnonymousToken(long) NtImpersonateAnonymousToken
-# @ stub ZwImpersonateClientOfPort
+@ stdcall -private ZwImpersonateClientOfPort(long ptr) NtImpersonateClientOfPort
 # @ stub ZwImpersonateThread
 @ stdcall -private ZwInitializeNlsFiles(ptr ptr ptr) NtInitializeNlsFiles
 # @ stub ZwInitializeRegistry
@@ -1428,7 +1428,7 @@
 @ stdcall -private ZwRaiseHardError(long long long ptr long ptr) NtRaiseHardError
 @ stdcall -private ZwReadFile(long long ptr ptr ptr ptr long ptr ptr) NtReadFile
 @ stdcall -private ZwReadFileScatter(long long ptr ptr ptr ptr long ptr ptr) NtReadFileScatter
-# @ stub ZwReadRequestData
+@ stdcall -private ZwReadRequestData(long ptr long ptr long ptr) NtReadRequestData
 @ stdcall -private ZwReadVirtualMemory(long ptr ptr long ptr) NtReadVirtualMemory
 # @ stub ZwRegisterNewDevice
 @ stdcall -private ZwRegisterThreadTerminatePort(ptr) NtRegisterThreadTerminatePort
@@ -1441,9 +1441,9 @@
 @ stdcall -private ZwRemoveProcessDebug(long long) NtRemoveProcessDebug
 @ stdcall -private ZwRenameKey(long ptr) NtRenameKey
 @ stdcall -private ZwReplaceKey(ptr long ptr) NtReplaceKey
-# @ stub ZwReplyPort
+@ stdcall -private ZwReplyPort(long ptr) NtReplyPort
 @ stdcall -private ZwReplyWaitReceivePort(ptr ptr ptr ptr) NtReplyWaitReceivePort
-# @ stub ZwReplyWaitReceivePortEx
+@ stdcall -private ZwReplyWaitReceivePortEx(long ptr ptr ptr ptr) NtReplyWaitReceivePortEx
 # @ stub ZwReplyWaitReplyPort
 # @ stub ZwRequestDeviceWakeup
 # @ stub ZwRequestPort
@@ -1540,7 +1540,7 @@
 @ stdcall -private -arch=win32 ZwWow64WriteVirtualMemory64(long int64 ptr int64 ptr) NtWow64WriteVirtualMemory64
 @ stdcall -private ZwWriteFile(long long ptr ptr ptr ptr long ptr ptr) NtWriteFile
 @ stdcall -private ZwWriteFileGather(long long ptr ptr ptr ptr long ptr ptr) NtWriteFileGather
-# @ stub ZwWriteRequestData
+@ stdcall -private ZwWriteRequestData(long ptr long ptr long ptr) NtWriteRequestData
 @ stdcall -private ZwWriteVirtualMemory(long ptr ptr long ptr) NtWriteVirtualMemory
 @ stdcall -private ZwYieldExecution() NtYieldExecution
 @ cdecl -private -arch=i386 _CIcos()
diff --git a/dlls/ntdll/ntsyscalls.h b/dlls/ntdll/ntsyscalls.h
index 31fd265dad7..f62a3548e79 100644
--- a/dlls/ntdll/ntsyscalls.h
+++ b/dlls/ntdll/ntsyscalls.h
@@ -13,7 +13,7 @@
     SYSCALL_ENTRY( 0x0009, NtRemoveIoCompletion, 20 ) \
     SYSCALL_ENTRY( 0x000a, NtReleaseSemaphore, 12 ) \
     SYSCALL_ENTRY( 0x000b, NtReplyWaitReceivePort, 16 ) \
-    SYSCALL_ENTRY( 0x000c, NtAlertResumeThread, 8 ) \
+    SYSCALL_ENTRY( 0x000c, NtReplyPort, 8 ) \
     SYSCALL_ENTRY( 0x000d, NtSetInformationThread, 16 ) \
     SYSCALL_ENTRY( 0x000e, NtSetEvent, 8 ) \
     SYSCALL_ENTRY( 0x000f, NtClose, 4 ) \
@@ -27,12 +27,12 @@
     SYSCALL_ENTRY( 0x0017, NtQueryValueKey, 24 ) \
     SYSCALL_ENTRY( 0x0018, NtAllocateVirtualMemory, 24 ) \
     SYSCALL_ENTRY_NtQueryInformationProcess( 0x0019, NtQueryInformationProcess, 20 ) \
-    SYSCALL_ENTRY( 0x001a, NtAlertThread, 4 ) \
+    SYSCALL_ENTRY( 0x001a, NtAlertResumeThread, 8 ) \
     SYSCALL_ENTRY( 0x001b, NtWriteFileGather, 36 ) \
     SYSCALL_ENTRY( 0x001c, NtSetInformationProcess, 16 ) \
     SYSCALL_ENTRY( 0x001d, NtCreateKey, 28 ) \
     SYSCALL_ENTRY( 0x001e, NtFreeVirtualMemory, 16 ) \
-    SYSCALL_ENTRY( 0x001f, NtAlertThreadByThreadId, 4 ) \
+    SYSCALL_ENTRY( 0x001f, NtImpersonateClientOfPort, 8 ) \
     SYSCALL_ENTRY( 0x0020, NtReleaseMutant, 8 ) \
     SYSCALL_ENTRY( 0x0021, NtQueryInformationToken, 20 ) \
     SYSCALL_ENTRY( 0x0022, NtRequestWaitReplyPort, 12 ) \
@@ -44,9 +44,9 @@
     SYSCALL_ENTRY( 0x0028, NtMapViewOfSection, 40 ) \
     SYSCALL_ENTRY( 0x0029, NtAccessCheckAndAuditAlarm, 44 ) \
     SYSCALL_ENTRY( 0x002a, NtUnmapViewOfSection, 8 ) \
-    SYSCALL_ENTRY( 0x002b, NtAllocateLocallyUniqueId, 4 ) \
+    SYSCALL_ENTRY( 0x002b, NtReplyWaitReceivePortEx, 20 ) \
     SYSCALL_ENTRY( 0x002c, NtTerminateProcess, 8 ) \
-    SYSCALL_ENTRY( 0x002d, NtAllocateReserveObject, 12 ) \
+    SYSCALL_ENTRY( 0x002d, NtAlertThread, 4 ) \
     SYSCALL_ENTRY( 0x002e, NtReadFileScatter, 36 ) \
     SYSCALL_ENTRY( 0x002f, NtOpenThreadTokenEx, 20 ) \
     SYSCALL_ENTRY( 0x0030, NtOpenProcessTokenEx, 16 ) \
@@ -77,183 +77,188 @@
     SYSCALL_ENTRY( 0x0049, NtQueryVolumeInformationFile, 20 ) \
     SYSCALL_ENTRY( 0x004a, NtCreateSection, 28 ) \
     SYSCALL_ENTRY( 0x004b, NtFlushBuffersFile, 8 ) \
-    SYSCALL_ENTRY( 0x004c, NtAllocateUuids, 16 ) \
-    SYSCALL_ENTRY( 0x004d, NtAllocateVirtualMemoryEx, 28 ) \
+    SYSCALL_ENTRY( 0x004c, NtAlertThreadByThreadId, 4 ) \
+    SYSCALL_ENTRY( 0x004d, NtAllocateLocallyUniqueId, 4 ) \
     SYSCALL_ENTRY( 0x004e, NtCreateThread, 32 ) \
     SYSCALL_ENTRY( 0x004f, NtIsProcessInJob, 8 ) \
     SYSCALL_ENTRY( 0x0050, NtProtectVirtualMemory, 20 ) \
     SYSCALL_ENTRY( 0x0051, NtQuerySection, 20 ) \
     SYSCALL_ENTRY( 0x0052, NtResumeThread, 8 ) \
     SYSCALL_ENTRY( 0x0053, NtTerminateThread, 8 ) \
-    SYSCALL_ENTRY( 0x0054, NtAreMappedFilesTheSame, 8 ) \
+    SYSCALL_ENTRY( 0x0054, NtReadRequestData, 24 ) \
     SYSCALL_ENTRY( 0x0055, NtCreateFile, 44 ) \
     SYSCALL_ENTRY( 0x0056, NtQueryEvent, 20 ) \
-    SYSCALL_ENTRY( 0x0057, NtAssignProcessToJobObject, 8 ) \
+    SYSCALL_ENTRY( 0x0057, NtWriteRequestData, 24 ) \
     SYSCALL_ENTRY( 0x0058, NtOpenDirectoryObject, 12 ) \
     SYSCALL_ENTRY( 0x0059, NtAccessCheckByTypeAndAuditAlarm, 64 ) \
     SYSCALL_ENTRY_NtQuerySystemTime( 0x005a, NtQuerySystemTime, 4 ) \
     SYSCALL_ENTRY( 0x005b, NtWaitForMultipleObjects, 20 ) \
     SYSCALL_ENTRY( 0x005c, NtSetInformationObject, 16 ) \
     SYSCALL_ENTRY( 0x005d, NtCancelIoFile, 8 ) \
-    SYSCALL_ENTRY( 0x005e, NtCancelIoFileEx, 12 ) \
+    SYSCALL_ENTRY( 0x005e, NtAllocateReserveObject, 12 ) \
     SYSCALL_ENTRY( 0x005f, NtPowerInformation, 20 ) \
     SYSCALL_ENTRY( 0x0060, NtSetValueKey, 24 ) \
     SYSCALL_ENTRY( 0x0061, NtCancelTimer, 8 ) \
     SYSCALL_ENTRY( 0x0062, NtSetTimer, 28 ) \
-    SYSCALL_ENTRY( 0x0063, NtCancelSynchronousIoFile, 12 ) \
-    SYSCALL_ENTRY( 0x0064, NtCommitTransaction, 8 ) \
-    SYSCALL_ENTRY( 0x0065, NtCompareObjects, 8 ) \
-    SYSCALL_ENTRY( 0x0066, NtCompareTokens, 12 ) \
-    SYSCALL_ENTRY( 0x0067, NtCompleteConnectPort, 4 ) \
-    SYSCALL_ENTRY( 0x0068, NtConnectPort, 32 ) \
-    SYSCALL_ENTRY( 0x0069, NtContinueEx, 8 ) \
-    SYSCALL_ENTRY( 0x006a, NtConvertBetweenAuxiliaryCounterAndPerformanceCounter, 16 ) \
-    SYSCALL_ENTRY( 0x006b, NtCreateDirectoryObject, 12 ) \
-    SYSCALL_ENTRY( 0x006c, NtCreateIoCompletion, 16 ) \
-    SYSCALL_ENTRY( 0x006d, NtCreateJobObject, 12 ) \
-    SYSCALL_ENTRY( 0x006e, NtCreateKeyTransacted, 32 ) \
-    SYSCALL_ENTRY( 0x006f, NtCreateKeyedEvent, 16 ) \
-    SYSCALL_ENTRY( 0x0070, NtCreateLowBoxToken, 36 ) \
-    SYSCALL_ENTRY( 0x0071, NtCreateMailslotFile, 32 ) \
-    SYSCALL_ENTRY( 0x0072, NtCreateMutant, 16 ) \
-    SYSCALL_ENTRY( 0x0073, NtCreateNamedPipeFile, 56 ) \
-    SYSCALL_ENTRY( 0x0074, NtCreatePagingFile, 16 ) \
-    SYSCALL_ENTRY( 0x0075, NtCreatePort, 20 ) \
-    SYSCALL_ENTRY( 0x0076, NtCreateSectionEx, 36 ) \
-    SYSCALL_ENTRY( 0x0077, NtCreateSemaphore, 20 ) \
-    SYSCALL_ENTRY( 0x0078, NtCreateSymbolicLinkObject, 16 ) \
-    SYSCALL_ENTRY( 0x0079, NtCreateThreadEx, 44 ) \
-    SYSCALL_ENTRY( 0x007a, NtCreateTimer, 16 ) \
-    SYSCALL_ENTRY( 0x007b, NtCreateToken, 52 ) \
-    SYSCALL_ENTRY( 0x007c, NtCreateTransaction, 40 ) \
-    SYSCALL_ENTRY( 0x007d, NtCreateUserProcess, 44 ) \
-    SYSCALL_ENTRY( 0x007e, NtDebugActiveProcess, 8 ) \
-    SYSCALL_ENTRY( 0x007f, NtDebugContinue, 12 ) \
-    SYSCALL_ENTRY( 0x0080, NtDeleteAtom, 4 ) \
-    SYSCALL_ENTRY( 0x0081, NtDeleteFile, 4 ) \
-    SYSCALL_ENTRY( 0x0082, NtDeleteKey, 4 ) \
-    SYSCALL_ENTRY( 0x0083, NtDeleteValueKey, 8 ) \
-    SYSCALL_ENTRY( 0x0084, NtDisplayString, 4 ) \
-    SYSCALL_ENTRY( 0x0085, NtFilterToken, 24 ) \
-    SYSCALL_ENTRY( 0x0086, NtFlushBuffersFileEx, 20 ) \
-    SYSCALL_ENTRY( 0x0087, NtFlushInstructionCache, 12 ) \
-    SYSCALL_ENTRY( 0x0088, NtFlushKey, 4 ) \
-    SYSCALL_ENTRY( 0x0089, NtFlushProcessWriteBuffers, 0 ) \
-    SYSCALL_ENTRY( 0x008a, NtFlushVirtualMemory, 16 ) \
-    SYSCALL_ENTRY( 0x008b, NtGetContextThread, 8 ) \
-    SYSCALL_ENTRY( 0x008c, NtGetCurrentProcessorNumber, 0 ) \
-    SYSCALL_ENTRY( 0x008d, NtGetNextProcess, 20 ) \
-    SYSCALL_ENTRY( 0x008e, NtGetNextThread, 24 ) \
-    SYSCALL_ENTRY( 0x008f, NtGetNlsSectionPtr, 20 ) \
-    SYSCALL_ENTRY( 0x0090, NtGetWriteWatch, 28 ) \
-    SYSCALL_ENTRY( 0x0091, NtImpersonateAnonymousToken, 4 ) \
-    SYSCALL_ENTRY( 0x0092, NtInitializeNlsFiles, 12 ) \
-    SYSCALL_ENTRY( 0x0093, NtInitiatePowerAction, 16 ) \
-    SYSCALL_ENTRY( 0x0094, NtListenPort, 8 ) \
-    SYSCALL_ENTRY( 0x0095, NtLoadDriver, 4 ) \
-    SYSCALL_ENTRY( 0x0096, NtLoadKey, 8 ) \
-    SYSCALL_ENTRY( 0x0097, NtLoadKey2, 12 ) \
-    SYSCALL_ENTRY( 0x0098, NtLoadKeyEx, 32 ) \
-    SYSCALL_ENTRY( 0x0099, NtLockFile, 40 ) \
-    SYSCALL_ENTRY( 0x009a, NtLockVirtualMemory, 16 ) \
-    SYSCALL_ENTRY( 0x009b, NtMakePermanentObject, 4 ) \
-    SYSCALL_ENTRY( 0x009c, NtMakeTemporaryObject, 4 ) \
-    SYSCALL_ENTRY( 0x009d, NtMapViewOfSectionEx, 36 ) \
-    SYSCALL_ENTRY( 0x009e, NtNotifyChangeDirectoryFile, 36 ) \
-    SYSCALL_ENTRY( 0x009f, NtNotifyChangeKey, 40 ) \
-    SYSCALL_ENTRY( 0x00a0, NtNotifyChangeMultipleKeys, 48 ) \
-    SYSCALL_ENTRY( 0x00a1, NtOpenIoCompletion, 12 ) \
-    SYSCALL_ENTRY( 0x00a2, NtOpenJobObject, 12 ) \
-    SYSCALL_ENTRY( 0x00a3, NtOpenKeyEx, 16 ) \
-    SYSCALL_ENTRY( 0x00a4, NtOpenKeyTransacted, 16 ) \
-    SYSCALL_ENTRY( 0x00a5, NtOpenKeyTransactedEx, 20 ) \
+    SYSCALL_ENTRY( 0x0063, NtAllocateUuids, 16 ) \
+    SYSCALL_ENTRY( 0x0064, NtAllocateVirtualMemoryEx, 28 ) \
+    SYSCALL_ENTRY( 0x0065, NtAreMappedFilesTheSame, 8 ) \
+    SYSCALL_ENTRY( 0x0066, NtAssignProcessToJobObject, 8 ) \
+    SYSCALL_ENTRY( 0x0067, NtCancelIoFileEx, 12 ) \
+    SYSCALL_ENTRY( 0x0068, NtCancelSynchronousIoFile, 12 ) \
+    SYSCALL_ENTRY( 0x0069, NtCommitTransaction, 8 ) \
+    SYSCALL_ENTRY( 0x006a, NtCompareObjects, 8 ) \
+    SYSCALL_ENTRY( 0x006b, NtCompareTokens, 12 ) \
+    SYSCALL_ENTRY( 0x006c, NtCompleteConnectPort, 4 ) \
+    SYSCALL_ENTRY( 0x006d, NtConnectPort, 32 ) \
+    SYSCALL_ENTRY( 0x006e, NtContinueEx, 8 ) \
+    SYSCALL_ENTRY( 0x006f, NtConvertBetweenAuxiliaryCounterAndPerformanceCounter, 16 ) \
+    SYSCALL_ENTRY( 0x0070, NtCreateDirectoryObject, 12 ) \
+    SYSCALL_ENTRY( 0x0071, NtCreateIoCompletion, 16 ) \
+    SYSCALL_ENTRY( 0x0072, NtCreateJobObject, 12 ) \
+    SYSCALL_ENTRY( 0x0073, NtCreateKeyTransacted, 32 ) \
+    SYSCALL_ENTRY( 0x0074, NtCreateKeyedEvent, 16 ) \
+    SYSCALL_ENTRY( 0x0075, NtCreateLowBoxToken, 36 ) \
+    SYSCALL_ENTRY( 0x0076, NtCreateMailslotFile, 32 ) \
+    SYSCALL_ENTRY( 0x0077, NtCreateMutant, 16 ) \
+    SYSCALL_ENTRY( 0x0078, NtCreateNamedPipeFile, 56 ) \
+    SYSCALL_ENTRY( 0x0079, NtCreatePagingFile, 16 ) \
+    SYSCALL_ENTRY( 0x007a, NtCreatePort, 20 ) \
+    SYSCALL_ENTRY( 0x007b, NtCreateSectionEx, 36 ) \
+    SYSCALL_ENTRY( 0x007c, NtCreateSemaphore, 20 ) \
+    SYSCALL_ENTRY( 0x007d, NtCreateSymbolicLinkObject, 16 ) \
+    SYSCALL_ENTRY( 0x007e, NtCreateThreadEx, 44 ) \
+    SYSCALL_ENTRY( 0x007f, NtCreateTimer, 16 ) \
+    SYSCALL_ENTRY( 0x0080, NtCreateToken, 52 ) \
+    SYSCALL_ENTRY( 0x0081, NtCreateTransaction, 40 ) \
+    SYSCALL_ENTRY( 0x0082, NtCreateUserProcess, 44 ) \
+    SYSCALL_ENTRY( 0x0083, NtDebugActiveProcess, 8 ) \
+    SYSCALL_ENTRY( 0x0084, NtDebugContinue, 12 ) \
+    SYSCALL_ENTRY( 0x0085, NtDeleteAtom, 4 ) \
+    SYSCALL_ENTRY( 0x0086, NtDeleteFile, 4 ) \
+    SYSCALL_ENTRY( 0x0087, NtDeleteKey, 4 ) \
+    SYSCALL_ENTRY( 0x0088, NtDeleteValueKey, 8 ) \
+    SYSCALL_ENTRY( 0x0089, NtDisplayString, 4 ) \
+    SYSCALL_ENTRY( 0x008a, NtFilterToken, 24 ) \
+    SYSCALL_ENTRY( 0x008b, NtFlushBuffersFileEx, 20 ) \
+    SYSCALL_ENTRY( 0x008c, NtFlushInstructionCache, 12 ) \
+    SYSCALL_ENTRY( 0x008d, NtFlushKey, 4 ) \
+    SYSCALL_ENTRY( 0x008e, NtFlushProcessWriteBuffers, 0 ) \
+    SYSCALL_ENTRY( 0x008f, NtFlushVirtualMemory, 16 ) \
+    SYSCALL_ENTRY( 0x0090, NtGetContextThread, 8 ) \
+    SYSCALL_ENTRY( 0x0091, NtGetCurrentProcessorNumber, 0 ) \
+    SYSCALL_ENTRY( 0x0092, NtGetNextProcess, 20 ) \
+    SYSCALL_ENTRY( 0x0093, NtGetNextThread, 24 ) \
+    SYSCALL_ENTRY( 0x0094, NtGetNlsSectionPtr, 20 ) \
+    SYSCALL_ENTRY( 0x0095, NtGetWriteWatch, 28 ) \
+    SYSCALL_ENTRY( 0x0096, NtImpersonateAnonymousToken, 4 ) \
+    SYSCALL_ENTRY( 0x0097, NtInitializeNlsFiles, 12 ) \
+    SYSCALL_ENTRY( 0x0098, NtInitiatePowerAction, 16 ) \
+    SYSCALL_ENTRY( 0x0099, NtListenPort, 8 ) \
+    SYSCALL_ENTRY( 0x009a, NtLoadDriver, 4 ) \
+    SYSCALL_ENTRY( 0x009b, NtLoadKey, 8 ) \
+    SYSCALL_ENTRY( 0x009c, NtLoadKey2, 12 ) \
+    SYSCALL_ENTRY( 0x009d, NtLoadKeyEx, 32 ) \
+    SYSCALL_ENTRY( 0x009e, NtLockFile, 40 ) \
+    SYSCALL_ENTRY( 0x009f, NtLockVirtualMemory, 16 ) \
+    SYSCALL_ENTRY( 0x00a0, NtMakePermanentObject, 4 ) \
+    SYSCALL_ENTRY( 0x00a1, NtMakeTemporaryObject, 4 ) \
+    SYSCALL_ENTRY( 0x00a2, NtMapViewOfSectionEx, 36 ) \
+    SYSCALL_ENTRY( 0x00a3, NtNotifyChangeDirectoryFile, 36 ) \
+    SYSCALL_ENTRY( 0x00a4, NtNotifyChangeKey, 40 ) \
+    SYSCALL_ENTRY( 0x00a5, NtNotifyChangeMultipleKeys, 48 ) \
     SYSCALL_ENTRY( 0x00a6, NtCreateDebugObject, 16 ) \
-    SYSCALL_ENTRY( 0x00a7, NtOpenKeyedEvent, 12 ) \
-    SYSCALL_ENTRY( 0x00a8, NtOpenMutant, 12 ) \
-    SYSCALL_ENTRY( 0x00a9, NtOpenProcessToken, 12 ) \
-    SYSCALL_ENTRY( 0x00aa, NtOpenSemaphore, 12 ) \
-    SYSCALL_ENTRY( 0x00ab, NtOpenSymbolicLinkObject, 12 ) \
-    SYSCALL_ENTRY( 0x00ac, NtOpenThread, 16 ) \
-    SYSCALL_ENTRY( 0x00ad, NtOpenTimer, 12 ) \
-    SYSCALL_ENTRY( 0x00ae, NtPrivilegeCheck, 12 ) \
-    SYSCALL_ENTRY( 0x00af, NtPulseEvent, 8 ) \
-    SYSCALL_ENTRY( 0x00b0, NtQueryDirectoryObject, 28 ) \
-    SYSCALL_ENTRY( 0x00b1, NtQueryEaFile, 36 ) \
-    SYSCALL_ENTRY( 0x00b2, NtQueryFullAttributesFile, 8 ) \
-    SYSCALL_ENTRY( 0x00b3, NtQueryInformationAtom, 20 ) \
-    SYSCALL_ENTRY( 0x00b4, NtQueryInformationJobObject, 20 ) \
-    SYSCALL_ENTRY( 0x00b5, NtQueryInstallUILanguage, 4 ) \
-    SYSCALL_ENTRY( 0x00b6, NtQueryIoCompletion, 20 ) \
-    SYSCALL_ENTRY( 0x00b7, NtQueryLicenseValue, 20 ) \
-    SYSCALL_ENTRY( 0x00b8, NtQueryMultipleValueKey, 24 ) \
-    SYSCALL_ENTRY( 0x00b9, NtQueryMutant, 20 ) \
-    SYSCALL_ENTRY( 0x00ba, NtQuerySecurityObject, 20 ) \
-    SYSCALL_ENTRY( 0x00bb, NtQuerySemaphore, 20 ) \
-    SYSCALL_ENTRY( 0x00bc, NtQuerySymbolicLinkObject, 12 ) \
-    SYSCALL_ENTRY( 0x00bd, NtQuerySystemEnvironmentValue, 16 ) \
-    SYSCALL_ENTRY( 0x00be, NtQuerySystemEnvironmentValueEx, 20 ) \
-    SYSCALL_ENTRY( 0x00bf, NtQuerySystemInformationEx, 24 ) \
-    SYSCALL_ENTRY( 0x00c0, NtQueryTimerResolution, 12 ) \
-    SYSCALL_ENTRY( 0x00c1, NtQueueApcThreadEx, 24 ) \
-    SYSCALL_ENTRY( 0x00c2, NtRaiseException, 12 ) \
-    SYSCALL_ENTRY( 0x00c3, NtRaiseHardError, 24 ) \
-    SYSCALL_ENTRY( 0x00c4, NtRegisterThreadTerminatePort, 4 ) \
-    SYSCALL_ENTRY( 0x00c5, NtReleaseKeyedEvent, 16 ) \
-    SYSCALL_ENTRY( 0x00c6, NtRemoveIoCompletionEx, 24 ) \
-    SYSCALL_ENTRY( 0x00c7, NtRemoveProcessDebug, 8 ) \
-    SYSCALL_ENTRY( 0x00c8, NtRenameKey, 8 ) \
-    SYSCALL_ENTRY( 0x00c9, NtReplaceKey, 12 ) \
-    SYSCALL_ENTRY( 0x00ca, NtResetEvent, 8 ) \
-    SYSCALL_ENTRY( 0x00cb, NtResetWriteWatch, 12 ) \
-    SYSCALL_ENTRY( 0x00cc, NtRestoreKey, 12 ) \
-    SYSCALL_ENTRY( 0x00cd, NtResumeProcess, 4 ) \
-    SYSCALL_ENTRY( 0x00ce, NtRollbackTransaction, 8 ) \
-    SYSCALL_ENTRY( 0x00cf, NtSaveKey, 8 ) \
-    SYSCALL_ENTRY( 0x00d0, NtSecureConnectPort, 36 ) \
-    SYSCALL_ENTRY( 0x00d1, NtSetContextThread, 8 ) \
-    SYSCALL_ENTRY( 0x00d2, NtSetDebugFilterState, 12 ) \
-    SYSCALL_ENTRY( 0x00d3, NtSetDefaultLocale, 8 ) \
-    SYSCALL_ENTRY( 0x00d4, NtSetDefaultUILanguage, 4 ) \
-    SYSCALL_ENTRY( 0x00d5, NtSetEaFile, 16 ) \
-    SYSCALL_ENTRY( 0x00d6, NtSetInformationDebugObject, 20 ) \
-    SYSCALL_ENTRY( 0x00d7, NtSetInformationJobObject, 16 ) \
-    SYSCALL_ENTRY( 0x00d8, NtSetInformationKey, 16 ) \
-    SYSCALL_ENTRY( 0x00d9, NtSetInformationToken, 16 ) \
-    SYSCALL_ENTRY( 0x00da, NtSetInformationVirtualMemory, 24 ) \
-    SYSCALL_ENTRY( 0x00db, NtSetIntervalProfile, 8 ) \
-    SYSCALL_ENTRY( 0x00dc, NtSetIoCompletion, 20 ) \
-    SYSCALL_ENTRY( 0x00dd, NtSetIoCompletionEx, 24 ) \
-    SYSCALL_ENTRY( 0x00de, NtSetLdtEntries, 24 ) \
-    SYSCALL_ENTRY( 0x00df, NtSetSecurityObject, 12 ) \
-    SYSCALL_ENTRY( 0x00e0, NtSetSystemInformation, 12 ) \
-    SYSCALL_ENTRY( 0x00e1, NtSetSystemTime, 8 ) \
-    SYSCALL_ENTRY( 0x00e2, NtSetThreadExecutionState, 8 ) \
-    SYSCALL_ENTRY( 0x00e3, NtSetTimerResolution, 12 ) \
-    SYSCALL_ENTRY( 0x00e4, NtSetVolumeInformationFile, 20 ) \
-    SYSCALL_ENTRY( 0x00e5, NtShutdownSystem, 4 ) \
-    SYSCALL_ENTRY( 0x00e6, NtSignalAndWaitForSingleObject, 16 ) \
-    SYSCALL_ENTRY( 0x00e7, NtSuspendProcess, 4 ) \
-    SYSCALL_ENTRY( 0x00e8, NtSuspendThread, 8 ) \
-    SYSCALL_ENTRY( 0x00e9, NtSystemDebugControl, 24 ) \
-    SYSCALL_ENTRY( 0x00ea, NtTerminateJobObject, 8 ) \
-    SYSCALL_ENTRY( 0x00eb, NtTestAlert, 0 ) \
-    SYSCALL_ENTRY( 0x00ec, NtTraceControl, 24 ) \
-    SYSCALL_ENTRY( 0x00ed, NtUnloadDriver, 4 ) \
-    SYSCALL_ENTRY( 0x00ee, NtUnloadKey, 4 ) \
-    SYSCALL_ENTRY( 0x00ef, NtUnlockFile, 20 ) \
-    SYSCALL_ENTRY( 0x00f0, NtUnlockVirtualMemory, 16 ) \
-    SYSCALL_ENTRY( 0x00f1, NtUnmapViewOfSectionEx, 12 ) \
-    SYSCALL_ENTRY( 0x00f2, NtWaitForAlertByThreadId, 8 ) \
-    SYSCALL_ENTRY( 0x00f3, NtWaitForDebugEvent, 16 ) \
-    SYSCALL_ENTRY( 0x00f4, NtWaitForKeyedEvent, 16 ) \
-    SYSCALL_ENTRY( 0x00f5, NtWow64AllocateVirtualMemory64, 28 ) \
-    SYSCALL_ENTRY( 0x00f6, NtWow64GetNativeSystemInformation, 16 ) \
-    SYSCALL_ENTRY( 0x00f7, NtWow64IsProcessorFeaturePresent, 4 ) \
-    SYSCALL_ENTRY( 0x00f8, NtWow64QueryInformationProcess64, 20 ) \
-    SYSCALL_ENTRY( 0x00f9, NtWow64ReadVirtualMemory64, 28 ) \
-    SYSCALL_ENTRY( 0x00fa, NtWow64WriteVirtualMemory64, 28 ) \
-    SYSCALL_ENTRY( 0x00fb, wine_nt_to_unix_file_name, 16 ) \
-    SYSCALL_ENTRY( 0x00fc, wine_unix_to_nt_file_name, 12 )
+    SYSCALL_ENTRY( 0x00a7, NtOpenIoCompletion, 12 ) \
+    SYSCALL_ENTRY( 0x00a8, NtOpenJobObject, 12 ) \
+    SYSCALL_ENTRY( 0x00a9, NtOpenKeyEx, 16 ) \
+    SYSCALL_ENTRY( 0x00aa, NtOpenKeyTransacted, 16 ) \
+    SYSCALL_ENTRY( 0x00ab, NtOpenKeyTransactedEx, 20 ) \
+    SYSCALL_ENTRY( 0x00ac, NtOpenKeyedEvent, 12 ) \
+    SYSCALL_ENTRY( 0x00ad, NtOpenMutant, 12 ) \
+    SYSCALL_ENTRY( 0x00ae, NtOpenProcessToken, 12 ) \
+    SYSCALL_ENTRY( 0x00af, NtOpenSemaphore, 12 ) \
+    SYSCALL_ENTRY( 0x00b0, NtOpenSymbolicLinkObject, 12 ) \
+    SYSCALL_ENTRY( 0x00b1, NtOpenThread, 16 ) \
+    SYSCALL_ENTRY( 0x00b2, NtOpenTimer, 12 ) \
+    SYSCALL_ENTRY( 0x00b3, NtPrivilegeCheck, 12 ) \
+    SYSCALL_ENTRY( 0x00b4, NtPulseEvent, 8 ) \
+    SYSCALL_ENTRY( 0x00b5, NtQueryDirectoryObject, 28 ) \
+    SYSCALL_ENTRY( 0x00b6, NtQueryEaFile, 36 ) \
+    SYSCALL_ENTRY( 0x00b7, NtQueryFullAttributesFile, 8 ) \
+    SYSCALL_ENTRY( 0x00b8, NtQueryInformationAtom, 20 ) \
+    SYSCALL_ENTRY( 0x00b9, NtQueryInformationJobObject, 20 ) \
+    SYSCALL_ENTRY( 0x00ba, NtQueryInstallUILanguage, 4 ) \
+    SYSCALL_ENTRY( 0x00bb, NtQueryIoCompletion, 20 ) \
+    SYSCALL_ENTRY( 0x00bc, NtQueryLicenseValue, 20 ) \
+    SYSCALL_ENTRY( 0x00bd, NtQueryMultipleValueKey, 24 ) \
+    SYSCALL_ENTRY( 0x00be, NtQueryMutant, 20 ) \
+    SYSCALL_ENTRY( 0x00bf, NtQuerySecurityObject, 20 ) \
+    SYSCALL_ENTRY( 0x00c0, NtQuerySemaphore, 20 ) \
+    SYSCALL_ENTRY( 0x00c1, NtQuerySymbolicLinkObject, 12 ) \
+    SYSCALL_ENTRY( 0x00c2, NtQuerySystemEnvironmentValue, 16 ) \
+    SYSCALL_ENTRY( 0x00c3, NtQuerySystemEnvironmentValueEx, 20 ) \
+    SYSCALL_ENTRY( 0x00c4, NtQuerySystemInformationEx, 24 ) \
+    SYSCALL_ENTRY( 0x00c5, NtQueryTimerResolution, 12 ) \
+    SYSCALL_ENTRY( 0x00c6, NtQueueApcThreadEx, 24 ) \
+    SYSCALL_ENTRY( 0x00c7, NtRaiseException, 12 ) \
+    SYSCALL_ENTRY( 0x00c8, NtRaiseHardError, 24 ) \
+    SYSCALL_ENTRY( 0x00c9, NtRegisterThreadTerminatePort, 4 ) \
+    SYSCALL_ENTRY( 0x00ca, NtReleaseKeyedEvent, 16 ) \
+    SYSCALL_ENTRY( 0x00cb, NtRemoveIoCompletionEx, 24 ) \
+    SYSCALL_ENTRY( 0x00cc, NtRemoveProcessDebug, 8 ) \
+    SYSCALL_ENTRY( 0x00cd, NtRenameKey, 8 ) \
+    SYSCALL_ENTRY( 0x00ce, NtReplaceKey, 12 ) \
+    SYSCALL_ENTRY( 0x00cf, NtResetEvent, 8 ) \
+    SYSCALL_ENTRY( 0x00d0, NtResetWriteWatch, 12 ) \
+    SYSCALL_ENTRY( 0x00d1, NtRestoreKey, 12 ) \
+    SYSCALL_ENTRY( 0x00d2, NtResumeProcess, 4 ) \
+    SYSCALL_ENTRY( 0x00d3, NtRollbackTransaction, 8 ) \
+    SYSCALL_ENTRY( 0x00d4, NtSaveKey, 8 ) \
+    SYSCALL_ENTRY( 0x00d5, NtSecureConnectPort, 36 ) \
+    SYSCALL_ENTRY( 0x00d6, NtSetContextThread, 8 ) \
+    SYSCALL_ENTRY( 0x00d7, NtSetDebugFilterState, 12 ) \
+    SYSCALL_ENTRY( 0x00d8, NtSetDefaultLocale, 8 ) \
+    SYSCALL_ENTRY( 0x00d9, NtSetDefaultUILanguage, 4 ) \
+    SYSCALL_ENTRY( 0x00da, NtSetEaFile, 16 ) \
+    SYSCALL_ENTRY( 0x00db, NtSetInformationDebugObject, 20 ) \
+    SYSCALL_ENTRY( 0x00dc, NtSetInformationJobObject, 16 ) \
+    SYSCALL_ENTRY( 0x00dd, NtSetInformationKey, 16 ) \
+    SYSCALL_ENTRY( 0x00de, NtSetInformationToken, 16 ) \
+    SYSCALL_ENTRY( 0x00df, NtSetInformationVirtualMemory, 24 ) \
+    SYSCALL_ENTRY( 0x00e0, NtSetIntervalProfile, 8 ) \
+    SYSCALL_ENTRY( 0x00e1, NtSetIoCompletion, 20 ) \
+    SYSCALL_ENTRY( 0x00e2, NtSetIoCompletionEx, 24 ) \
+    SYSCALL_ENTRY( 0x00e3, NtSetLdtEntries, 24 ) \
+    SYSCALL_ENTRY( 0x00e4, NtSetSecurityObject, 12 ) \
+    SYSCALL_ENTRY( 0x00e5, NtSetSystemInformation, 12 ) \
+    SYSCALL_ENTRY( 0x00e6, NtSetSystemTime, 8 ) \
+    SYSCALL_ENTRY( 0x00e7, NtSetThreadExecutionState, 8 ) \
+    SYSCALL_ENTRY( 0x00e8, NtSetTimerResolution, 12 ) \
+    SYSCALL_ENTRY( 0x00e9, NtSetVolumeInformationFile, 20 ) \
+    SYSCALL_ENTRY( 0x00ea, NtShutdownSystem, 4 ) \
+    SYSCALL_ENTRY( 0x00eb, NtSignalAndWaitForSingleObject, 16 ) \
+    SYSCALL_ENTRY( 0x00ec, NtSuspendProcess, 4 ) \
+    SYSCALL_ENTRY( 0x00ed, NtSuspendThread, 8 ) \
+    SYSCALL_ENTRY( 0x00ee, NtSystemDebugControl, 24 ) \
+    SYSCALL_ENTRY( 0x00ef, NtTerminateJobObject, 8 ) \
+    SYSCALL_ENTRY( 0x00f0, NtTestAlert, 0 ) \
+    SYSCALL_ENTRY( 0x00f1, NtTraceControl, 24 ) \
+    SYSCALL_ENTRY( 0x00f2, NtUnloadDriver, 4 ) \
+    SYSCALL_ENTRY( 0x00f3, NtUnloadKey, 4 ) \
+    SYSCALL_ENTRY( 0x00f4, NtUnlockFile, 20 ) \
+    SYSCALL_ENTRY( 0x00f5, NtUnlockVirtualMemory, 16 ) \
+    SYSCALL_ENTRY( 0x00f6, NtUnmapViewOfSectionEx, 12 ) \
+    SYSCALL_ENTRY( 0x00f7, NtWaitForAlertByThreadId, 8 ) \
+    SYSCALL_ENTRY( 0x00f8, NtWaitForDebugEvent, 16 ) \
+    SYSCALL_ENTRY( 0x00f9, NtWaitForKeyedEvent, 16 ) \
+    SYSCALL_ENTRY( 0x00fa, NtWow64AllocateVirtualMemory64, 28 ) \
+    SYSCALL_ENTRY( 0x00fb, NtWow64GetNativeSystemInformation, 16 ) \
+    SYSCALL_ENTRY( 0x00fc, NtWow64IsProcessorFeaturePresent, 4 ) \
+    SYSCALL_ENTRY( 0x00fd, NtWow64QueryInformationProcess64, 20 ) \
+    SYSCALL_ENTRY( 0x00fe, NtWow64ReadVirtualMemory64, 28 ) \
+    SYSCALL_ENTRY( 0x00ff, NtWow64WriteVirtualMemory64, 28 ) \
+    SYSCALL_ENTRY( 0x0100, wine_nt_to_unix_file_name, 16 ) \
+    SYSCALL_ENTRY( 0x0101, wine_unix_to_nt_file_name, 12 )
 #ifdef _WIN64
 #define ALL_SYSCALLS \
     SYSCALL_ENTRY( 0x0000, NtAccessCheck, 64 ) \
@@ -268,7 +273,7 @@
     SYSCALL_ENTRY( 0x0009, NtRemoveIoCompletion, 40 ) \
     SYSCALL_ENTRY( 0x000a, NtReleaseSemaphore, 24 ) \
     SYSCALL_ENTRY( 0x000b, NtReplyWaitReceivePort, 32 ) \
-    SYSCALL_ENTRY( 0x000c, NtAlertResumeThread, 16 ) \
+    SYSCALL_ENTRY( 0x000c, NtReplyPort, 16 ) \
     SYSCALL_ENTRY( 0x000d, NtSetInformationThread, 32 ) \
     SYSCALL_ENTRY( 0x000e, NtSetEvent, 16 ) \
     SYSCALL_ENTRY( 0x000f, NtClose, 8 ) \
@@ -282,12 +287,12 @@
     SYSCALL_ENTRY( 0x0017, NtQueryValueKey, 48 ) \
     SYSCALL_ENTRY( 0x0018, NtAllocateVirtualMemory, 48 ) \
     SYSCALL_ENTRY_NtQueryInformationProcess( 0x0019, NtQueryInformationProcess, 40 ) \
-    SYSCALL_ENTRY( 0x001a, NtAlertThread, 8 ) \
+    SYSCALL_ENTRY( 0x001a, NtAlertResumeThread, 16 ) \
     SYSCALL_ENTRY( 0x001b, NtWriteFileGather, 72 ) \
     SYSCALL_ENTRY( 0x001c, NtSetInformationProcess, 32 ) \
     SYSCALL_ENTRY( 0x001d, NtCreateKey, 56 ) \
     SYSCALL_ENTRY( 0x001e, NtFreeVirtualMemory, 32 ) \
-    SYSCALL_ENTRY( 0x001f, NtAlertThreadByThreadId, 8 ) \
+    SYSCALL_ENTRY( 0x001f, NtImpersonateClientOfPort, 16 ) \
     SYSCALL_ENTRY( 0x0020, NtReleaseMutant, 16 ) \
     SYSCALL_ENTRY( 0x0021, NtQueryInformationToken, 40 ) \
     SYSCALL_ENTRY( 0x0022, NtRequestWaitReplyPort, 24 ) \
@@ -299,9 +304,9 @@
     SYSCALL_ENTRY( 0x0028, NtMapViewOfSection, 80 ) \
     SYSCALL_ENTRY( 0x0029, NtAccessCheckAndAuditAlarm, 88 ) \
     SYSCALL_ENTRY( 0x002a, NtUnmapViewOfSection, 16 ) \
-    SYSCALL_ENTRY( 0x002b, NtAllocateLocallyUniqueId, 8 ) \
+    SYSCALL_ENTRY( 0x002b, NtReplyWaitReceivePortEx, 40 ) \
     SYSCALL_ENTRY( 0x002c, NtTerminateProcess, 16 ) \
-    SYSCALL_ENTRY( 0x002d, NtAllocateReserveObject, 24 ) \
+    SYSCALL_ENTRY( 0x002d, NtAlertThread, 8 ) \
     SYSCALL_ENTRY( 0x002e, NtReadFileScatter, 72 ) \
     SYSCALL_ENTRY( 0x002f, NtOpenThreadTokenEx, 40 ) \
     SYSCALL_ENTRY( 0x0030, NtOpenProcessTokenEx, 32 ) \
@@ -332,177 +337,182 @@
     SYSCALL_ENTRY( 0x0049, NtQueryVolumeInformationFile, 40 ) \
     SYSCALL_ENTRY( 0x004a, NtCreateSection, 56 ) \
     SYSCALL_ENTRY( 0x004b, NtFlushBuffersFile, 16 ) \
-    SYSCALL_ENTRY( 0x004c, NtAllocateUuids, 32 ) \
-    SYSCALL_ENTRY( 0x004d, NtAllocateVirtualMemoryEx, 56 ) \
+    SYSCALL_ENTRY( 0x004c, NtAlertThreadByThreadId, 8 ) \
+    SYSCALL_ENTRY( 0x004d, NtAllocateLocallyUniqueId, 8 ) \
     SYSCALL_ENTRY( 0x004e, NtCreateThread, 64 ) \
     SYSCALL_ENTRY( 0x004f, NtIsProcessInJob, 16 ) \
     SYSCALL_ENTRY( 0x0050, NtProtectVirtualMemory, 40 ) \
     SYSCALL_ENTRY( 0x0051, NtQuerySection, 40 ) \
     SYSCALL_ENTRY( 0x0052, NtResumeThread, 16 ) \
     SYSCALL_ENTRY( 0x0053, NtTerminateThread, 16 ) \
-    SYSCALL_ENTRY( 0x0054, NtAreMappedFilesTheSame, 16 ) \
+    SYSCALL_ENTRY( 0x0054, NtReadRequestData, 48 ) \
     SYSCALL_ENTRY( 0x0055, NtCreateFile, 88 ) \
     SYSCALL_ENTRY( 0x0056, NtQueryEvent, 40 ) \
-    SYSCALL_ENTRY( 0x0057, NtAssignProcessToJobObject, 16 ) \
+    SYSCALL_ENTRY( 0x0057, NtWriteRequestData, 48 ) \
     SYSCALL_ENTRY( 0x0058, NtOpenDirectoryObject, 24 ) \
     SYSCALL_ENTRY( 0x0059, NtAccessCheckByTypeAndAuditAlarm, 128 ) \
     SYSCALL_ENTRY_NtQuerySystemTime( 0x005a, NtQuerySystemTime, 8 ) \
     SYSCALL_ENTRY( 0x005b, NtWaitForMultipleObjects, 40 ) \
     SYSCALL_ENTRY( 0x005c, NtSetInformationObject, 32 ) \
     SYSCALL_ENTRY( 0x005d, NtCancelIoFile, 16 ) \
-    SYSCALL_ENTRY( 0x005e, NtCancelIoFileEx, 24 ) \
+    SYSCALL_ENTRY( 0x005e, NtAllocateReserveObject, 24 ) \
     SYSCALL_ENTRY( 0x005f, NtPowerInformation, 40 ) \
     SYSCALL_ENTRY( 0x0060, NtSetValueKey, 48 ) \
     SYSCALL_ENTRY( 0x0061, NtCancelTimer, 16 ) \
     SYSCALL_ENTRY( 0x0062, NtSetTimer, 56 ) \
-    SYSCALL_ENTRY( 0x0063, NtCancelSynchronousIoFile, 24 ) \
-    SYSCALL_ENTRY( 0x0064, NtCommitTransaction, 16 ) \
-    SYSCALL_ENTRY( 0x0065, NtCompareObjects, 16 ) \
-    SYSCALL_ENTRY( 0x0066, NtCompareTokens, 24 ) \
-    SYSCALL_ENTRY( 0x0067, NtCompleteConnectPort, 8 ) \
-    SYSCALL_ENTRY( 0x0068, NtConnectPort, 64 ) \
-    SYSCALL_ENTRY( 0x0069, NtContinueEx, 16 ) \
-    SYSCALL_ENTRY( 0x006a, NtConvertBetweenAuxiliaryCounterAndPerformanceCounter, 32 ) \
-    SYSCALL_ENTRY( 0x006b, NtCreateDirectoryObject, 24 ) \
-    SYSCALL_ENTRY( 0x006c, NtCreateIoCompletion, 32 ) \
-    SYSCALL_ENTRY( 0x006d, NtCreateJobObject, 24 ) \
-    SYSCALL_ENTRY( 0x006e, NtCreateKeyTransacted, 64 ) \
-    SYSCALL_ENTRY( 0x006f, NtCreateKeyedEvent, 32 ) \
-    SYSCALL_ENTRY( 0x0070, NtCreateLowBoxToken, 72 ) \
-    SYSCALL_ENTRY( 0x0071, NtCreateMailslotFile, 64 ) \
-    SYSCALL_ENTRY( 0x0072, NtCreateMutant, 32 ) \
-    SYSCALL_ENTRY( 0x0073, NtCreateNamedPipeFile, 112 ) \
-    SYSCALL_ENTRY( 0x0074, NtCreatePagingFile, 32 ) \
-    SYSCALL_ENTRY( 0x0075, NtCreatePort, 40 ) \
-    SYSCALL_ENTRY( 0x0076, NtCreateSectionEx, 72 ) \
-    SYSCALL_ENTRY( 0x0077, NtCreateSemaphore, 40 ) \
-    SYSCALL_ENTRY( 0x0078, NtCreateSymbolicLinkObject, 32 ) \
-    SYSCALL_ENTRY( 0x0079, NtCreateThreadEx, 88 ) \
-    SYSCALL_ENTRY( 0x007a, NtCreateTimer, 32 ) \
-    SYSCALL_ENTRY( 0x007b, NtCreateToken, 104 ) \
-    SYSCALL_ENTRY( 0x007c, NtCreateTransaction, 80 ) \
-    SYSCALL_ENTRY( 0x007d, NtCreateUserProcess, 88 ) \
-    SYSCALL_ENTRY( 0x007e, NtDebugActiveProcess, 16 ) \
-    SYSCALL_ENTRY( 0x007f, NtDebugContinue, 24 ) \
-    SYSCALL_ENTRY( 0x0080, NtDeleteAtom, 8 ) \
-    SYSCALL_ENTRY( 0x0081, NtDeleteFile, 8 ) \
-    SYSCALL_ENTRY( 0x0082, NtDeleteKey, 8 ) \
-    SYSCALL_ENTRY( 0x0083, NtDeleteValueKey, 16 ) \
-    SYSCALL_ENTRY( 0x0084, NtDisplayString, 8 ) \
-    SYSCALL_ENTRY( 0x0085, NtFilterToken, 48 ) \
-    SYSCALL_ENTRY( 0x0086, NtFlushBuffersFileEx, 40 ) \
-    SYSCALL_ENTRY( 0x0087, NtFlushInstructionCache, 24 ) \
-    SYSCALL_ENTRY( 0x0088, NtFlushKey, 8 ) \
-    SYSCALL_ENTRY( 0x0089, NtFlushProcessWriteBuffers, 0 ) \
-    SYSCALL_ENTRY( 0x008a, NtFlushVirtualMemory, 32 ) \
-    SYSCALL_ENTRY( 0x008b, NtGetContextThread, 16 ) \
-    SYSCALL_ENTRY( 0x008c, NtGetCurrentProcessorNumber, 0 ) \
-    SYSCALL_ENTRY( 0x008d, NtGetNextProcess, 40 ) \
-    SYSCALL_ENTRY( 0x008e, NtGetNextThread, 48 ) \
-    SYSCALL_ENTRY( 0x008f, NtGetNlsSectionPtr, 40 ) \
-    SYSCALL_ENTRY( 0x0090, NtGetWriteWatch, 56 ) \
-    SYSCALL_ENTRY( 0x0091, NtImpersonateAnonymousToken, 8 ) \
-    SYSCALL_ENTRY( 0x0092, NtInitializeNlsFiles, 24 ) \
-    SYSCALL_ENTRY( 0x0093, NtInitiatePowerAction, 32 ) \
-    SYSCALL_ENTRY( 0x0094, NtListenPort, 16 ) \
-    SYSCALL_ENTRY( 0x0095, NtLoadDriver, 8 ) \
-    SYSCALL_ENTRY( 0x0096, NtLoadKey, 16 ) \
-    SYSCALL_ENTRY( 0x0097, NtLoadKey2, 24 ) \
-    SYSCALL_ENTRY( 0x0098, NtLoadKeyEx, 64 ) \
-    SYSCALL_ENTRY( 0x0099, NtLockFile, 80 ) \
-    SYSCALL_ENTRY( 0x009a, NtLockVirtualMemory, 32 ) \
-    SYSCALL_ENTRY( 0x009b, NtMakePermanentObject, 8 ) \
-    SYSCALL_ENTRY( 0x009c, NtMakeTemporaryObject, 8 ) \
-    SYSCALL_ENTRY( 0x009d, NtMapViewOfSectionEx, 72 ) \
-    SYSCALL_ENTRY( 0x009e, NtNotifyChangeDirectoryFile, 72 ) \
-    SYSCALL_ENTRY( 0x009f, NtNotifyChangeKey, 80 ) \
-    SYSCALL_ENTRY( 0x00a0, NtNotifyChangeMultipleKeys, 96 ) \
-    SYSCALL_ENTRY( 0x00a1, NtOpenIoCompletion, 24 ) \
-    SYSCALL_ENTRY( 0x00a2, NtOpenJobObject, 24 ) \
-    SYSCALL_ENTRY( 0x00a3, NtOpenKeyEx, 32 ) \
-    SYSCALL_ENTRY( 0x00a4, NtOpenKeyTransacted, 32 ) \
-    SYSCALL_ENTRY( 0x00a5, NtOpenKeyTransactedEx, 40 ) \
+    SYSCALL_ENTRY( 0x0063, NtAllocateUuids, 32 ) \
+    SYSCALL_ENTRY( 0x0064, NtAllocateVirtualMemoryEx, 56 ) \
+    SYSCALL_ENTRY( 0x0065, NtAreMappedFilesTheSame, 16 ) \
+    SYSCALL_ENTRY( 0x0066, NtAssignProcessToJobObject, 16 ) \
+    SYSCALL_ENTRY( 0x0067, NtCancelIoFileEx, 24 ) \
+    SYSCALL_ENTRY( 0x0068, NtCancelSynchronousIoFile, 24 ) \
+    SYSCALL_ENTRY( 0x0069, NtCommitTransaction, 16 ) \
+    SYSCALL_ENTRY( 0x006a, NtCompareObjects, 16 ) \
+    SYSCALL_ENTRY( 0x006b, NtCompareTokens, 24 ) \
+    SYSCALL_ENTRY( 0x006c, NtCompleteConnectPort, 8 ) \
+    SYSCALL_ENTRY( 0x006d, NtConnectPort, 64 ) \
+    SYSCALL_ENTRY( 0x006e, NtContinueEx, 16 ) \
+    SYSCALL_ENTRY( 0x006f, NtConvertBetweenAuxiliaryCounterAndPerformanceCounter, 32 ) \
+    SYSCALL_ENTRY( 0x0070, NtCreateDirectoryObject, 24 ) \
+    SYSCALL_ENTRY( 0x0071, NtCreateIoCompletion, 32 ) \
+    SYSCALL_ENTRY( 0x0072, NtCreateJobObject, 24 ) \
+    SYSCALL_ENTRY( 0x0073, NtCreateKeyTransacted, 64 ) \
+    SYSCALL_ENTRY( 0x0074, NtCreateKeyedEvent, 32 ) \
+    SYSCALL_ENTRY( 0x0075, NtCreateLowBoxToken, 72 ) \
+    SYSCALL_ENTRY( 0x0076, NtCreateMailslotFile, 64 ) \
+    SYSCALL_ENTRY( 0x0077, NtCreateMutant, 32 ) \
+    SYSCALL_ENTRY( 0x0078, NtCreateNamedPipeFile, 112 ) \
+    SYSCALL_ENTRY( 0x0079, NtCreatePagingFile, 32 ) \
+    SYSCALL_ENTRY( 0x007a, NtCreatePort, 40 ) \
+    SYSCALL_ENTRY( 0x007b, NtCreateSectionEx, 72 ) \
+    SYSCALL_ENTRY( 0x007c, NtCreateSemaphore, 40 ) \
+    SYSCALL_ENTRY( 0x007d, NtCreateSymbolicLinkObject, 32 ) \
+    SYSCALL_ENTRY( 0x007e, NtCreateThreadEx, 88 ) \
+    SYSCALL_ENTRY( 0x007f, NtCreateTimer, 32 ) \
+    SYSCALL_ENTRY( 0x0080, NtCreateToken, 104 ) \
+    SYSCALL_ENTRY( 0x0081, NtCreateTransaction, 80 ) \
+    SYSCALL_ENTRY( 0x0082, NtCreateUserProcess, 88 ) \
+    SYSCALL_ENTRY( 0x0083, NtDebugActiveProcess, 16 ) \
+    SYSCALL_ENTRY( 0x0084, NtDebugContinue, 24 ) \
+    SYSCALL_ENTRY( 0x0085, NtDeleteAtom, 8 ) \
+    SYSCALL_ENTRY( 0x0086, NtDeleteFile, 8 ) \
+    SYSCALL_ENTRY( 0x0087, NtDeleteKey, 8 ) \
+    SYSCALL_ENTRY( 0x0088, NtDeleteValueKey, 16 ) \
+    SYSCALL_ENTRY( 0x0089, NtDisplayString, 8 ) \
+    SYSCALL_ENTRY( 0x008a, NtFilterToken, 48 ) \
+    SYSCALL_ENTRY( 0x008b, NtFlushBuffersFileEx, 40 ) \
+    SYSCALL_ENTRY( 0x008c, NtFlushInstructionCache, 24 ) \
+    SYSCALL_ENTRY( 0x008d, NtFlushKey, 8 ) \
+    SYSCALL_ENTRY( 0x008e, NtFlushProcessWriteBuffers, 0 ) \
+    SYSCALL_ENTRY( 0x008f, NtFlushVirtualMemory, 32 ) \
+    SYSCALL_ENTRY( 0x0090, NtGetContextThread, 16 ) \
+    SYSCALL_ENTRY( 0x0091, NtGetCurrentProcessorNumber, 0 ) \
+    SYSCALL_ENTRY( 0x0092, NtGetNextProcess, 40 ) \
+    SYSCALL_ENTRY( 0x0093, NtGetNextThread, 48 ) \
+    SYSCALL_ENTRY( 0x0094, NtGetNlsSectionPtr, 40 ) \
+    SYSCALL_ENTRY( 0x0095, NtGetWriteWatch, 56 ) \
+    SYSCALL_ENTRY( 0x0096, NtImpersonateAnonymousToken, 8 ) \
+    SYSCALL_ENTRY( 0x0097, NtInitializeNlsFiles, 24 ) \
+    SYSCALL_ENTRY( 0x0098, NtInitiatePowerAction, 32 ) \
+    SYSCALL_ENTRY( 0x0099, NtListenPort, 16 ) \
+    SYSCALL_ENTRY( 0x009a, NtLoadDriver, 8 ) \
+    SYSCALL_ENTRY( 0x009b, NtLoadKey, 16 ) \
+    SYSCALL_ENTRY( 0x009c, NtLoadKey2, 24 ) \
+    SYSCALL_ENTRY( 0x009d, NtLoadKeyEx, 64 ) \
+    SYSCALL_ENTRY( 0x009e, NtLockFile, 80 ) \
+    SYSCALL_ENTRY( 0x009f, NtLockVirtualMemory, 32 ) \
+    SYSCALL_ENTRY( 0x00a0, NtMakePermanentObject, 8 ) \
+    SYSCALL_ENTRY( 0x00a1, NtMakeTemporaryObject, 8 ) \
+    SYSCALL_ENTRY( 0x00a2, NtMapViewOfSectionEx, 72 ) \
+    SYSCALL_ENTRY( 0x00a3, NtNotifyChangeDirectoryFile, 72 ) \
+    SYSCALL_ENTRY( 0x00a4, NtNotifyChangeKey, 80 ) \
+    SYSCALL_ENTRY( 0x00a5, NtNotifyChangeMultipleKeys, 96 ) \
     SYSCALL_ENTRY( 0x00a6, NtCreateDebugObject, 32 ) \
-    SYSCALL_ENTRY( 0x00a7, NtOpenKeyedEvent, 24 ) \
-    SYSCALL_ENTRY( 0x00a8, NtOpenMutant, 24 ) \
-    SYSCALL_ENTRY( 0x00a9, NtOpenProcessToken, 24 ) \
-    SYSCALL_ENTRY( 0x00aa, NtOpenSemaphore, 24 ) \
-    SYSCALL_ENTRY( 0x00ab, NtOpenSymbolicLinkObject, 24 ) \
-    SYSCALL_ENTRY( 0x00ac, NtOpenThread, 32 ) \
-    SYSCALL_ENTRY( 0x00ad, NtOpenTimer, 24 ) \
-    SYSCALL_ENTRY( 0x00ae, NtPrivilegeCheck, 24 ) \
-    SYSCALL_ENTRY( 0x00af, NtPulseEvent, 16 ) \
-    SYSCALL_ENTRY( 0x00b0, NtQueryDirectoryObject, 56 ) \
-    SYSCALL_ENTRY( 0x00b1, NtQueryEaFile, 72 ) \
-    SYSCALL_ENTRY( 0x00b2, NtQueryFullAttributesFile, 16 ) \
-    SYSCALL_ENTRY( 0x00b3, NtQueryInformationAtom, 40 ) \
-    SYSCALL_ENTRY( 0x00b4, NtQueryInformationJobObject, 40 ) \
-    SYSCALL_ENTRY( 0x00b5, NtQueryInstallUILanguage, 8 ) \
-    SYSCALL_ENTRY( 0x00b6, NtQueryIoCompletion, 40 ) \
-    SYSCALL_ENTRY( 0x00b7, NtQueryLicenseValue, 40 ) \
-    SYSCALL_ENTRY( 0x00b8, NtQueryMultipleValueKey, 48 ) \
-    SYSCALL_ENTRY( 0x00b9, NtQueryMutant, 40 ) \
-    SYSCALL_ENTRY( 0x00ba, NtQuerySecurityObject, 40 ) \
-    SYSCALL_ENTRY( 0x00bb, NtQuerySemaphore, 40 ) \
-    SYSCALL_ENTRY( 0x00bc, NtQuerySymbolicLinkObject, 24 ) \
-    SYSCALL_ENTRY( 0x00bd, NtQuerySystemEnvironmentValue, 32 ) \
-    SYSCALL_ENTRY( 0x00be, NtQuerySystemEnvironmentValueEx, 40 ) \
-    SYSCALL_ENTRY( 0x00bf, NtQuerySystemInformationEx, 48 ) \
-    SYSCALL_ENTRY( 0x00c0, NtQueryTimerResolution, 24 ) \
-    SYSCALL_ENTRY( 0x00c1, NtQueueApcThreadEx, 48 ) \
-    SYSCALL_ENTRY( 0x00c2, NtRaiseException, 24 ) \
-    SYSCALL_ENTRY( 0x00c3, NtRaiseHardError, 48 ) \
-    SYSCALL_ENTRY( 0x00c4, NtRegisterThreadTerminatePort, 8 ) \
-    SYSCALL_ENTRY( 0x00c5, NtReleaseKeyedEvent, 32 ) \
-    SYSCALL_ENTRY( 0x00c6, NtRemoveIoCompletionEx, 48 ) \
-    SYSCALL_ENTRY( 0x00c7, NtRemoveProcessDebug, 16 ) \
-    SYSCALL_ENTRY( 0x00c8, NtRenameKey, 16 ) \
-    SYSCALL_ENTRY( 0x00c9, NtReplaceKey, 24 ) \
-    SYSCALL_ENTRY( 0x00ca, NtResetEvent, 16 ) \
-    SYSCALL_ENTRY( 0x00cb, NtResetWriteWatch, 24 ) \
-    SYSCALL_ENTRY( 0x00cc, NtRestoreKey, 24 ) \
-    SYSCALL_ENTRY( 0x00cd, NtResumeProcess, 8 ) \
-    SYSCALL_ENTRY( 0x00ce, NtRollbackTransaction, 16 ) \
-    SYSCALL_ENTRY( 0x00cf, NtSaveKey, 16 ) \
-    SYSCALL_ENTRY( 0x00d0, NtSecureConnectPort, 72 ) \
-    SYSCALL_ENTRY( 0x00d1, NtSetContextThread, 16 ) \
-    SYSCALL_ENTRY( 0x00d2, NtSetDebugFilterState, 24 ) \
-    SYSCALL_ENTRY( 0x00d3, NtSetDefaultLocale, 16 ) \
-    SYSCALL_ENTRY( 0x00d4, NtSetDefaultUILanguage, 8 ) \
-    SYSCALL_ENTRY( 0x00d5, NtSetEaFile, 32 ) \
-    SYSCALL_ENTRY( 0x00d6, NtSetInformationDebugObject, 40 ) \
-    SYSCALL_ENTRY( 0x00d7, NtSetInformationJobObject, 32 ) \
-    SYSCALL_ENTRY( 0x00d8, NtSetInformationKey, 32 ) \
-    SYSCALL_ENTRY( 0x00d9, NtSetInformationToken, 32 ) \
-    SYSCALL_ENTRY( 0x00da, NtSetInformationVirtualMemory, 48 ) \
-    SYSCALL_ENTRY( 0x00db, NtSetIntervalProfile, 16 ) \
-    SYSCALL_ENTRY( 0x00dc, NtSetIoCompletion, 40 ) \
-    SYSCALL_ENTRY( 0x00dd, NtSetIoCompletionEx, 48 ) \
-    SYSCALL_ENTRY( 0x00de, NtSetLdtEntries, 32 ) \
-    SYSCALL_ENTRY( 0x00df, NtSetSecurityObject, 24 ) \
-    SYSCALL_ENTRY( 0x00e0, NtSetSystemInformation, 24 ) \
-    SYSCALL_ENTRY( 0x00e1, NtSetSystemTime, 16 ) \
-    SYSCALL_ENTRY( 0x00e2, NtSetThreadExecutionState, 16 ) \
-    SYSCALL_ENTRY( 0x00e3, NtSetTimerResolution, 24 ) \
-    SYSCALL_ENTRY( 0x00e4, NtSetVolumeInformationFile, 40 ) \
-    SYSCALL_ENTRY( 0x00e5, NtShutdownSystem, 8 ) \
-    SYSCALL_ENTRY( 0x00e6, NtSignalAndWaitForSingleObject, 32 ) \
-    SYSCALL_ENTRY( 0x00e7, NtSuspendProcess, 8 ) \
-    SYSCALL_ENTRY( 0x00e8, NtSuspendThread, 16 ) \
-    SYSCALL_ENTRY( 0x00e9, NtSystemDebugControl, 48 ) \
-    SYSCALL_ENTRY( 0x00ea, NtTerminateJobObject, 16 ) \
-    SYSCALL_ENTRY( 0x00eb, NtTestAlert, 0 ) \
-    SYSCALL_ENTRY( 0x00ec, NtTraceControl, 48 ) \
-    SYSCALL_ENTRY( 0x00ed, NtUnloadDriver, 8 ) \
-    SYSCALL_ENTRY( 0x00ee, NtUnloadKey, 8 ) \
-    SYSCALL_ENTRY( 0x00ef, NtUnlockFile, 40 ) \
-    SYSCALL_ENTRY( 0x00f0, NtUnlockVirtualMemory, 32 ) \
-    SYSCALL_ENTRY( 0x00f1, NtUnmapViewOfSectionEx, 24 ) \
-    SYSCALL_ENTRY( 0x00f2, NtWaitForAlertByThreadId, 16 ) \
-    SYSCALL_ENTRY( 0x00f3, NtWaitForDebugEvent, 32 ) \
-    SYSCALL_ENTRY( 0x00f4, NtWaitForKeyedEvent, 32 ) \
-    SYSCALL_ENTRY( 0x00f5, wine_nt_to_unix_file_name, 32 ) \
-    SYSCALL_ENTRY( 0x00f6, wine_unix_to_nt_file_name, 24 )
+    SYSCALL_ENTRY( 0x00a7, NtOpenIoCompletion, 24 ) \
+    SYSCALL_ENTRY( 0x00a8, NtOpenJobObject, 24 ) \
+    SYSCALL_ENTRY( 0x00a9, NtOpenKeyEx, 32 ) \
+    SYSCALL_ENTRY( 0x00aa, NtOpenKeyTransacted, 32 ) \
+    SYSCALL_ENTRY( 0x00ab, NtOpenKeyTransactedEx, 40 ) \
+    SYSCALL_ENTRY( 0x00ac, NtOpenKeyedEvent, 24 ) \
+    SYSCALL_ENTRY( 0x00ad, NtOpenMutant, 24 ) \
+    SYSCALL_ENTRY( 0x00ae, NtOpenProcessToken, 24 ) \
+    SYSCALL_ENTRY( 0x00af, NtOpenSemaphore, 24 ) \
+    SYSCALL_ENTRY( 0x00b0, NtOpenSymbolicLinkObject, 24 ) \
+    SYSCALL_ENTRY( 0x00b1, NtOpenThread, 32 ) \
+    SYSCALL_ENTRY( 0x00b2, NtOpenTimer, 24 ) \
+    SYSCALL_ENTRY( 0x00b3, NtPrivilegeCheck, 24 ) \
+    SYSCALL_ENTRY( 0x00b4, NtPulseEvent, 16 ) \
+    SYSCALL_ENTRY( 0x00b5, NtQueryDirectoryObject, 56 ) \
+    SYSCALL_ENTRY( 0x00b6, NtQueryEaFile, 72 ) \
+    SYSCALL_ENTRY( 0x00b7, NtQueryFullAttributesFile, 16 ) \
+    SYSCALL_ENTRY( 0x00b8, NtQueryInformationAtom, 40 ) \
+    SYSCALL_ENTRY( 0x00b9, NtQueryInformationJobObject, 40 ) \
+    SYSCALL_ENTRY( 0x00ba, NtQueryInstallUILanguage, 8 ) \
+    SYSCALL_ENTRY( 0x00bb, NtQueryIoCompletion, 40 ) \
+    SYSCALL_ENTRY( 0x00bc, NtQueryLicenseValue, 40 ) \
+    SYSCALL_ENTRY( 0x00bd, NtQueryMultipleValueKey, 48 ) \
+    SYSCALL_ENTRY( 0x00be, NtQueryMutant, 40 ) \
+    SYSCALL_ENTRY( 0x00bf, NtQuerySecurityObject, 40 ) \
+    SYSCALL_ENTRY( 0x00c0, NtQuerySemaphore, 40 ) \
+    SYSCALL_ENTRY( 0x00c1, NtQuerySymbolicLinkObject, 24 ) \
+    SYSCALL_ENTRY( 0x00c2, NtQuerySystemEnvironmentValue, 32 ) \
+    SYSCALL_ENTRY( 0x00c3, NtQuerySystemEnvironmentValueEx, 40 ) \
+    SYSCALL_ENTRY( 0x00c4, NtQuerySystemInformationEx, 48 ) \
+    SYSCALL_ENTRY( 0x00c5, NtQueryTimerResolution, 24 ) \
+    SYSCALL_ENTRY( 0x00c6, NtQueueApcThreadEx, 48 ) \
+    SYSCALL_ENTRY( 0x00c7, NtRaiseException, 24 ) \
+    SYSCALL_ENTRY( 0x00c8, NtRaiseHardError, 48 ) \
+    SYSCALL_ENTRY( 0x00c9, NtRegisterThreadTerminatePort, 8 ) \
+    SYSCALL_ENTRY( 0x00ca, NtReleaseKeyedEvent, 32 ) \
+    SYSCALL_ENTRY( 0x00cb, NtRemoveIoCompletionEx, 48 ) \
+    SYSCALL_ENTRY( 0x00cc, NtRemoveProcessDebug, 16 ) \
+    SYSCALL_ENTRY( 0x00cd, NtRenameKey, 16 ) \
+    SYSCALL_ENTRY( 0x00ce, NtReplaceKey, 24 ) \
+    SYSCALL_ENTRY( 0x00cf, NtResetEvent, 16 ) \
+    SYSCALL_ENTRY( 0x00d0, NtResetWriteWatch, 24 ) \
+    SYSCALL_ENTRY( 0x00d1, NtRestoreKey, 24 ) \
+    SYSCALL_ENTRY( 0x00d2, NtResumeProcess, 8 ) \
+    SYSCALL_ENTRY( 0x00d3, NtRollbackTransaction, 16 ) \
+    SYSCALL_ENTRY( 0x00d4, NtSaveKey, 16 ) \
+    SYSCALL_ENTRY( 0x00d5, NtSecureConnectPort, 72 ) \
+    SYSCALL_ENTRY( 0x00d6, NtSetContextThread, 16 ) \
+    SYSCALL_ENTRY( 0x00d7, NtSetDebugFilterState, 24 ) \
+    SYSCALL_ENTRY( 0x00d8, NtSetDefaultLocale, 16 ) \
+    SYSCALL_ENTRY( 0x00d9, NtSetDefaultUILanguage, 8 ) \
+    SYSCALL_ENTRY( 0x00da, NtSetEaFile, 32 ) \
+    SYSCALL_ENTRY( 0x00db, NtSetInformationDebugObject, 40 ) \
+    SYSCALL_ENTRY( 0x00dc, NtSetInformationJobObject, 32 ) \
+    SYSCALL_ENTRY( 0x00dd, NtSetInformationKey, 32 ) \
+    SYSCALL_ENTRY( 0x00de, NtSetInformationToken, 32 ) \
+    SYSCALL_ENTRY( 0x00df, NtSetInformationVirtualMemory, 48 ) \
+    SYSCALL_ENTRY( 0x00e0, NtSetIntervalProfile, 16 ) \
+    SYSCALL_ENTRY( 0x00e1, NtSetIoCompletion, 40 ) \
+    SYSCALL_ENTRY( 0x00e2, NtSetIoCompletionEx, 48 ) \
+    SYSCALL_ENTRY( 0x00e3, NtSetLdtEntries, 32 ) \
+    SYSCALL_ENTRY( 0x00e4, NtSetSecurityObject, 24 ) \
+    SYSCALL_ENTRY( 0x00e5, NtSetSystemInformation, 24 ) \
+    SYSCALL_ENTRY( 0x00e6, NtSetSystemTime, 16 ) \
+    SYSCALL_ENTRY( 0x00e7, NtSetThreadExecutionState, 16 ) \
+    SYSCALL_ENTRY( 0x00e8, NtSetTimerResolution, 24 ) \
+    SYSCALL_ENTRY( 0x00e9, NtSetVolumeInformationFile, 40 ) \
+    SYSCALL_ENTRY( 0x00ea, NtShutdownSystem, 8 ) \
+    SYSCALL_ENTRY( 0x00eb, NtSignalAndWaitForSingleObject, 32 ) \
+    SYSCALL_ENTRY( 0x00ec, NtSuspendProcess, 8 ) \
+    SYSCALL_ENTRY( 0x00ed, NtSuspendThread, 16 ) \
+    SYSCALL_ENTRY( 0x00ee, NtSystemDebugControl, 48 ) \
+    SYSCALL_ENTRY( 0x00ef, NtTerminateJobObject, 16 ) \
+    SYSCALL_ENTRY( 0x00f0, NtTestAlert, 0 ) \
+    SYSCALL_ENTRY( 0x00f1, NtTraceControl, 48 ) \
+    SYSCALL_ENTRY( 0x00f2, NtUnloadDriver, 8 ) \
+    SYSCALL_ENTRY( 0x00f3, NtUnloadKey, 8 ) \
+    SYSCALL_ENTRY( 0x00f4, NtUnlockFile, 40 ) \
+    SYSCALL_ENTRY( 0x00f5, NtUnlockVirtualMemory, 32 ) \
+    SYSCALL_ENTRY( 0x00f6, NtUnmapViewOfSectionEx, 24 ) \
+    SYSCALL_ENTRY( 0x00f7, NtWaitForAlertByThreadId, 16 ) \
+    SYSCALL_ENTRY( 0x00f8, NtWaitForDebugEvent, 32 ) \
+    SYSCALL_ENTRY( 0x00f9, NtWaitForKeyedEvent, 32 ) \
+    SYSCALL_ENTRY( 0x00fa, wine_nt_to_unix_file_name, 32 ) \
+    SYSCALL_ENTRY( 0x00fb, wine_unix_to_nt_file_name, 24 )
 #else
 #define ALL_SYSCALLS ALL_SYSCALLS32
 #endif
diff --git a/dlls/ntdll/signal_arm64ec.c b/dlls/ntdll/signal_arm64ec.c
index 629d22df17b..39cc8646972 100644
--- a/dlls/ntdll/signal_arm64ec.c
+++ b/dlls/ntdll/signal_arm64ec.c
@@ -435,6 +435,7 @@ DEFINE_SYSCALL(NtGetNextThread, (HANDLE process, HANDLE thread, ACCESS_MASK acce
 DEFINE_SYSCALL(NtGetNlsSectionPtr, (ULONG type, ULONG id, void *unknown, void **ptr, SIZE_T *size))
 DEFINE_SYSCALL(NtGetWriteWatch, (HANDLE process, ULONG flags, PVOID base, SIZE_T size, PVOID *addresses, ULONG_PTR *count, ULONG *granularity))
 DEFINE_SYSCALL(NtImpersonateAnonymousToken, (HANDLE thread))
+DEFINE_SYSCALL(NtImpersonateClientOfPort, (HANDLE handle, LPC_MESSAGE *request))
 DEFINE_SYSCALL(NtInitializeNlsFiles, (void **ptr, LCID *lcid, LARGE_INTEGER *size))
 DEFINE_SYSCALL(NtInitiatePowerAction, (POWER_ACTION action, SYSTEM_POWER_STATE state, ULONG flags, BOOLEAN async))
 DEFINE_SYSCALL(NtIsProcessInJob, (HANDLE process, HANDLE job))
@@ -519,6 +520,7 @@ DEFINE_WRAPPED_SYSCALL(NtRaiseException, (EXCEPTION_RECORD *rec, ARM64_NT_CONTEX
 DEFINE_SYSCALL(NtRaiseHardError, (NTSTATUS status, ULONG count, ULONG params_mask, void **params, HARDERROR_RESPONSE_OPTION option, HARDERROR_RESPONSE *response))
 DEFINE_WRAPPED_SYSCALL(NtReadFile, (HANDLE handle, HANDLE event, PIO_APC_ROUTINE apc, void *apc_user, IO_STATUS_BLOCK *io, void *buffer, ULONG length, LARGE_INTEGER *offset, ULONG *key))
 DEFINE_SYSCALL(NtReadFileScatter, (HANDLE file, HANDLE event, PIO_APC_ROUTINE apc, void *apc_user, IO_STATUS_BLOCK *io, FILE_SEGMENT_ELEMENT *segments, ULONG length, LARGE_INTEGER *offset, ULONG *key))
+DEFINE_SYSCALL(NtReadRequestData, (HANDLE handle, LPC_MESSAGE *request, ULONG id, void *buffer, ULONG len, ULONG *retlen))
 DEFINE_SYSCALL(NtReadVirtualMemory, (HANDLE process, const void *addr, void *buffer, SIZE_T size, SIZE_T *bytes_read))
 DEFINE_SYSCALL(NtRegisterThreadTerminatePort, (HANDLE handle))
 DEFINE_SYSCALL(NtReleaseKeyedEvent, (HANDLE handle, const void *key, BOOLEAN alertable, const LARGE_INTEGER *timeout))
@@ -529,7 +531,9 @@ DEFINE_SYSCALL(NtRemoveIoCompletionEx, (HANDLE handle, FILE_IO_COMPLETION_INFORM
 DEFINE_SYSCALL(NtRemoveProcessDebug, (HANDLE process, HANDLE debug))
 DEFINE_SYSCALL(NtRenameKey, (HANDLE key, UNICODE_STRING *name))
 DEFINE_SYSCALL(NtReplaceKey, (OBJECT_ATTRIBUTES *attr, HANDLE key, OBJECT_ATTRIBUTES *replace))
+DEFINE_SYSCALL(NtReplyPort, (HANDLE handle, LPC_MESSAGE *reply))
 DEFINE_SYSCALL(NtReplyWaitReceivePort, (HANDLE handle, ULONG *id, LPC_MESSAGE *reply, LPC_MESSAGE *msg))
+DEFINE_SYSCALL(NtReplyWaitReceivePortEx, (HANDLE handle, ULONG *id, LPC_MESSAGE *reply, LPC_MESSAGE *msg, LARGE_INTEGER *timeout))
 DEFINE_SYSCALL(NtRequestWaitReplyPort, (HANDLE handle, LPC_MESSAGE *msg_in, LPC_MESSAGE *msg_out))
 DEFINE_SYSCALL(NtResetEvent, (HANDLE handle, LONG *prev_state))
 DEFINE_SYSCALL(NtResetWriteWatch, (HANDLE process, PVOID base, SIZE_T size))
@@ -589,6 +593,7 @@ DEFINE_SYSCALL(NtWaitForMultipleObjects, (DWORD count, const HANDLE *handles, BO
 DEFINE_SYSCALL(NtWaitForSingleObject, (HANDLE handle, BOOLEAN alertable, const LARGE_INTEGER *timeout))
 DEFINE_SYSCALL(NtWriteFile, (HANDLE handle, HANDLE event, PIO_APC_ROUTINE apc, void *apc_user, IO_STATUS_BLOCK *io, const void *buffer, ULONG length, LARGE_INTEGER *offset, ULONG *key))
 DEFINE_SYSCALL(NtWriteFileGather, (HANDLE file, HANDLE event, PIO_APC_ROUTINE apc, void *apc_user, IO_STATUS_BLOCK *io, FILE_SEGMENT_ELEMENT *segments, ULONG length, LARGE_INTEGER *offset, ULONG *key))
+DEFINE_SYSCALL(NtWriteRequestData, (HANDLE handle, LPC_MESSAGE *request, ULONG id, void *buffer, ULONG len, ULONG *retlen))
 DEFINE_SYSCALL(NtWriteVirtualMemory, (HANDLE process, void *addr, const void *buffer, SIZE_T size, SIZE_T *bytes_written))
 DEFINE_SYSCALL(NtYieldExecution, (void))
 DEFINE_SYSCALL(wine_nt_to_unix_file_name, (const OBJECT_ATTRIBUTES *attr, char *nameA, ULONG *size, UINT disposition))
diff --git a/dlls/ntdll/unix/sync.c b/dlls/ntdll/unix/sync.c
index 4ee3c808626..f45cdbf1be0 100644
--- a/dlls/ntdll/unix/sync.c
+++ b/dlls/ntdll/unix/sync.c
@@ -3509,6 +3509,27 @@ NTSTATUS WINAPI NtCompleteConnectPort( HANDLE handle )
 }
 
 
+/***********************************************************************
+ *             NtImpersonateClientOfPort (NTDLL.@)
+ */
+NTSTATUS WINAPI NtImpersonateClientOfPort( HANDLE handle, LPC_MESSAGE *request )
+{
+    FIXME( "(%p,%p),stub!\n", handle, request );
+    return STATUS_NOT_IMPLEMENTED;
+}
+
+
+/***********************************************************************
+ *             NtReadRequestData (NTDLL.@)
+ */
+NTSTATUS WINAPI NtReadRequestData( HANDLE handle, LPC_MESSAGE *request, ULONG id,
+                                   void *buffer, ULONG len, ULONG *retlen )
+{
+    FIXME( "(%p,%p,%u,%p,%u,%p),stub!\n", handle, request, id, buffer, len, retlen );
+    return STATUS_NOT_IMPLEMENTED;
+}
+
+
 /***********************************************************************
  *             NtRegisterThreadTerminatePort (NTDLL.@)
  */
@@ -3534,6 +3555,16 @@ NTSTATUS WINAPI NtRequestWaitReplyPort( HANDLE handle, LPC_MESSAGE *msg_in, LPC_
 }
 
 
+/***********************************************************************
+ *             NtReplyPort (NTDLL.@)
+ */
+NTSTATUS WINAPI NtReplyPort( HANDLE handle, LPC_MESSAGE *reply )
+{
+    FIXME("(%p,%p),stub!\n", handle, reply );
+    return STATUS_NOT_IMPLEMENTED;
+}
+
+
 /***********************************************************************
  *             NtReplyWaitReceivePort (NTDLL.@)
  */
@@ -3544,6 +3575,27 @@ NTSTATUS WINAPI NtReplyWaitReceivePort( HANDLE handle, ULONG *id, LPC_MESSAGE *r
 }
 
 
+/***********************************************************************
+ *             NtReplyWaitReceivePortEx (NTDLL.@)
+ */
+NTSTATUS WINAPI NtReplyWaitReceivePortEx( HANDLE handle, ULONG *id, LPC_MESSAGE *reply, LPC_MESSAGE *msg,
+                                          LARGE_INTEGER *timeout )
+{
+    FIXME("(%p,%p,%p,%p,%p),stub!\n", handle, id, reply, msg, timeout );
+    return STATUS_NOT_IMPLEMENTED;
+}
+
+
+/***********************************************************************
+ *             NtWriteRequestData (NTDLL.@)
+ */
+NTSTATUS WINAPI NtWriteRequestData( HANDLE handle, LPC_MESSAGE *request, ULONG id,
+                                    void *buffer, ULONG len, ULONG *retlen )
+{
+    FIXME( "(%p,%p,%u,%p,%u,%p),stub!\n", handle, request, id, buffer, len, retlen );
+    return STATUS_NOT_IMPLEMENTED;
+}
+
 #define MAX_ATOM_LEN  255
 #define IS_INTATOM(x) (((ULONG_PTR)(x) >> 16) == 0)
 
diff --git a/dlls/wow64/sync.c b/dlls/wow64/sync.c
index 9076f5dd871..537e695cc87 100644
--- a/dlls/wow64/sync.c
+++ b/dlls/wow64/sync.c
@@ -521,6 +521,19 @@ NTSTATUS WINAPI wow64_NtDuplicateObject( UINT *args )
 }
 
 
+/**********************************************************************
+ *           wow64_NtImpersonateClientOfPort
+ */
+NTSTATUS WINAPI wow64_NtImpersonateClientOfPort( UINT *args )
+{
+    HANDLE handle = get_handle( &args );
+    LPC_MESSAGE *msg = get_ptr( &args );
+
+    FIXME( "%p %p: stub\n", handle, msg );
+    return STATUS_NOT_IMPLEMENTED;
+}
+
+
 /**********************************************************************
  *           wow64_NtListenPort
  */
@@ -1259,6 +1272,36 @@ NTSTATUS WINAPI wow64_NtReleaseSemaphore( UINT *args )
 }
 
 
+/**********************************************************************
+ *           wow64_NtReadRequestData
+ */
+NTSTATUS WINAPI wow64_NtReadRequestData( UINT *args )
+{
+    HANDLE handle = get_handle( &args );
+    LPC_MESSAGE *request = get_ptr( &args );
+    ULONG id = get_ulong( &args );
+    void *buffer = get_ptr( &args );
+    ULONG len = get_ulong( &args );
+    ULONG *retlen = get_ptr( &args );
+
+    FIXME( "%p %p %lu %p %lu %p: stub\n", handle, request, id, buffer, len, retlen );
+    return STATUS_NOT_IMPLEMENTED;
+}
+
+
+/**********************************************************************
+ *           wow64_NtReplyPort
+ */
+NTSTATUS WINAPI wow64_NtReplyPort( UINT *args )
+{
+    HANDLE handle = get_handle( &args );
+    LPC_MESSAGE *reply = get_ptr( &args );
+
+    FIXME( "%p %p: stub\n", handle, reply );
+    return STATUS_NOT_IMPLEMENTED;
+}
+
+
 /**********************************************************************
  *           wow64_NtReplyWaitReceivePort
  */
@@ -1274,6 +1317,22 @@ NTSTATUS WINAPI wow64_NtReplyWaitReceivePort( UINT *args )
 }
 
 
+/**********************************************************************
+ *           wow64_NtReplyWaitReceivePortEx
+ */
+NTSTATUS WINAPI wow64_NtReplyWaitReceivePortEx( UINT *args )
+{
+    HANDLE handle = get_handle( &args );
+    ULONG *id = get_ptr( &args );
+    LPC_MESSAGE *reply = get_ptr( &args );
+    LPC_MESSAGE *msg = get_ptr( &args );
+    LARGE_INTEGER *timeout = get_ptr( &args );
+
+    FIXME( "%p %p %p %p %p: stub\n", handle, id, reply, msg, timeout );
+    return STATUS_NOT_IMPLEMENTED;
+}
+
+
 /**********************************************************************
  *           wow64_NtRequestWaitReplyPort
  */
@@ -1743,6 +1802,23 @@ NTSTATUS WINAPI wow64_NtWaitForSingleObject( UINT *args )
 }
 
 
+/**********************************************************************
+ *           wow64_NtWriteRequestData
+ */
+NTSTATUS WINAPI wow64_NtWriteRequestData( UINT *args )
+{
+    HANDLE handle = get_handle( &args );
+    LPC_MESSAGE *request = get_ptr( &args );
+    ULONG id = get_ulong( &args );
+    void *buffer = get_ptr( &args );
+    ULONG len = get_ulong( &args );
+    ULONG *retlen = get_ptr( &args );
+
+    FIXME( "%p %p %lu %p %lu %p: stub\n", handle, request, id, buffer, len, retlen );
+    return STATUS_NOT_IMPLEMENTED;
+}
+
+
 /**********************************************************************
  *           wow64_NtYieldExecution
  */
diff --git a/include/winternl.h b/include/winternl.h
index 12780719c32..c2e18229c83 100644
--- a/include/winternl.h
+++ b/include/winternl.h
@@ -4634,7 +4634,7 @@ NTSYSAPI NTSTATUS  WINAPI NtGetPlugPlayEvent(ULONG,ULONG,PVOID,ULONG);
 NTSYSAPI ULONG     WINAPI NtGetTickCount(VOID);
 NTSYSAPI NTSTATUS  WINAPI NtGetWriteWatch(HANDLE,ULONG,PVOID,SIZE_T,PVOID*,ULONG_PTR*,ULONG*);
 NTSYSAPI NTSTATUS  WINAPI NtImpersonateAnonymousToken(HANDLE);
-NTSYSAPI NTSTATUS  WINAPI NtImpersonateClientOfPort(HANDLE,PPORT_MESSAGE);
+NTSYSAPI NTSTATUS  WINAPI NtImpersonateClientOfPort(HANDLE,PLPC_MESSAGE);
 NTSYSAPI NTSTATUS  WINAPI NtImpersonateThread(HANDLE,HANDLE,PSECURITY_QUALITY_OF_SERVICE);
 NTSYSAPI NTSTATUS  WINAPI NtInitializeNlsFiles(void**,LCID*,LARGE_INTEGER*);
 NTSYSAPI NTSTATUS  WINAPI NtInitializeRegistry(BOOLEAN);
@@ -4741,7 +4741,7 @@ NTSYSAPI NTSTATUS  WINAPI NtRenameKey(HANDLE,UNICODE_STRING*);
 NTSYSAPI NTSTATUS  WINAPI NtReplaceKey(POBJECT_ATTRIBUTES,HANDLE,POBJECT_ATTRIBUTES);
 NTSYSAPI NTSTATUS  WINAPI NtReplyPort(HANDLE,PLPC_MESSAGE);
 NTSYSAPI NTSTATUS  WINAPI NtReplyWaitReceivePort(HANDLE,PULONG,PLPC_MESSAGE,PLPC_MESSAGE);
-NTSYSAPI NTSTATUS  WINAPI NtReplyWaitReceivePortEx(HANDLE,PVOID*,PPORT_MESSAGE,PPORT_MESSAGE,PLARGE_INTEGER);
+NTSYSAPI NTSTATUS  WINAPI NtReplyWaitReceivePortEx(HANDLE,PULONG,PLPC_MESSAGE,PLPC_MESSAGE,PLARGE_INTEGER);
 NTSYSAPI NTSTATUS  WINAPI NtReplyWaitReplyPort(HANDLE,PLPC_MESSAGE);
 NTSYSAPI NTSTATUS  WINAPI NtRequestPort(HANDLE,PLPC_MESSAGE);
 NTSYSAPI NTSTATUS  WINAPI NtRequestWaitReplyPort(HANDLE,PLPC_MESSAGE,PLPC_MESSAGE);
-- 
2.52.0

