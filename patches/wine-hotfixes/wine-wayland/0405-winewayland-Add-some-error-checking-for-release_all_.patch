From 41a8de0ccdb79f0481cd55d1dbeaab8a5e9e9775 Mon Sep 17 00:00:00 2001
From: Etaash Mathamsetty
 <45927311+Etaash-mathamsetty@users.noreply.github.com>
Date: Fri, 28 Nov 2025 15:32:35 -0600
Subject: [PATCH 405/406] winewayland: Add some error checking for
 release_all_keys.

---
 dlls/winewayland.drv/wayland_keyboard.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/dlls/winewayland.drv/wayland_keyboard.c b/dlls/winewayland.drv/wayland_keyboard.c
index 85e0809fe47..6fd7b709c67 100644
--- a/dlls/winewayland.drv/wayland_keyboard.c
+++ b/dlls/winewayland.drv/wayland_keyboard.c
@@ -798,7 +798,7 @@ static void release_all_keys(HWND hwnd)
     int vkey;
     INPUT input = {.type = INPUT_KEYBOARD};
 
-    NtUserGetAsyncKeyboardState(state);
+    if (!NtUserGetAsyncKeyboardState(state)) return;
 
     for (vkey = 1; vkey < 256; vkey++)
     {
-- 
2.51.1

