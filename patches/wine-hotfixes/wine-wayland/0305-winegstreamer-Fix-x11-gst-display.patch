From fae8dcf5686bd44fab944264cb9f1caa9bc59ad3 Mon Sep 17 00:00:00 2001
From: Etaash Mathamsetty
 <45927311+Etaash-mathamsetty@users.noreply.github.com>
Date: Sun, 21 Sep 2025 13:40:13 -0500
Subject: [PATCH 305/406] winegstreamer: Fix x11 gst display.

---
 dlls/winegstreamer/unixlib.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/dlls/winegstreamer/unixlib.c b/dlls/winegstreamer/unixlib.c
index cedd411eef0..253c8c90297 100644
--- a/dlls/winegstreamer/unixlib.c
+++ b/dlls/winegstreamer/unixlib.c
@@ -321,7 +321,12 @@ NTSTATUS wg_init_gstreamer(void *arg)
     GST_INFO("GStreamer library version %s; wine built with %d.%d.%d.",
             gst_version_string(), GST_VERSION_MAJOR, GST_VERSION_MINOR, GST_VERSION_MICRO);
 
-    if (!(gl_display = gst_gl_display_new_with_type(GST_GL_DISPLAY_TYPE_EGL_SURFACELESS)))
+    if ((e = getenv("GST_GL_DISPLAY")) && strlen(e) > 0)
+        gl_display = gst_gl_display_new();
+    else
+        gl_display = gst_gl_display_new_with_type(GST_GL_DISPLAY_TYPE_EGL_SURFACELESS);
+
+    if (!gl_display)
         GST_ERROR("Failed to create OpenGL display");
     else
     {
-- 
2.51.1

