From 94db5bb073a670f759cdeb6aba93553aa8da7112 Mon Sep 17 00:00:00 2001
From: Etaash Mathamsetty
 <45927311+Etaash-mathamsetty@users.noreply.github.com>
Date: Sun, 28 Dec 2025 22:05:55 -0500
Subject: [PATCH 468/479] winewayland: Use correct offset for get_window_icon.

---
 dlls/winewayland.drv/window.c | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/dlls/winewayland.drv/window.c b/dlls/winewayland.drv/window.c
index 0d9d15228d3..dcc9189248f 100644
--- a/dlls/winewayland.drv/window.c
+++ b/dlls/winewayland.drv/window.c
@@ -481,7 +481,10 @@ static HICON get_window_icon(HWND hwnd, UINT type, HICON icon, ICONINFO *ret)
     {
         icon = get_icon_info((HICON)send_message(hwnd, WM_GETICON, type, 0), ret);
         if (!icon)
-            icon = get_icon_info((HICON)NtUserGetClassLongPtrW(hwnd, GCLP_HICON), ret);
+        {
+            UINT offset = (type == ICON_BIG) ? GCLP_HICON : GCLP_HICONSM;
+            icon = get_icon_info((HICON)NtUserGetClassLongPtrW(hwnd, offset), ret);
+        }
         if (!icon && type == ICON_BIG)
         {
             icon = LoadImageW(0, (const WCHAR *)IDI_WINLOGO, IMAGE_ICON, 0, 0,
-- 
2.52.0

