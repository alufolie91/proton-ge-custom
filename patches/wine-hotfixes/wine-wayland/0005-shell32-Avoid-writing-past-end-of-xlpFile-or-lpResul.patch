From b8891c8d3f1b1e374c2ca4c0677980d416c4bdc6 Mon Sep 17 00:00:00 2001
From: Paul Gofman <pgofman@codeweavers.com>
Date: Mon, 21 Apr 2025 19:15:34 -0600
Subject: [PATCH 005/341] shell32: Avoid writing past end of xlpFile or
 lpResult in SHELL_FindExecutable().

CW-Bug-Id: #25263
---
 dlls/shell32/shlexec.c | 1 -
 1 file changed, 1 deletion(-)

diff --git a/dlls/shell32/shlexec.c b/dlls/shell32/shlexec.c
index 11d572ab022..9ed4330b42f 100644
--- a/dlls/shell32/shlexec.c
+++ b/dlls/shell32/shlexec.c
@@ -646,7 +646,6 @@ static UINT SHELL_FindExecutable(LPCWSTR lpPath, LPCWSTR lpFile, LPCWSTR lpVerb,
         {
             if (wcsncpy_s(xlpFile, ARRAY_SIZE(xlpFile), lpFile, _TRUNCATE))
                 return ERROR_FILE_NOT_FOUND;
-
             if (PathFileExistsDefExtW(xlpFile, 0xbf) || PathFileExistsW(xlpFile))
             {
                 GetFullPathNameW(xlpFile, ARRAY_SIZE(xlpFile), xlpFile, NULL);
-- 
2.50.1

