From bfc7fc4a6db2cd09bbc94c5a37c614ce71ee0c81 Mon Sep 17 00:00:00 2001
From: Etaash Mathamsetty
 <45927311+Etaash-mathamsetty@users.noreply.github.com>
Date: Sat, 2 Aug 2025 13:18:46 -0400
Subject: [PATCH 214/335] coremessaging: Add stub for DllGetActivationFactory.

---
 dlls/coremessaging/Makefile.in        |  3 ++-
 dlls/coremessaging/coremessaging.spec |  2 +-
 dlls/coremessaging/main.c             | 10 ++++++++++
 3 files changed, 13 insertions(+), 2 deletions(-)

diff --git a/dlls/coremessaging/Makefile.in b/dlls/coremessaging/Makefile.in
index 0aa0fc43a9b..8fddc8320e9 100644
--- a/dlls/coremessaging/Makefile.in
+++ b/dlls/coremessaging/Makefile.in
@@ -1,4 +1,5 @@
-MODULE = coremessaging.dll
+MODULE  = coremessaging.dll
+IMPORTS = combase
 
 SOURCES = \
 	main.c
diff --git a/dlls/coremessaging/coremessaging.spec b/dlls/coremessaging/coremessaging.spec
index 58f2be2dc8e..10f36150a0a 100644
--- a/dlls/coremessaging/coremessaging.spec
+++ b/dlls/coremessaging/coremessaging.spec
@@ -18,7 +18,7 @@
 @ stdcall CreateDispatcherQueueController(long long long ptr)
 @ stub CreateDispatcherQueueForCurrentThread
 @ stdcall -private DllCanUnloadNow()
-@ stub DllGetActivationFactory
+@ stdcall DllGetActivationFactory(ptr ptr)
 @ stub DllGetClassObject
 @ stub GetDispatcherQueueForCurrentThread
 @ stub MsgBlobCreateShared
diff --git a/dlls/coremessaging/main.c b/dlls/coremessaging/main.c
index 4944f28a49a..bbe02d7d453 100644
--- a/dlls/coremessaging/main.c
+++ b/dlls/coremessaging/main.c
@@ -17,7 +17,10 @@
  * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301, USA
  */
 
+#include "activation.h"
 #include "dispatcherqueue.h"
+#include "winstring.h"
+
 #include "wine/debug.h"
 
 WINE_DEFAULT_DEBUG_CHANNEL(messaging);
@@ -28,3 +31,10 @@ HRESULT WINAPI CreateDispatcherQueueController( DispatcherQueueOptions options,
             options.dwSize, options.threadType, options.apartmentType, queue_controller );
     return E_NOTIMPL;
 }
+
+HRESULT WINAPI DllGetActivationFactory( HSTRING classid, IActivationFactory **factory )
+{
+    FIXME("classid %s factory %p stub!\n", debugstr_hstring(classid), factory);
+
+    return CLASS_E_CLASSNOTAVAILABLE;
+}
-- 
2.51.0

