From a30d20d6eaddcfa7322593a9ee7a3f38722509ac Mon Sep 17 00:00:00 2001
From: Fabian Maurer <dark.shadow4@web.de>
Date: Wed, 12 Feb 2025 18:59:01 +0100
Subject: [PATCH 274/341] gdiplus: Use correct format guid for .ico files.

Adapted from https://github.com/reactos/reactos/pull/7714
---
 dlls/gdiplus/image.c       | 2 +-
 dlls/gdiplus/tests/image.c | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/dlls/gdiplus/image.c b/dlls/gdiplus/image.c
index 6e55113dbce..c2c8b112e88 100644
--- a/dlls/gdiplus/image.c
+++ b/dlls/gdiplus/image.c
@@ -5209,7 +5209,7 @@ static const struct image_codec codecs[NUM_CODECS] = {
     {
         { /* ICO */
             /* Clsid */              { 0x557cf407, 0x1a04, 0x11d3, { 0x9a, 0x73, 0x0, 0x0, 0xf8, 0x1e, 0xf3, 0x2e } },
-            /* FormatID */           { 0xb96b3cabU, 0x0728U, 0x11d3U, {0x9d, 0x7b, 0x00, 0x00, 0xf8, 0x1e, 0xf3, 0x2e} },
+            /* FormatID */           { 0xb96b3cb5U, 0x0728U, 0x11d3U, {0x9d, 0x7b, 0x00, 0x00, 0xf8, 0x1e, 0xf3, 0x2e} },
             /* CodecName */          ico_codecname,
             /* DllName */            NULL,
             /* FormatDescription */  ico_format,
diff --git a/dlls/gdiplus/tests/image.c b/dlls/gdiplus/tests/image.c
index 256aa360d47..63b559b5cee 100644
--- a/dlls/gdiplus/tests/image.c
+++ b/dlls/gdiplus/tests/image.c
@@ -568,7 +568,7 @@ static void test_LoadingImages(void)
 
     stat = GdipGetImageRawFormat((GpImage*)bm, &format);
     expect(Ok, stat);
-    expect_guid(&format_ico, &format, __LINE__, TRUE);
+    expect_guid(&format_ico, &format, __LINE__, FALSE);
 
 cleanup:
     if (bm)
-- 
2.50.1

