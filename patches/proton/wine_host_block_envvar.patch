diff --git a/dlls/ws2_32/protocol.c b/dlls/ws2_32/protocol.c
index eef2c34b3e4..cd5e734e3f4 100644
--- a/dlls/ws2_32/protocol.c
+++ b/dlls/ws2_32/protocol.c
@@ -148,6 +148,31 @@ static int dns_only_query( const char *node, const struct addrinfo *hints, struc
     return 0;
 }
 
+static BOOL should_block_host(const char *name)
+{
+    const char *blk = getenv("WINE_HOSTBLOCK");
+    char *copy, *tok, *save;
+
+    if (!blk || !*blk || !name || !*name) return FALSE;
+
+    copy = strdup(blk);
+    if (!copy) return FALSE;
+
+    for (tok = strtok_r(copy, ",; \t\r\n", &save);
+         tok;
+    tok = strtok_r(NULL, ",; \t\r\n", &save))
+         {
+             if (*tok && !strcasecmp(name, tok))
+             {
+                 free(copy);
+                 return TRUE;
+             }
+         }
+
+         free(copy);
+         return FALSE;
+}
+
 static BOOL eac_download_hack(void)
 {
     static int eac_download_hack_enabled = -1;
@@ -188,6 +213,12 @@ int WINAPI getaddrinfo( const char *node, const char *service,
 
     if (node)
     {
+        if (should_block_host(node))
+        {
+            SetLastError(WSAHOST_NOT_FOUND);
+            return WSAHOST_NOT_FOUND;
+        }
+
         if (eac_download_hack() && !strcmp(node, "download-alt.easyanticheat.net"))
         {
             SetLastError(WSAHOST_NOT_FOUND);
@@ -952,6 +983,12 @@ struct hostent * WINAPI gethostbyname( const char *name )
         return NULL;
     }
 
+    if (should_block_host(name))
+    {
+        SetLastError( WSAHOST_NOT_FOUND );
+        return NULL;
+    }
+
     if (eac_download_hack() && name && !strcmp(name, "download-alt.easyanticheat.net"))
     {
         SetLastError( WSAHOST_NOT_FOUND );
